import{a as O,c as L,g as G,k as A,n as U}from"./chunk-FWXQILRK.js";import{b as j}from"./chunk-PR3ZWVFR.js";import{A as S,B as F,Fa as z,Ga as N,I as M,J as I,N as _,R as d,S as k,T as C,W as y,X as E,Y as P,_ as T,aa as R,ga as D,k as o,l as u,m as w,na as B,o as x,qa as V,r as c,s as r,t as s,u as m,w as g,x as h,y as p,z as n,za as q}from"./chunk-6EBX5GJW.js";import"./chunk-NFDXTMMQ.js";import"./chunk-Y4AN3NJQ.js";import"./chunk-2FYEZH7E.js";import"./chunk-Q6Z4NPHT.js";import"./chunk-HCS2FYI5.js";import"./chunk-XF2MK4EZ.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as b}from"./chunk-B7O3QC5Z.js";function $(a,l){if(a&1&&(r(0,"ion-text",25)(1,"p",26),n(2),s()()),a&2){let f=h();o(2),S(f.errorMessage)}}function W(a,l){if(a&1&&(r(0,"ion-text",27)(1,"p",28),m(2,"ion-icon",29),n(3),s()()),a&2){let f=h();o(3),F(" ",f.successMessage," ")}}var re=(()=>{let l=class l{constructor(i,e,t){this.router=i,this.formBuilder=e,this.authService=t,this.errorMessage="",this.successMessage="",this.isSubmitDisabled=!0,O({lockClosedOutline:A,mailOutline:U,checkmarkCircleOutline:G,arrowBackOutline:L}),this.registerForm=this.formBuilder.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],confirmPassword:["",[d.required]]},{validators:this.passwordMatchValidator}),this.registerForm.statusChanges.subscribe(()=>{this.updateSubmitButtonState()}),this.registerForm.valueChanges.subscribe(()=>{this.updateSubmitButtonState()}),this.updateSubmitButtonState()}updateSubmitButtonState(){this.isSubmitDisabled=!this.registerForm.valid||!!this.successMessage}passwordMatchValidator(i){let e=i.get("password"),t=i.get("confirmPassword");return e&&t&&e.value&&t.value&&e.value!==t.value?{passwordMismatch:!0}:null}get f(){return this.registerForm.controls}isFieldValid(i){let e=this.registerForm.get(i);return!!(e&&e.valid&&(e.touched||e.value))}isFieldInvalid(i){let e=this.registerForm.get(i);return!!(e&&e.invalid&&(e.touched||e.value))}validateForm(){return this.errorMessage="",this.registerForm.invalid?(this.f.email.errors?this.f.email.errors.required?this.errorMessage="El email es requerido":this.f.email.errors.email&&(this.errorMessage="Por favor, ingresa un email v\xE1lido"):this.f.password.errors?this.f.password.errors.required?this.errorMessage="La contrase\xF1a es requerida":this.f.password.errors.minlength&&(this.errorMessage="La contrase\xF1a debe tener al menos 6 caracteres"):this.f.confirmPassword.errors&&(this.f.confirmPassword.errors.required?this.errorMessage="La confirmaci\xF3n de contrase\xF1a es requerida":this.f.confirmPassword.errors.passwordMismatch&&(this.errorMessage="Las contrase\xF1as no coinciden")),!1):!0}isValidEmail(i){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)}generateUsername(i){let e=i.split("@")[0].replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),t=Date.now().toString().slice(-4);return`${e}${t}`}register(){return b(this,null,function*(){if(this.registerForm.markAllAsTouched(),!!this.validateForm())try{this.errorMessage="",this.successMessage="";let i=this.registerForm.value,e=this.generateUsername(i.email),t=yield this.authService.register({username:e,email:i.email,password:i.password});t.success?(this.successMessage="\xA1Registro exitoso! Redirigiendo...",this.updateSubmitButtonState(),setTimeout(()=>{this.router.navigate(["/onboarding"])},1500)):this.errorMessage=t.message}catch{this.errorMessage="Error al registrar usuario. Intenta nuevamente.",this.successMessage=""}})}goToLogin(){this.router.navigate(["/login"])}goToWelcome(){this.router.navigate(["/welcome"])}goToOnboarding(){this.router.navigate(["/onboarding"])}};l.\u0275fac=function(e){return new(e||l)(u(_),u(T),u(j))},l.\u0275cmp=w({type:l,selectors:[["app-register"]],decls:35,vars:17,consts:[["slot","start","fill","clear",1,"fixed","top-4","left-2","z-10","text-white",3,"click"],["name","arrow-back-outline"],[1,"ion-padding",2,"--background","url('/assets/images/bg.jpg') no-repeat center center / cover",3,"fullscreen"],[1,"fixed","inset-0","z-0"],[1,"w-full","h-full","bg-[url('/assets/images/bg.jpg')]","bg-cover","bg-center","blur-xs"],[1,"absolute","inset-0","bg-gradient-to-b","from-transparent","via-black/70","to-black","pointer-events-none"],[1,"z-10","p-2","relative","flex","items-start","justify-center"],[1,"mt-24","w-full"],[1,"text-white","font-semibold","font-heading","text-4xl","mb-8"],[1,"mb-2","text-white/80"],["expand","block","fill","outline","size","large","shape","round","color","primary",1,"normal-case","mb-6","!mt-0"],["src","https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg","alt","Google",1,"w-5","h-5"],[1,"pl-3","text-base"],[3,"formGroup"],[1,"mb-4"],["name","mail-outline","slot","start","size","default","aria-hidden","true",1,"mr-2","text-white/60"],["type","email","formControlName","email","placeholder","Ingresa tu email",1,"bg-transparent","!text-white"],["name","lock-closed-outline","slot","start","size","default","aria-hidden","true",1,"mr-2","text-white/60"],["type","password","formControlName","password","placeholder","Ingresa una contrase\xF1a",1,"bg-transparent","!text-white"],["type","password","formControlName","confirmPassword","placeholder","Repite tu contrase\xF1a",1,"bg-transparent","!text-white"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["expand","block","fill","solid","size","large","shape","round","color","primary",1,"!mt-8",3,"click","disabled"],[1,"text-center","mt-2","fixed","top-3","right-3"],["fill","clear","size","small","color","medium",1,"text-white","text-sm",3,"click"],["color","danger"],[1,"text-center","my-4","mx-0","text-sm","text-[var(--ion-color-danger)]"],["color","success"],[1,"text-center","my-4","mx-0","text-sm","flex","items-center","justify-center","gap-2","text-[var(--ion-color-success)]"],["name","checkmark-circle-outline"]],template:function(e,t){e&1&&(r(0,"ion-button",0),g("click",function(){return t.goToWelcome()}),m(1,"ion-icon",1),s(),r(2,"ion-content",2)(3,"div",3),m(4,"div",4)(5,"div",5),s(),r(6,"div",6)(7,"div",7)(8,"h1",8),n(9," Reg\xEDstrate "),s(),r(10,"p",9),n(11," A trav\xE9s de: "),s(),r(12,"ion-button",10),m(13,"img",11),r(14,"span",12),n(15,"Cuenta de Google"),s()(),r(16,"p",9),n(17," O continua con: "),s(),r(18,"form",13)(19,"ion-item",14),m(20,"ion-icon",15)(21,"ion-input",16),s(),r(22,"ion-item",14),m(23,"ion-icon",17)(24,"ion-input",18),s(),r(25,"ion-item",14),m(26,"ion-icon",17)(27,"ion-input",19),s()(),x(28,$,3,1,"ion-text",20)(29,W,4,1,"ion-text",21),r(30,"ion-button",22),g("click",function(){return t.register()}),n(31," Crear Cuenta "),s(),r(32,"div",23)(33,"ion-button",24),g("click",function(){return t.goToOnboarding()}),n(34," \u{1F680} Skip to Onboarding "),s()()()()()),e&2&&(o(2),c("fullscreen",!0),o(16),c("formGroup",t.registerForm),o(),p("item-valid",t.isFieldValid("email"))("item-invalid",t.isFieldInvalid("email")),o(3),p("item-valid",t.isFieldValid("password"))("item-invalid",t.isFieldInvalid("password")),o(3),p("item-valid",t.isFieldValid("confirmPassword"))("item-invalid",t.isFieldInvalid("confirmPassword")),o(3),c("ngIf",t.errorMessage),o(),c("ngIf",t.successMessage),o(),c("disabled",t.isSubmitDisabled))},dependencies:[I,M,B,V,N,D,q,z,R,y,k,C,E,P],encapsulation:2});let a=l;return a})();export{re as RegisterPage};
