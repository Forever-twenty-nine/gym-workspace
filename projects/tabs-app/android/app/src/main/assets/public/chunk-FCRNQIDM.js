import{a as B,c as N,k as D,q as K}from"./chunk-FWXQILRK.js";import{b as z}from"./chunk-PR3ZWVFR.js";import{$ as P,A as y,D as h,E as f,Ea as F,F as b,Fa as O,Ga as j,J as k,N as S,S as M,T as I,U as E,V as G,W as T,ga as L,k as c,l as p,m as w,na as W,p as v,q as _,qa as A,r as C,s as t,t as n,u as m,w as u,x,z as o}from"./chunk-6EBX5GJW.js";import"./chunk-NFDXTMMQ.js";import"./chunk-Y4AN3NJQ.js";import"./chunk-2FYEZH7E.js";import"./chunk-Q6Z4NPHT.js";import"./chunk-HCS2FYI5.js";import"./chunk-XF2MK4EZ.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-LRFGNCHE.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{h as d}from"./chunk-B7O3QC5Z.js";function H(l,a){if(l&1&&(t(0,"div",21)(1,"p",23),o(2),n()()),l&2){let R=x();c(2),y(R.errorMessage)}}var te=(()=>{let a=class a{constructor(r,i,e){this.authService=r,this.router=i,this.alertController=e,this.email="",this.password="",this.errorMessage="",B({arrowBackOutline:N,personOutline:K,lockClosedOutline:D})}goToRegister(){this.router.navigate(["/register"])}goToForgotPassword(){this.router.navigate(["/forgot-password"])}goToWelcome(){this.router.navigate(["/welcome"])}login(){return d(this,null,function*(){if(this.errorMessage="",!this.email||!this.password){this.errorMessage="Por favor, ingresa email y contrase\xF1a";return}try{if(yield this.authService.login(this.email,this.password))switch(this.authService.getCurrentUser()?.role){case"gimnasio":this.router.navigate(["/gimnasio-tabs"]);break;case"cliente":this.router.navigate(["/cliente-tabs"]);break;case"entrenador":this.router.navigate(["/entrenador-tabs"]);break;default:this.router.navigate(["/cliente-tabs"])}else this.errorMessage="Email o contrase\xF1a incorrectos"}catch{this.errorMessage="Error al iniciar sesi\xF3n"}})}loginWithGoogle(){return d(this,null,function*(){yield(yield this.alertController.create({header:"Iniciar sesi\xF3n con Google",message:"\xBFDeseas continuar con Google? Se crear\xE1 una cuenta de cliente autom\xE1ticamente.",buttons:[{text:"Cancelar",role:"cancel"},{text:"Continuar",handler:()=>d(this,null,function*(){yield this.processGoogleLogin()})}]})).present()})}processGoogleLogin(){return d(this,null,function*(){let r=yield this.alertController.create({header:"Autenticando...",message:"Conectando con Google",buttons:[]});yield r.present();try{let i=yield this.authService.loginWithGoogle();yield r.dismiss(),i.success&&i.user?yield(yield this.alertController.create({header:"\xA1Bienvenido!",message:`Hola ${i.user.username}, has iniciado sesi\xF3n exitosamente con Google.`,buttons:[{text:"OK",handler:()=>{this.router.navigate(["/cliente-tabs"])}}]})).present():yield(yield this.alertController.create({header:"Error",message:i.message||"Error al autenticar con Google",buttons:["OK"]})).present()}catch{yield r.dismiss(),yield(yield this.alertController.create({header:"Error",message:"Ocurri\xF3 un error inesperado",buttons:["OK"]})).present()}})}};a.\u0275fac=function(i){return new(i||a)(p(z),p(S),p(F))},a.\u0275cmp=w({type:a,selectors:[["app-login"]],decls:31,vars:4,consts:[["slot","start","fill","clear",1,"fixed","top-4","left-2","z-10","text-white",3,"click"],["name","arrow-back-outline"],[1,"ion-padding",2,"--background","url('/assets/images/bg.jpg') no-repeat center center / cover",3,"fullscreen"],[1,"fixed","inset-0","z-0"],[1,"w-full","h-full","bg-[url('/assets/images/bg.jpg')]","bg-cover","bg-center","blur-xs"],[1,"absolute","inset-0","bg-gradient-to-b","from-transparent","via-black/70","to-black","pointer-events-none"],[1,"z-10","p-2","relative","flex","items-start","justify-center"],[1,"mt-24","w-full"],[1,"text-white","font-semibold","font-heading","text-4xl","mb-8"],[1,"mb-2","text-white/80"],["expand","block","fill","outline","size","large","shape","round","color","primary",1,"normal-case","mb-6","!mt-0",3,"click"],["src","https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg","alt","Google",1,"w-5","h-5"],[1,"pl-3","text-base"],[1,"mb-4"],["name","person-outline","slot","start","size","default","aria-hidden","true",1,"mr-2","text-white/60"],["type","email","name","email","placeholder","Ingresa tu email",1,"bg-transparent","!text-white",3,"ngModelChange","ngModel"],[1,"mb-4","rounded-lg"],["name","lock-closed-outline","slot","start","size","default","aria-hidden","true",1,"mr-2","text-white/60"],["type","password","name","password","placeholder","Ingresa tu contrase\xF1a",1,"bg-transparent","!text-white",3,"ngModelChange","ngModel"],[1,"flex","gap-2","items-center","justify-center","mb-6"],["expand","block","fill","clean","size","default","shape","round","color","primary",1,"!mt-0",3,"click"],[1,"mb-4","p-3","bg-red-500/20","border","border-red-500/50","rounded-lg"],["expand","block","fill","solid","size","large","shape","round","color","primary",1,"",3,"click"],[1,"text-red-200","text-sm"]],template:function(i,e){i&1&&(t(0,"ion-button",0),u("click",function(){return e.goToWelcome()}),m(1,"ion-icon",1),n(),t(2,"ion-content",2)(3,"div",3),m(4,"div",4)(5,"div",5),n(),t(6,"div",6)(7,"div",7)(8,"h1",8),o(9," Bienvenido a GymApp "),n(),t(10,"p",9),o(11," Inicia sesi\xF3n con: "),n(),t(12,"ion-button",10),u("click",function(){return e.loginWithGoogle()}),m(13,"img",11),t(14,"span",12),o(15,"Cuenta de Google"),n()(),t(16,"p",9),o(17," O continua con: "),n(),t(18,"form")(19,"ion-item",13),m(20,"ion-icon",14),t(21,"ion-input",15),b("ngModelChange",function(s){return f(e.email,s)||(e.email=s),s}),n()(),t(22,"ion-item",16),m(23,"ion-icon",17),t(24,"ion-input",18),b("ngModelChange",function(s){return f(e.password,s)||(e.password=s),s}),n()(),t(25,"div",19)(26,"ion-button",20),u("click",function(){return e.goToForgotPassword()}),o(27," \xBFOlvidaste tu contrase\xF1a? "),n()()(),v(28,H,3,1,"div",21),t(29,"ion-button",22),u("click",function(){return e.login()}),o(30," Iniciar Sesi\xF3n "),n()()()()),i&2&&(c(2),C("fullscreen",!0),c(19),h("ngModel",e.email),c(3),h("ngModel",e.password),c(4),_(e.errorMessage?28:-1))},dependencies:[k,W,A,j,L,O,P,T,M,I,G,E],encapsulation:2});let l=a;return l})();export{te as LoginPage};
