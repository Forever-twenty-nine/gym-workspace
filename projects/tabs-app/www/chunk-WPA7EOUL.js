import{a as pe,b as ge}from"./chunk-OUWNKFJR.js";import{a as N}from"./chunk-XSF6HTAU.js";import{l as ce,n as de,o as A,p as me,q as $,t as U,u as ue,v as _e}from"./chunk-JSLBC6HI.js";import{$b as te,Da as G,Mb as Q,Nb as W,Qa as _,R as z,Ra as p,Sa as q,Ta as H,Tb as X,Ua as h,Ub as Y,Va as v,Vb as P,W as F,Wa as E,Xa as a,Xb as Z,Ya as r,Yb as ee,Za as j,aa as g,ab as T,ac as ie,ba as x,bb as u,bc as ne,ca as B,cb as m,cc as oe,dc as ae,ec as re,gc as le,ia as b,ic as se,jb as w,kb as s,lb as C,mb as S,nb as I,sb as J,tb as L,ub as O,wa as d,wb as K}from"./chunk-WL3GAS2Y.js";import{a as D,b as R,i as f}from"./chunk-VBFW7A5V.js";var xe=(()=>{let l=class l{constructor(){this.COLLECTION="ejercicios",this.firestore=F(ce),this._ejercicios=b([]),this.ejercicioSignals=new Map,this.isListenerInitialized=!1,this.initializeListener()}initializeListener(){if(!this.isListenerInitialized)try{let e=A(this.firestore,this.COLLECTION);U(e,i=>{let o=i.docs.map(c=>this.mapFromFirestore(R(D({},c.data()),{id:c.id})));this._ejercicios.set(o)}),this.isListenerInitialized=!0}catch(e){console.warn("Error inicializando listener de ejercicios:",e)}}guardarEjercicio(e){return f(this,null,function*(){let i=A(this.firestore,this.COLLECTION),o=D({},e);if(e.id){let c=$(this.firestore,`${this.COLLECTION}/${e.id}`);yield ue(c,o,{merge:!0});return}yield de(i,o)})}obtenerEjercicios(){return this._ejercicios.asReadonly()}obtenerEjercicioPorId(e){if(!this.ejercicioSignals.has(e)){let i=b(null);this.ejercicioSignals.set(e,i);try{let o=$(this.firestore,`${this.COLLECTION}/${e}`);U(o,c=>{c.exists()?i.set(this.mapFromFirestore(R(D({},c.data()),{id:c.id}))):i.set(null)})}catch(o){console.warn(`Error obteniendo ejercicio ${e}:`,o),i.set(null)}}return this.ejercicioSignals.get(e).asReadonly()}eliminarEjercicio(e){return f(this,null,function*(){let i=$(this.firestore,`${this.COLLECTION}/${e}`);yield me(i)})}mapFromFirestore(e){return{id:e.id,nombre:e.nombre,descripcion:e.descripcion,series:e.series,repeticiones:e.repeticiones,peso:e.peso,descansoSegundos:e.descansoSegundos,serieSegundos:e.serieSegundos}}};l.\u0275fac=function(i){return new(i||l)},l.\u0275prov=z({token:l,factory:l.\u0275fac,providedIn:"root"});let n=l;return n})();var he=()=>[],ve=(n,l)=>l.uid,V=(n,l)=>l.id,Ee=(n,l)=>l.name,Ce=(n,l)=>l.value;function Se(n,l){n&1&&(a(0,"div",8)(1,"span",25),s(2,"\u26A0\uFE0F Faltan usuarios para rutinas"),r()())}function Te(n,l){if(n&1){let t=T();a(0,"div",15)(1,"div",26)(2,"div",27)(3,"h4"),s(4),r(),a(5,"p"),s(6),r()(),a(7,"div",28)(8,"button",29),u("click",function(){let i=g(t).$implicit,o=m();return x(o.openDetailsModal(i,"usuario"))}),s(9," \u270F\uFE0F "),r(),a(10,"button",30),u("click",function(){let i=g(t).$implicit,o=m();return x(o.deleteUsuario(i.uid))}),s(11," \u{1F5D1}\uFE0F "),r()()()()}if(n&2){let t=l.$implicit;d(4),C(t.nombre),d(2),S("Rol: ",t.role)}}function ye(n,l){n&1&&(a(0,"div",16)(1,"p"),s(2,"No hay usuarios creados"),r()())}function Fe(n,l){if(n&1){let t=T();a(0,"div",15)(1,"div",26)(2,"div",27)(3,"h4"),s(4),r(),a(5,"p"),s(6),r()(),a(7,"div",28)(8,"button",31),u("click",function(){let i=g(t).$implicit,o=m();return x(o.openDetailsModal(i,"cliente"))}),s(9," \u270F\uFE0F "),r(),a(10,"button",32),u("click",function(){let i=g(t).$implicit,o=m();return x(o.deleteCliente(i.id))}),s(11," \u{1F5D1}\uFE0F "),r()()()()}if(n&2){let t=l.$implicit;d(4),C(t.gimnasioId),d(2),I("Gimnasio: ",t.gimnasioId," \u2022 Activo: ",t.activo)}}function De(n,l){n&1&&(a(0,"div",16)(1,"p"),s(2,"No hay clientes creados"),r()())}function je(n,l){n&1&&s(0," Crear rutina ")}function ke(n,l){n&1&&s(0," \u26A0\uFE0F Sin usuarios suficientes ")}function we(n,l){if(n&1&&(a(0,"div",19)(1,"p"),s(2),r()()),n&2){let t=m();d(2),C(t.getRutinaValidationMessage())}}function Ie(n,l){if(n&1){let t=T();a(0,"div",15)(1,"div",26)(2,"div",27)(3,"h4"),s(4),r(),a(5,"p"),s(6),r(),a(7,"p",33),s(8),r()(),a(9,"div",28)(10,"button",34),u("click",function(){let i=g(t).$implicit,o=m();return x(o.openDetailsModal(i,"rutina"))}),s(11," \u270F\uFE0F "),r(),a(12,"button",35),u("click",function(){let i=g(t).$implicit,o=m();return x(o.deleteRutina(i.id))}),s(13," \u{1F5D1}\uFE0F "),r()()()()}if(n&2){let t=l.$implicit,e=m();d(4),C(t.nombre),d(2),S("\u{1F464} ",e.getClienteName(t.clienteId||"")),d(2),S("\u{1F3C3}\u200D\u2642\uFE0F ",e.getEntrenadorName(t.entrenadorId||""))}}function Pe(n,l){n&1&&(a(0,"div",16)(1,"p"),s(2,"No hay rutinas creadas"),r()())}function $e(n,l){if(n&1){let t=T();a(0,"div",15)(1,"div",26)(2,"div",27)(3,"h4"),s(4),r(),a(5,"p"),s(6),r()(),a(7,"div",28)(8,"button",36),u("click",function(){let i=g(t).$implicit,o=m();return x(o.openDetailsModal(i,"ejercicio"))}),s(9," \u270F\uFE0F "),r(),a(10,"button",37),u("click",function(){let i=g(t).$implicit,o=m();return x(o.deleteEjercicio(i.id))}),s(11," \u{1F5D1}\uFE0F "),r()()()()}if(n&2){let t=l.$implicit;d(4),C(t.nombre),d(2),I("",t.series,"x",t.repeticiones)}}function Ne(n,l){n&1&&(a(0,"div",16)(1,"p",38),s(2,"No hay ejercicios creados"),r()())}function Ve(n,l){if(n&1&&(a(0,"div",23)(1,"p"),s(2),r()()),n&2){let t=l.$implicit;d(2),C(t)}}function Me(n,l){n&1&&(a(0,"div",16)(1,"p"),s(2,"No hay logs disponibles"),r()())}function Re(n,l){if(n&1&&(s(0),L(1,"titlecase")),n&2){let t=m(2);S(" \u2795 Crear ",O(1,1,t.modalType())," ")}}function Le(n,l){if(n&1&&(s(0),L(1,"titlecase")),n&2){let t=m(2);S(" \u270F\uFE0F Editar ",O(1,1,t.modalType())," ")}}function Oe(n,l){n&1&&s(0," Este campo es obligatorio ")}function Ae(n,l){if(n&1&&(a(0,"p",58),_(1,Oe,1,0),r()),n&2){let t,e=m(2).$implicit,i=m(3);d(),p(!((t=i.editForm())==null||(t=t.get(e.name))==null||t.errors==null)&&t.errors.required?1:-1)}}function Ue(n,l){if(n&1&&(j(0,"input",57),_(1,Ae,2,1,"p",58)),n&2){let t,e=m().$implicit,i=m(3);E("type",e.inputType||"text")("formControlName",e.name)("placeholder",e.placeholder||"")("min",e.min||null)("step",e.step||null),d(),p(!((t=i.editForm())==null||(t=t.get(e.name))==null)&&t.invalid&&(!((t=i.editForm())==null||(t=t.get(e.name))==null)&&t.touched)?1:-1)}}function ze(n,l){if(n&1&&j(0,"textarea",54),n&2){let t=m().$implicit;E("formControlName",t.name)("placeholder",t.placeholder||"")("rows",t.rows||3)}}function Be(n,l){if(n&1&&(a(0,"option",61),s(1),r()),n&2){let t=l.$implicit;E("value",t.value),d(),C(t.label)}}function Ge(n,l){n&1&&s(0," Debes seleccionar una opci\xF3n ")}function qe(n,l){if(n&1&&(a(0,"p",58),_(1,Ge,1,0),r()),n&2){let t,e=m(2).$implicit,i=m(3);d(),p(!((t=i.editForm())==null||(t=t.get(e.name))==null||t.errors==null)&&t.errors.required?1:-1)}}function He(n,l){if(n&1&&(a(0,"select",59)(1,"option",60),s(2),r(),h(3,Be,2,2,"option",61,Ce),r(),_(5,qe,2,1,"p",58)),n&2){let t,e,i,o=m().$implicit,c=m(3);w("border-red-300",((t=c.editForm())==null||(t=t.get(o.name))==null?null:t.invalid)&&((t=c.editForm())==null||(t=t.get(o.name))==null?null:t.touched))("focus:ring-red-500",((e=c.editForm())==null||(e=e.get(o.name))==null?null:e.invalid)&&((e=c.editForm())==null||(e=e.get(o.name))==null?null:e.touched)),E("formControlName",o.name),d(2),C(o.placeholder),d(),v(o.options||J(7,he)),d(2),p(!((i=c.editForm())==null||(i=i.get(o.name))==null)&&i.invalid&&(!((i=c.editForm())==null||(i=i.get(o.name))==null)&&i.touched)?5:-1)}}function Je(n,l){if(n&1&&(a(0,"label",49),j(1,"input",62),a(2,"span",63),s(3),r()()),n&2){let t=m().$implicit;d(),E("formControlName",t.name),d(2),C(t.checkboxLabel)}}function Ke(n,l){if(n&1){let t=T();a(0,"label",64)(1,"input",65),u("change",function(i){let o=g(t).$implicit,c=m(5);return x(c.toggleDiaSemana(i,o.value))}),r(),a(2,"span",33),s(3),r()()}if(n&2){let t,e=l.$implicit,i=m(5);d(),E("checked",(t=i.editForm())==null||(t=t.get("DiasSemana"))==null||t.value==null?null:t.value.includes(e.value)),d(2),C(e.label.slice(0,3))}}function Qe(n,l){if(n&1&&(a(0,"div",55),h(1,Ke,4,2,"label",64,Ce),r()),n&2){let t=m(4);d(),v(t.getDiasSemanOptions())}}function We(n,l){if(n&1&&(a(0,"span"),s(1),r()),n&2){let t=m().$implicit;d(),S("",t.peso,"kg \u2022 ")}}function Xe(n,l){if(n&1&&(a(0,"span"),s(1),r()),n&2){let t=m().$implicit;d(),S("",t.serieSegundos,"s \u2022 ")}}function Ye(n,l){if(n&1&&(a(0,"span"),s(1),r()),n&2){let t=m().$implicit;d(),S("Descanso: ",t.descansoSegundos,"s")}}function Ze(n,l){if(n&1){let t=T();a(0,"label",69)(1,"input",70),u("change",function(){let i=g(t).$implicit,o=m(6);return x(o.toggleEjercicio(i.id))}),r(),a(2,"div",71)(3,"div",72)(4,"h4",73),s(5),r(),a(6,"span",74),s(7),r()(),a(8,"p",75),_(9,We,2,1,"span"),_(10,Xe,2,1,"span"),_(11,Ye,2,1,"span"),r()()()}if(n&2){let t=l.$implicit,e=m(6);d(),E("checked",e.isEjercicioSelected(t.id)),d(4),C(t.nombre),d(2),I(" ",t.series,"x",t.repeticiones," "),d(2),p(t.peso&&t.peso>0?9:-1),d(),p(t.serieSegundos&&t.serieSegundos>0?10:-1),d(),p(t.descansoSegundos?11:-1)}}function et(n,l){if(n&1&&h(0,Ze,12,7,"label",69,V),n&2){let t=m(5);v(t.ejercicios())}}function tt(n,l){n&1&&(a(0,"div",67)(1,"p",38),s(2,"No hay ejercicios disponibles"),r(),a(3,"p",76),s(4,"Crea algunos ejercicios primero"),r()())}function it(n,l){if(n&1){let t=T();a(0,"span",79),s(1),a(2,"button",80),u("click",function(){g(t);let i=m().$implicit,o=m(6);return x(o.toggleEjercicio(i))}),s(3," \u2715 "),r()()}n&2&&(d(),S(" ",l.nombre," "))}function nt(n,l){if(n&1&&_(0,it,4,1,"span",79),n&2){let t,e=l.$implicit,i=m(6);p((t=i.getEjercicioById(e))?0:-1,t)}}function ot(n,l){if(n&1&&(a(0,"div",68)(1,"h4",77),s(2,"\u{1F4CB} Ejercicios seleccionados:"),r(),a(3,"div",78),h(4,nt,1,1,null,null,H),r()()),n&2){let t=m(5);d(4),v(t.selectedEjercicios())}}function at(n,l){if(n&1&&(a(0,"div",66),_(1,et,2,0)(2,tt,5,0,"div",67),r(),_(3,ot,6,0,"div",68)),n&2){let t=m(4);d(),p(t.ejercicios().length>0?1:2),d(2),p(t.selectedEjercicios().length>0?3:-1)}}function rt(n,l){n&1&&(a(0,"div",56)(1,"label",49),j(2,"input",81),a(3,"span",63),s(4,"Rutina Activa"),r()(),a(5,"label",49),j(6,"input",82),a(7,"span",63),s(8,"Completado"),r()()())}function lt(n,l){if(n&1&&(a(0,"div",52)(1,"label",53)(2,"span"),s(3),r(),s(4),r(),_(5,Ue,2,6)(6,ze,1,3,"textarea",54)(7,He,6,8)(8,Je,4,2,"label",49)(9,Qe,3,0,"div",55)(10,at,4,2)(11,rt,9,0,"div",56),r()),n&2){let t,e=l.$implicit;w("full-width",e.colSpan===2),d(3),C(e.icon),d(),S(" ",e.label," "),d(),p((t=e.type)==="text"?5:t==="textarea"?6:t==="select"?7:t==="checkbox"?8:t==="dias-semana"?9:t==="ejercicios-selector"?10:t==="rutina-estados"?11:-1)}}function st(n,l){if(n&1&&(a(0,"form",45)(1,"div",50),h(2,lt,12,5,"div",51,Ee),r()()),n&2){let t=m(2);E("formGroup",t.editForm()),d(2),v(t.getFormFields())}}function ct(n,l){n&1&&(a(0,"span",49),B(),a(1,"svg",83),j(2,"circle",84)(3,"path",85),r(),s(4," Guardando... "),r())}function dt(n,l){n&1&&s(0," \u{1F4BE} Guardar Cambios ")}function mt(n,l){if(n&1){let t=T();a(0,"div",39),u("click",function(){g(t);let i=m();return x(i.closeModal())}),a(1,"div",40),u("click",function(i){return g(t),x(i.stopPropagation())}),a(2,"div",41)(3,"h2",42),_(4,Re,2,3)(5,Le,2,3),r(),a(6,"button",43),u("click",function(){g(t);let i=m();return x(i.closeModal())}),s(7," \u2715 "),r()(),a(8,"div",44),_(9,st,4,1,"form",45),r(),a(10,"div",46)(11,"button",47),u("click",function(){g(t);let i=m();return x(i.closeModal())}),s(12," \u274C Cancelar "),r(),a(13,"button",48),u("click",function(){g(t);let i=m();return x(i.saveChanges())}),_(14,ct,5,0,"span",49)(15,dt,1,0),r()()()()}if(n&2){let t,e=m();d(4),p(e.isCreating()?4:5),d(5),p(e.editForm()?9:-1),d(4),E("disabled",!((t=e.editForm())!=null&&t.valid)||e.isLoading()),d(),p(e.isLoading()?14:15)}}var kt=(()=>{let l=class l{constructor(){this.clienteService=F(pe),this.rutinaService=F(ge),this.ejercicioService=F(xe),this.userService=F(_e),this.fb=F(le),this.clientes=this.clienteService.obtenerClientes(),this.rutinas=this.rutinaService.obtenerRutinas(),this.ejercicios=this.ejercicioService.obtenerEjercicios(),this.usuarios=this.userService.users,this.logs=b([]),this.isModalOpen=b(!1),this.modalData=b(null),this.modalType=b(""),this.editForm=b(null),this.isLoading=b(!1),this.isCreating=b(!1),this.selectedEjercicios=b([]),this.conjuntoRutinas=K(()=>{let e=new Map;for(let i of this.rutinas())i?.id&&e.set(i.id,i);return e})}log(e){this.logs.update(i=>[e,...i].slice(0,100))}getClienteName(e){if(!e)return"Sin cliente asignado";let i=this.usuarios().find(c=>c.uid===e);if(i)return i.nombre||i.email||`Usuario ${i.uid}`;let o=this.clientes().find(c=>c.id===e);return o?`Cliente ${o.id}`:`Cliente ${e}`}getEntrenadorName(e){if(!e)return"Sin entrenador asignado";let i=this.usuarios().find(o=>o.uid===e);return i?i.nombre||i.email||`Entrenador ${i.uid}`:`Entrenador ${e}`}addSampleCliente(){return f(this,null,function*(){this.openCreateModal("cliente")})}deleteCliente(e){return f(this,null,function*(){yield this.clienteService.eliminarCliente(e),this.log(`Cliente eliminado: ${e}`)})}addSampleRutina(){return f(this,null,function*(){if(!this.canCreateRutina()){this.log(`\u274C ${this.getRutinaValidationMessage()}`);return}this.openCreateModal("rutina")})}deleteRutina(e){return f(this,null,function*(){yield this.rutinaService.eliminarRutina(e),this.log(`Rutina eliminada: ${e}`)})}addSampleEjercicio(){return f(this,null,function*(){this.openCreateModal("ejercicio")})}deleteEjercicio(e){return f(this,null,function*(){yield this.ejercicioService.eliminarEjercicio(e),this.log(`Ejercicio eliminado: ${e}`)})}addSampleUsuario(){return f(this,null,function*(){this.openCreateModal("usuario")})}deleteUsuario(e){return f(this,null,function*(){yield this.userService.removeUser(e),this.log(`Usuario eliminado: ${e}`)})}openDetailsModal(e,i){this.modalData.set(e),this.modalType.set(i),this.isModalOpen.set(!0),this.isCreating.set(!1),this.createEditForm(e,i),i==="rutina"&&e.ejercicios&&this.selectedEjercicios.set(Array.isArray(e.ejercicios)?e.ejercicios:[])}openCreateModal(e){let i=this.createEmptyItem(e);this.modalData.set(i),this.modalType.set(e),this.isModalOpen.set(!0),this.isCreating.set(!0),this.selectedEjercicios.set([]),this.createEditForm(i,e)}createEmptyItem(e){let i=Date.now();switch(e){case"rutina":return{id:"r"+i,nombre:"",clienteId:"",entrenadorId:"",fechaAsignacion:new Date,ejercicios:[],activa:!0,DiasSemana:[],completado:!1};case"usuario":return{uid:"u"+i,nombre:"",email:"",role:"",gimnasioId:"g-default"};case"cliente":return{id:"c"+i,gimnasioId:"g-default",activo:!0,fechaRegistro:new Date,objetivo:"",rutinas:[]};case"ejercicio":return{id:"e"+i,nombre:"",series:1,repeticiones:1,peso:0,serieSegundos:0,descansoSegundos:0,descripcion:""};default:return{}}}closeModal(){this.isModalOpen.set(!1),this.modalData.set(null),this.modalType.set(""),this.editForm.set(null),this.isLoading.set(!1),this.isCreating.set(!1),this.selectedEjercicios.set([])}createEditForm(e,i){let o={};switch(i){case"usuario":o={nombre:[e.nombre||""],email:[e.email||""],role:[e.role||""],gimnasioId:[e.gimnasioId||""]};break;case"cliente":o={gimnasioId:[e.gimnasioId||""],activo:[e.activo||!1],objetivo:[e.objetivo||""]};break;case"rutina":o={nombre:[e.nombre||"",[P.required]],clienteId:[e.clienteId||"",[P.required]],entrenadorId:[e.entrenadorId||"",[P.required]],activa:[e.activa||!1],completado:[e.completado||!1],DiasSemana:[e.DiasSemana||[]]},e.ejercicios&&this.selectedEjercicios.set(Array.isArray(e.ejercicios)?e.ejercicios:[]);break;case"ejercicio":o={nombre:[e.nombre||""],series:[e.series||0],repeticiones:[e.repeticiones||0],peso:[e.peso||0],serieSegundos:[e.serieSegundos||0],descansoSegundos:[e.descansoSegundos||0],descripcion:[e.descripcion||""]};break;default:o={}}this.editForm.set(this.fb.group(o))}saveChanges(){return f(this,null,function*(){let e=this.editForm(),i=this.modalType(),o=this.modalData();if(!e||!o){this.log("\u274C Formulario inv\xE1lido o datos faltantes");return}if(e.markAllAsTouched(),i==="rutina"&&this.isCreating()){let c=e.get("clienteId")?.value,y=e.get("entrenadorId")?.value;if(!c){this.log("\u274C Debes seleccionar un cliente para la rutina");return}if(!y){this.log("\u274C Debes seleccionar un entrenador para la rutina");return}}if(!e.valid){this.log("\u274C Por favor, completa todos los campos obligatorios");return}this.isLoading.set(!0);try{let c=D(D({},o),e.value);switch(i==="rutina"&&(c.ejercicios=this.selectedEjercicios()),c=this.cleanUndefinedFields(c),i){case"usuario":yield this.userService.addUser(c),this.log(`\u2705 Usuario ${this.isCreating()?"creado":"actualizado"}: ${c.nombre}`);break;case"cliente":yield this.clienteService.guardarCliente(c),this.log(`\u2705 Cliente ${this.isCreating()?"creado":"actualizado"}: ${c.id}`);break;case"rutina":yield this.rutinaService.guardarRutina(c);let y=c.clienteId?this.getClienteName(c.clienteId):"Sin cliente",k=c.entrenadorId?this.getEntrenadorName(c.entrenadorId):"Sin entrenador";this.log(`\u2705 Rutina ${this.isCreating()?"creada":"actualizada"}: ${c.nombre} - Cliente: ${y} - Entrenador: ${k} - Ejercicios: ${c.ejercicios.length}`);break;case"ejercicio":yield this.ejercicioService.guardarEjercicio(c),this.log(`\u2705 Ejercicio ${this.isCreating()?"creado":"actualizado"}: ${c.nombre}`);break}this.closeModal()}catch(c){console.error("Error al guardar:",c),this.log(`\u274C Error al guardar los cambios: ${c}`)}finally{this.isLoading.set(!1)}})}getDiasSemanOptions(){return[{value:0,label:"Domingo"},{value:1,label:"Lunes"},{value:2,label:"Martes"},{value:3,label:"Mi\xE9rcoles"},{value:4,label:"Jueves"},{value:5,label:"Viernes"},{value:6,label:"S\xE1bado"}]}getClientesDisponibles(){return this.usuarios().filter(e=>e.role===N.CLIENTE)}getEntrenadoresDisponibles(){return this.usuarios().filter(e=>e.role===N.ENTRENADOR)}canCreateRutina(){return this.getClientesDisponibles().length>0&&this.getEntrenadoresDisponibles().length>0}getRutinaValidationMessage(){let e=this.getClientesDisponibles().length,i=this.getEntrenadoresDisponibles().length;return e===0&&i===0?"Necesitas crear al menos un cliente y un entrenador para poder crear rutinas":e===0?"Necesitas crear al menos un cliente para poder crear rutinas":i===0?"Necesitas crear al menos un entrenador para poder crear rutinas":""}getRolesDisponibles(){return Object.values(N)}toggleDiaSemana(e,i){let o=e.target,c=this.editForm();if(!c)return;let y=c.get("DiasSemana")?.value||[];if(o.checked){if(!y.includes(i)){let k=[...y,i].sort((M,fe)=>M-fe);c.patchValue({DiasSemana:k})}}else{let k=y.filter(M=>M!==i);c.patchValue({DiasSemana:k})}}toggleEjercicio(e){let i=this.selectedEjercicios();i.includes(e)?this.selectedEjercicios.set(i.filter(o=>o!==e)):this.selectedEjercicios.set([...i,e])}isEjercicioSelected(e){return this.selectedEjercicios().includes(e)}getEjercicioById(e){return this.ejercicios().find(i=>i.id===e)}getFormFields(){switch(this.modalType()){case"usuario":return[{name:"nombre",type:"text",label:"Nombre",icon:"\u{1F4DD}",placeholder:"Nombre del usuario",colSpan:2},{name:"email",type:"text",inputType:"email",label:"Email",icon:"\u{1F4E7}",placeholder:"email@ejemplo.com",colSpan:2},{name:"role",type:"select",label:"Rol",icon:"\u{1F465}",placeholder:"Seleccionar rol",options:this.getRolesDisponibles().map(i=>({value:i,label:i})),colSpan:1},{name:"gimnasioId",type:"text",label:"Gimnasio ID",icon:"\u{1F3E2}",placeholder:"ID del gimnasio",colSpan:1}];case"cliente":return[{name:"gimnasioId",type:"text",label:"Gimnasio ID",icon:"\u{1F3E2}",placeholder:"ID del gimnasio",colSpan:1},{name:"activo",type:"checkbox",label:"Estado",icon:"\u2705",checkboxLabel:"Cliente Activo",colSpan:1},{name:"objetivo",type:"textarea",label:"Objetivo",icon:"\u{1F3AF}",placeholder:"Objetivo del cliente...",rows:3,colSpan:2}];case"rutina":return[{name:"nombre",type:"text",label:"Nombre de la Rutina",icon:"\u{1F4CB}",placeholder:"Nombre de la rutina",colSpan:2},{name:"clienteId",type:"select",label:"Cliente",icon:"\u{1F464}",placeholder:"Seleccionar cliente",options:this.getClientesDisponibles().map(i=>({value:i.uid,label:i.nombre||i.email||`Usuario ${i.uid}`})),colSpan:1},{name:"entrenadorId",type:"select",label:"Entrenador",icon:"\u{1F3C3}\u200D\u2642\uFE0F",placeholder:"Seleccionar entrenador",options:this.getEntrenadoresDisponibles().map(i=>({value:i.uid,label:i.nombre||i.email||`Entrenador ${i.uid}`})),colSpan:1},{name:"estados",type:"rutina-estados",label:"Estados",icon:"\u2699\uFE0F",colSpan:2},{name:"DiasSemana",type:"dias-semana",label:"D\xEDas de la Semana",icon:"\u{1F4C5}",colSpan:2},{name:"ejercicios",type:"ejercicios-selector",label:`Ejercicios (${this.selectedEjercicios().length} seleccionados)`,icon:"\u{1F3CB}\uFE0F",colSpan:2}];case"ejercicio":return[{name:"nombre",type:"text",label:"Nombre del Ejercicio",icon:"\u{1F3CB}\uFE0F",placeholder:"Nombre del ejercicio",colSpan:2},{name:"descripcion",type:"textarea",label:"Descripci\xF3n",icon:"\u{1F4DD}",placeholder:"Descripci\xF3n del ejercicio...",rows:2,colSpan:2},{name:"series",type:"text",inputType:"number",label:"Series",icon:"\u{1F522}",placeholder:"N\xFAmero de series",min:1,colSpan:1},{name:"repeticiones",type:"text",inputType:"number",label:"Repeticiones",icon:"\u{1F501}",placeholder:"Repeticiones por serie",min:1,colSpan:1},{name:"peso",type:"text",inputType:"number",label:"Peso (kg)",icon:"\u2696\uFE0F",placeholder:"Peso en kilogramos",min:0,step:.5,colSpan:1},{name:"serieSegundos",type:"text",inputType:"number",label:"Duraci\xF3n de Serie (seg)",icon:"\u23F1\uFE0F",placeholder:"Duraci\xF3n por serie",min:0,colSpan:1},{name:"descansoSegundos",type:"text",inputType:"number",label:"Descanso (seg)",icon:"\u{1F634}",placeholder:"Tiempo de descanso entre series",min:0,colSpan:2}];default:return[]}}cleanUndefinedFields(e){let i={};for(let[o,c]of Object.entries(e))c!=null&&(typeof c=="string"&&c===""?["id","nombre","fechaAsignacion","activa","completado"].includes(o)&&(i[o]=c):i[o]=c);return i}};l.\u0275fac=function(i){return new(i||l)},l.\u0275cmp=G({type:l,selectors:[["app-test-page"]],decls:67,vars:15,consts:[[1,"test-page-container"],[1,"test-page-header"],[1,"test-page-title"],[1,"test-page-summary"],[1,"test-page-summary-item"],[1,"test-page-summary-label"],[1,"test-page-summary-count"],[1,"test-page-summary-count","entrenadores"],[1,"test-page-warning"],[1,"test-page-grid"],[1,"test-section-card"],[1,"test-section-title"],[1,"test-section-content"],[1,"test-create-btn","usuarios",3,"click"],[1,"test-items-list"],[1,"test-item"],[1,"test-empty-state"],[1,"test-create-btn","clientes",3,"click"],[1,"test-create-btn","rutinas",3,"click","disabled","title"],[1,"test-validation-message"],[1,"test-create-btn","ejercicios",3,"click"],[1,"test-logs-section"],[1,"test-logs-list"],[1,"test-log-item"],[1,"test-modal-overlay"],[1,"test-page-warning-text"],[1,"test-item-content"],[1,"test-item-info"],[1,"test-item-actions"],["title","Editar usuario",1,"test-item-btn","edit",3,"click"],["title","Eliminar usuario",1,"test-item-btn","delete",3,"click"],["title","Editar cliente",1,"test-item-btn","edit",3,"click"],["title","Eliminar cliente",1,"test-item-btn","delete",3,"click"],[1,"text-xs"],["title","Editar rutina",1,"test-item-btn","edit",3,"click"],["title","Eliminar rutina",1,"test-item-btn","delete",3,"click"],["title","Editar ejercicio",1,"test-item-btn","edit",3,"click"],["title","Eliminar ejercicio",1,"test-item-btn","delete",3,"click"],[1,"text-sm"],[1,"test-modal-overlay",3,"click"],[1,"test-modal-content",3,"click"],[1,"test-modal-header"],[1,"test-modal-title"],["title","Cerrar",1,"test-modal-close",3,"click"],[1,"test-modal-body"],[1,"test-form",3,"formGroup"],[1,"test-modal-footer"],["type","button",1,"test-modal-btn","cancel",3,"click"],["type","button",1,"test-modal-btn","save",3,"click","disabled"],[1,"flex","items-center"],[1,"test-form-grid"],[1,"test-form-field",3,"full-width"],[1,"test-form-field"],[1,"test-form-label"],[1,"test-form-textarea",3,"formControlName","placeholder","rows"],[1,"grid","grid-cols-3","md:grid-cols-7","gap-2"],[1,"space-y-3"],[1,"test-form-input",3,"type","formControlName","placeholder","min","step"],[1,"mt-1","text-xs","text-red-600"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"formControlName"],["value",""],[3,"value"],["type","checkbox",1,"mr-2","h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"formControlName"],[1,"text-sm","font-medium","text-gray-700"],[1,"flex","items-center","text-sm"],["type","checkbox",1,"mr-1","h-3","w-3","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","checked"],[1,"border","border-gray-300","rounded-md","max-h-60","overflow-y-auto","bg-gray-50"],[1,"p-4","text-center","text-gray-500"],[1,"mt-3","p-3","bg-blue-50","border","border-blue-200","rounded-md"],[1,"flex","items-center","p-3","hover:bg-gray-100","border-b","border-gray-200","last:border-b-0","cursor-pointer"],["type","checkbox",1,"mr-3","h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","checked"],[1,"flex-1"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-800"],[1,"text-xs","text-gray-500","bg-gray-200","px-2","py-1","rounded"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-xs","text-gray-400","mt-1"],[1,"text-sm","font-medium","text-blue-800","mb-2"],[1,"flex","flex-wrap","gap-2"],[1,"inline-flex","items-center","px-2","py-1","text-xs","bg-blue-100","text-blue-800","rounded-full"],["type","button",1,"ml-1","text-blue-600","hover:text-blue-800","focus:outline-none",3,"click"],["type","checkbox","formControlName","activa",1,"mr-2","h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded"],["type","checkbox","formControlName","completado",1,"mr-2","h-4","w-4","text-green-600","focus:ring-green-500","border-gray-300","rounded"],["fill","none","viewBox","0 0 24 24",1,"test-spinner"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),s(3,"Test de servicios"),r(),a(4,"div",3)(5,"div",4)(6,"span",5),s(7,"\u{1F464} Clientes:"),r(),a(8,"span",6),s(9),r()(),a(10,"div",4)(11,"span",5),s(12,"\u{1F3C3}\u200D\u2642\uFE0F Entrenadores:"),r(),a(13,"span",7),s(14),r()(),_(15,Se,3,0,"div",8),r()(),a(16,"section",9)(17,"div",10)(18,"h2",11),s(19,"Usuarios"),r(),a(20,"div",12)(21,"button",13),u("click",function(){return o.addSampleUsuario()}),s(22," Crear usuario "),r(),a(23,"div",14),h(24,Te,12,2,"div",15,ve,!1,ye,3,0,"div",16),r()()(),a(27,"div",10)(28,"h2",11),s(29,"Clientes"),r(),a(30,"div",12)(31,"button",17),u("click",function(){return o.addSampleCliente()}),s(32," Crear cliente "),r(),a(33,"div",14),h(34,Fe,12,3,"div",15,V,!1,De,3,0,"div",16),r()()(),a(37,"div",10)(38,"h2",11),s(39,"Rutinas"),r(),a(40,"div",12)(41,"button",18),u("click",function(){return o.addSampleRutina()}),_(42,je,1,0)(43,ke,1,0),r(),_(44,we,3,1,"div",19),a(45,"div",14),h(46,Ie,14,3,"div",15,V,!1,Pe,3,0,"div",16),r()()(),a(49,"div",10)(50,"h2",11),s(51,"Ejercicios"),r(),a(52,"div",12)(53,"button",20),u("click",function(){return o.addSampleEjercicio()}),s(54," Crear ejercicio "),r(),a(55,"div",14),h(56,$e,12,3,"div",15,V,!1,Ne,3,0,"div",16),r()()()(),a(59,"section",21)(60,"h2",11),s(61,"Logs"),r(),a(62,"div",22),h(63,Ve,3,1,"div",23,q,!1,Me,3,0,"div",16),r()(),_(66,mt,16,4,"div",24),r()),i&2&&(d(9),C(o.getClientesDisponibles().length),d(5),C(o.getEntrenadoresDisponibles().length),d(),p(o.canCreateRutina()?-1:15),d(9),v(o.usuarios()),d(10),v(o.clientes()),d(7),w("disabled",!o.canCreateRutina()),E("disabled",!o.canCreateRutina())("title",o.canCreateRutina()?"Crear rutina":o.getRutinaValidationMessage()),d(),p(o.canCreateRutina()?42:43),d(2),p(o.canCreateRutina()?-1:44),d(2),v(o.rutinas()),d(10),v(o.ejercicios()),d(7),v(o.logs()),d(3),p(o.isModalOpen()?66:-1))},dependencies:[W,se,te,ae,re,Y,X,oe,Z,ee,ie,ne,Q],encapsulation:2});let n=l;return n})();export{kt as TestPage};
