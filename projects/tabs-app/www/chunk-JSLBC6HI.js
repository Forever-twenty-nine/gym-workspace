import{$ as Ys,Ab as sd,Bb as Ha,Ea as rd,Ka as yt,R as Tr,Rb as od,S as ed,U as Zt,V as td,W as Xe,X as br,_ as nd,c as Di,da as en,h as Xh,i as Zh,ia as Ar,k as Qs,ka as Js,la as Ze,m as Wa,n as Ga,ta as Xs,wb as Ka,zb as id}from"./chunk-WL3GAS2Y.js";import{a as Er,b as wr,c as Ci,e as Jh,f as Dg,g as kg,h as Xt,i as v}from"./chunk-VBFW7A5V.js";var cd=Dg((ad,Qa)=>{"use strict";(function(n){if(typeof ad=="object"&&typeof Qa<"u")Qa.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.localforage=n()}})(function(){var n,e,t;return function r(i,s,a){function u(m,w){if(!s[m]){if(!i[m]){var y=typeof Ci=="function"&&Ci;if(!w&&y)return y(m,!0);if(l)return l(m,!0);var N=new Error("Cannot find module '"+m+"'");throw N.code="MODULE_NOT_FOUND",N}var L=s[m]={exports:{}};i[m][0].call(L.exports,function(z){var $=i[m][1][z];return u($||z)},L,L.exports,r,i,s,a)}return s[m].exports}for(var l=typeof Ci=="function"&&Ci,d=0;d<a.length;d++)u(a[d]);return u}({1:[function(r,i,s){(function(a){"use strict";var u=a.MutationObserver||a.WebKitMutationObserver,l;if(u){var d=0,m=new u(z),w=a.document.createTextNode("");m.observe(w,{characterData:!0}),l=function(){w.data=d=++d%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var y=new a.MessageChannel;y.port1.onmessage=z,l=function(){y.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?l=function(){var Q=a.document.createElement("script");Q.onreadystatechange=function(){z(),Q.onreadystatechange=null,Q.parentNode.removeChild(Q),Q=null},a.document.documentElement.appendChild(Q)}:l=function(){setTimeout(z,0)};var N,L=[];function z(){N=!0;for(var Q,X,Y=L.length;Y;){for(X=L,L=[],Q=-1;++Q<Y;)X[Q]();Y=L.length}N=!1}i.exports=$;function $(Q){L.push(Q)===1&&!N&&l()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,i,s){"use strict";var a=r(1);function u(){}var l={},d=["REJECTED"],m=["FULFILLED"],w=["PENDING"];i.exports=y;function y(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,F!==u&&$(this,F)}y.prototype.catch=function(F){return this.then(null,F)},y.prototype.then=function(F,b){if(typeof F!="function"&&this.state===m||typeof b!="function"&&this.state===d)return this;var _=new this.constructor(u);if(this.state!==w){var I=this.state===m?F:b;L(_,I,this.outcome)}else this.queue.push(new N(_,F,b));return _};function N(F,b,_){this.promise=F,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}N.prototype.callFulfilled=function(F){l.resolve(this.promise,F)},N.prototype.otherCallFulfilled=function(F){L(this.promise,this.onFulfilled,F)},N.prototype.callRejected=function(F){l.reject(this.promise,F)},N.prototype.otherCallRejected=function(F){L(this.promise,this.onRejected,F)};function L(F,b,_){a(function(){var I;try{I=b(_)}catch(A){return l.reject(F,A)}I===F?l.reject(F,new TypeError("Cannot resolve promise with itself")):l.resolve(F,I)})}l.resolve=function(F,b){var _=Q(z,b);if(_.status==="error")return l.reject(F,_.value);var I=_.value;if(I)$(F,I);else{F.state=m,F.outcome=b;for(var A=-1,R=F.queue.length;++A<R;)F.queue[A].callFulfilled(b)}return F},l.reject=function(F,b){F.state=d,F.outcome=b;for(var _=-1,I=F.queue.length;++_<I;)F.queue[_].callRejected(b);return F};function z(F){var b=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof b=="function")return function(){b.apply(F,arguments)}}function $(F,b){var _=!1;function I(E){_||(_=!0,l.reject(F,E))}function A(E){_||(_=!0,l.resolve(F,E))}function R(){b(A,I)}var D=Q(R);D.status==="error"&&I(D.value)}function Q(F,b){var _={};try{_.value=F(b),_.status="success"}catch(I){_.status="error",_.value=I}return _}y.resolve=X;function X(F){return F instanceof this?F:l.resolve(new this(u),F)}y.reject=Y;function Y(F){var b=new this(u);return l.reject(b,F)}y.all=he;function he(F){var b=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=F.length,I=!1;if(!_)return this.resolve([]);for(var A=new Array(_),R=0,D=-1,E=new this(u);++D<_;)Se(F[D],D);return E;function Se(rt,nr){b.resolve(rt).then(Dt,function(Ye){I||(I=!0,l.reject(E,Ye))});function Dt(Ye){A[nr]=Ye,++R===_&&!I&&(I=!0,l.resolve(E,A))}}}y.race=_e;function _e(F){var b=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=F.length,I=!1;if(!_)return this.resolve([]);for(var A=-1,R=new this(u);++A<_;)D(F[A]);return R;function D(E){b.resolve(E).then(function(Se){I||(I=!0,l.resolve(R,Se))},function(Se){I||(I=!0,l.reject(R,Se))})}}},{1:1}],3:[function(r,i,s){(function(a){"use strict";typeof a.Promise!="function"&&(a.Promise=r(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,i,s){"use strict";var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f};function u(f,T){if(!(f instanceof T))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var d=l();function m(){try{if(!d||!d.open)return!1;var f=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),T=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!f||T)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function w(f,T){f=f||[],T=T||{};try{return new Blob(f,T)}catch(S){if(S.name!=="TypeError")throw S;for(var g=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,P=new g,C=0;C<f.length;C+=1)P.append(f[C]);return P.getBlob(T.type)}}typeof Promise>"u"&&r(3);var y=Promise;function N(f,T){T&&f.then(function(g){T(null,g)},function(g){T(g)})}function L(f,T,g){typeof T=="function"&&f.then(T),typeof g=="function"&&f.catch(g)}function z(f){return typeof f!="string"&&(console.warn(f+" used as a key, but it is not a string."),f=String(f)),f}function $(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var Q="local-forage-detect-blob-support",X=void 0,Y={},he=Object.prototype.toString,_e="readonly",F="readwrite";function b(f){for(var T=f.length,g=new ArrayBuffer(T),P=new Uint8Array(g),C=0;C<T;C++)P[C]=f.charCodeAt(C);return g}function _(f){return new y(function(T){var g=f.transaction(Q,F),P=w([""]);g.objectStore(Q).put(P,"key"),g.onabort=function(C){C.preventDefault(),C.stopPropagation(),T(!1)},g.oncomplete=function(){var C=navigator.userAgent.match(/Chrome\/(\d+)/),S=navigator.userAgent.match(/Edge\//);T(S||!C||parseInt(C[1],10)>=43)}}).catch(function(){return!1})}function I(f){return typeof X=="boolean"?y.resolve(X):_(f).then(function(T){return X=T,X})}function A(f){var T=Y[f.name],g={};g.promise=new y(function(P,C){g.resolve=P,g.reject=C}),T.deferredOperations.push(g),T.dbReady?T.dbReady=T.dbReady.then(function(){return g.promise}):T.dbReady=g.promise}function R(f){var T=Y[f.name],g=T.deferredOperations.pop();if(g)return g.resolve(),g.promise}function D(f,T){var g=Y[f.name],P=g.deferredOperations.pop();if(P)return P.reject(T),P.promise}function E(f,T){return new y(function(g,P){if(Y[f.name]=Y[f.name]||Re(),f.db)if(T)A(f),f.db.close();else return g(f.db);var C=[f.name];T&&C.push(f.version);var S=d.open.apply(d,C);T&&(S.onupgradeneeded=function(x){var M=S.result;try{M.createObjectStore(f.storeName),x.oldVersion<=1&&M.createObjectStore(Q)}catch(q){if(q.name==="ConstraintError")console.warn('The database "'+f.name+'" has been upgraded from version '+x.oldVersion+" to version "+x.newVersion+', but the storage "'+f.storeName+'" already exists.');else throw q}}),S.onerror=function(x){x.preventDefault(),P(S.error)},S.onsuccess=function(){var x=S.result;x.onversionchange=function(M){M.target.close()},g(x),R(f)}})}function Se(f){return E(f,!1)}function rt(f){return E(f,!0)}function nr(f,T){if(!f.db)return!0;var g=!f.db.objectStoreNames.contains(f.storeName),P=f.version<f.db.version,C=f.version>f.db.version;if(P&&(f.version!==T&&console.warn('The database "'+f.name+`" can't be downgraded from version `+f.db.version+" to version "+f.version+"."),f.version=f.db.version),C||g){if(g){var S=f.db.version+1;S>f.version&&(f.version=S)}return!0}return!1}function Dt(f){return new y(function(T,g){var P=new FileReader;P.onerror=g,P.onloadend=function(C){var S=btoa(C.target.result||"");T({__local_forage_encoded_blob:!0,data:S,type:f.type})},P.readAsBinaryString(f)})}function Ye(f){var T=b(atob(f.data));return w([T],{type:f.type})}function rr(f){return f&&f.__local_forage_encoded_blob}function Ts(f){var T=this,g=T._initReady().then(function(){var P=Y[T._dbInfo.name];if(P&&P.dbReady)return P.dbReady});return L(g,f,f),g}function Ca(f){A(f);for(var T=Y[f.name],g=T.forages,P=0;P<g.length;P++){var C=g[P];C._dbInfo.db&&(C._dbInfo.db.close(),C._dbInfo.db=null)}return f.db=null,Se(f).then(function(S){return f.db=S,nr(f)?rt(f):S}).then(function(S){f.db=T.db=S;for(var x=0;x<g.length;x++)g[x]._dbInfo.db=S}).catch(function(S){throw D(f,S),S})}function De(f,T,g,P){P===void 0&&(P=1);try{var C=f.db.transaction(f.storeName,T);g(null,C)}catch(S){if(P>0&&(!f.db||S.name==="InvalidStateError"||S.name==="NotFoundError"))return y.resolve().then(function(){if(!f.db||S.name==="NotFoundError"&&!f.db.objectStoreNames.contains(f.storeName)&&f.version<=f.db.version)return f.db&&(f.version=f.db.version+1),rt(f)}).then(function(){return Ca(f).then(function(){De(f,T,g,P-1)})}).catch(g);g(S)}}function Re(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Da(f){var T=this,g={db:null};if(f)for(var P in f)g[P]=f[P];var C=Y[g.name];C||(C=Re(),Y[g.name]=C),C.forages.push(T),T._initReady||(T._initReady=T.ready,T.ready=Ts);var S=[];function x(){return y.resolve()}for(var M=0;M<C.forages.length;M++){var q=C.forages[M];q!==T&&S.push(q._initReady().catch(x))}var U=C.forages.slice(0);return y.all(S).then(function(){return g.db=C.db,Se(g)}).then(function(j){return g.db=j,nr(g,T._defaultConfig.version)?rt(g):j}).then(function(j){g.db=C.db=j,T._dbInfo=g;for(var K=0;K<U.length;K++){var ie=U[K];ie!==T&&(ie._dbInfo.db=g.db,ie._dbInfo.version=g.version)}})}function In(f,T){var g=this;f=z(f);var P=new y(function(C,S){g.ready().then(function(){De(g._dbInfo,_e,function(x,M){if(x)return S(x);try{var q=M.objectStore(g._dbInfo.storeName),U=q.get(f);U.onsuccess=function(){var j=U.result;j===void 0&&(j=null),rr(j)&&(j=Ye(j)),C(j)},U.onerror=function(){S(U.error)}}catch(j){S(j)}})}).catch(S)});return N(P,T),P}function ka(f,T){var g=this,P=new y(function(C,S){g.ready().then(function(){De(g._dbInfo,_e,function(x,M){if(x)return S(x);try{var q=M.objectStore(g._dbInfo.storeName),U=q.openCursor(),j=1;U.onsuccess=function(){var K=U.result;if(K){var ie=K.value;rr(ie)&&(ie=Ye(ie));var J=f(ie,K.key,j++);J!==void 0?C(J):K.continue()}else C()},U.onerror=function(){S(U.error)}}catch(K){S(K)}})}).catch(S)});return N(P,T),P}function En(f,T,g){var P=this;f=z(f);var C=new y(function(S,x){var M;P.ready().then(function(){return M=P._dbInfo,he.call(T)==="[object Blob]"?I(M.db).then(function(q){return q?T:Dt(T)}):T}).then(function(q){De(P._dbInfo,F,function(U,j){if(U)return x(U);try{var K=j.objectStore(P._dbInfo.storeName);q===null&&(q=void 0);var ie=K.put(q,f);j.oncomplete=function(){q===void 0&&(q=null),S(q)},j.onabort=j.onerror=function(){var J=ie.error?ie.error:ie.transaction.error;x(J)}}catch(J){x(J)}})}).catch(x)});return N(C,g),C}function Na(f,T){var g=this;f=z(f);var P=new y(function(C,S){g.ready().then(function(){De(g._dbInfo,F,function(x,M){if(x)return S(x);try{var q=M.objectStore(g._dbInfo.storeName),U=q.delete(f);M.oncomplete=function(){C()},M.onerror=function(){S(U.error)},M.onabort=function(){var j=U.error?U.error:U.transaction.error;S(j)}}catch(j){S(j)}})}).catch(S)});return N(P,T),P}function Oa(f){var T=this,g=new y(function(P,C){T.ready().then(function(){De(T._dbInfo,F,function(S,x){if(S)return C(S);try{var M=x.objectStore(T._dbInfo.storeName),q=M.clear();x.oncomplete=function(){P()},x.onabort=x.onerror=function(){var U=q.error?q.error:q.transaction.error;C(U)}}catch(U){C(U)}})}).catch(C)});return N(g,f),g}function ir(f){var T=this,g=new y(function(P,C){T.ready().then(function(){De(T._dbInfo,_e,function(S,x){if(S)return C(S);try{var M=x.objectStore(T._dbInfo.storeName),q=M.count();q.onsuccess=function(){P(q.result)},q.onerror=function(){C(q.error)}}catch(U){C(U)}})}).catch(C)});return N(g,f),g}function sr(f,T){var g=this,P=new y(function(C,S){if(f<0){C(null);return}g.ready().then(function(){De(g._dbInfo,_e,function(x,M){if(x)return S(x);try{var q=M.objectStore(g._dbInfo.storeName),U=!1,j=q.openKeyCursor();j.onsuccess=function(){var K=j.result;if(!K){C(null);return}f===0||U?C(K.key):(U=!0,K.advance(f))},j.onerror=function(){S(j.error)}}catch(K){S(K)}})}).catch(S)});return N(P,T),P}function oi(f){var T=this,g=new y(function(P,C){T.ready().then(function(){De(T._dbInfo,_e,function(S,x){if(S)return C(S);try{var M=x.objectStore(T._dbInfo.storeName),q=M.openKeyCursor(),U=[];q.onsuccess=function(){var j=q.result;if(!j){P(U);return}U.push(j.key),j.continue()},q.onerror=function(){C(q.error)}}catch(j){C(j)}})}).catch(C)});return N(g,f),g}function ai(f,T){T=$.apply(this,arguments);var g=this.config();f=typeof f!="function"&&f||{},f.name||(f.name=f.name||g.name,f.storeName=f.storeName||g.storeName);var P=this,C;if(!f.name)C=y.reject("Invalid arguments");else{var S=f.name===g.name&&P._dbInfo.db,x=S?y.resolve(P._dbInfo.db):Se(f).then(function(M){var q=Y[f.name],U=q.forages;q.db=M;for(var j=0;j<U.length;j++)U[j]._dbInfo.db=M;return M});f.storeName?C=x.then(function(M){if(M.objectStoreNames.contains(f.storeName)){var q=M.version+1;A(f);var U=Y[f.name],j=U.forages;M.close();for(var K=0;K<j.length;K++){var ie=j[K];ie._dbInfo.db=null,ie._dbInfo.version=q}var J=new y(function(ce,me){var fe=d.open(f.name,q);fe.onerror=function(We){var Yt=fe.result;Yt.close(),me(We)},fe.onupgradeneeded=function(){var We=fe.result;We.deleteObjectStore(f.storeName)},fe.onsuccess=function(){var We=fe.result;We.close(),ce(We)}});return J.then(function(ce){U.db=ce;for(var me=0;me<j.length;me++){var fe=j[me];fe._dbInfo.db=ce,R(fe._dbInfo)}}).catch(function(ce){throw(D(f,ce)||y.resolve()).catch(function(){}),ce})}}):C=x.then(function(M){A(f);var q=Y[f.name],U=q.forages;M.close();for(var j=0;j<U.length;j++){var K=U[j];K._dbInfo.db=null}var ie=new y(function(J,ce){var me=d.deleteDatabase(f.name);me.onerror=function(){var fe=me.result;fe&&fe.close(),ce(me.error)},me.onblocked=function(){console.warn('dropInstance blocked for database "'+f.name+'" until all open connections are closed')},me.onsuccess=function(){var fe=me.result;fe&&fe.close(),J(fe)}});return ie.then(function(J){q.db=J;for(var ce=0;ce<U.length;ce++){var me=U[ce];R(me._dbInfo)}}).catch(function(J){throw(D(f,J)||y.resolve()).catch(function(){}),J})})}return N(C,T),C}var ci={_driver:"asyncStorage",_initStorage:Da,_support:m(),iterate:ka,getItem:In,setItem:En,removeItem:Na,clear:Oa,length:ir,key:sr,keys:oi,dropInstance:ai};function ui(){return typeof openDatabase=="function"}var it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bs="~~local_forage_type~",As=/^~~local_forage_type~([^~]+)~/,wn="__lfsc__:",or=wn.length,Tn="arbf",ar="blob",Ss="si08",cr="ui08",ur="uic8",lr="si16",Pe="si32",ke="ur16",bn="ui32",li="fl32",hi="fl64",Rs=or+Tn.length,Ht=Object.prototype.toString;function di(f){var T=f.length*.75,g=f.length,P,C=0,S,x,M,q;f[f.length-1]==="="&&(T--,f[f.length-2]==="="&&T--);var U=new ArrayBuffer(T),j=new Uint8Array(U);for(P=0;P<g;P+=4)S=it.indexOf(f[P]),x=it.indexOf(f[P+1]),M=it.indexOf(f[P+2]),q=it.indexOf(f[P+3]),j[C++]=S<<2|x>>4,j[C++]=(x&15)<<4|M>>2,j[C++]=(M&3)<<6|q&63;return U}function hr(f){var T=new Uint8Array(f),g="",P;for(P=0;P<T.length;P+=3)g+=it[T[P]>>2],g+=it[(T[P]&3)<<4|T[P+1]>>4],g+=it[(T[P+1]&15)<<2|T[P+2]>>6],g+=it[T[P+2]&63];return T.length%3===2?g=g.substring(0,g.length-1)+"=":T.length%3===1&&(g=g.substring(0,g.length-2)+"=="),g}function fi(f,T){var g="";if(f&&(g=Ht.call(f)),f&&(g==="[object ArrayBuffer]"||f.buffer&&Ht.call(f.buffer)==="[object ArrayBuffer]")){var P,C=wn;f instanceof ArrayBuffer?(P=f,C+=Tn):(P=f.buffer,g==="[object Int8Array]"?C+=Ss:g==="[object Uint8Array]"?C+=cr:g==="[object Uint8ClampedArray]"?C+=ur:g==="[object Int16Array]"?C+=lr:g==="[object Uint16Array]"?C+=ke:g==="[object Int32Array]"?C+=Pe:g==="[object Uint32Array]"?C+=bn:g==="[object Float32Array]"?C+=li:g==="[object Float64Array]"?C+=hi:T(new Error("Failed to get type for BinaryArray"))),T(C+hr(P))}else if(g==="[object Blob]"){var S=new FileReader;S.onload=function(){var x=bs+f.type+"~"+hr(this.result);T(wn+ar+x)},S.readAsArrayBuffer(f)}else try{T(JSON.stringify(f))}catch(x){console.error("Couldn't convert value into a JSON string: ",f),T(null,x)}}function xa(f){if(f.substring(0,or)!==wn)return JSON.parse(f);var T=f.substring(Rs),g=f.substring(or,Rs),P;if(g===ar&&As.test(T)){var C=T.match(As);P=C[1],T=T.substring(C[0].length)}var S=di(T);switch(g){case Tn:return S;case ar:return w([S],{type:P});case Ss:return new Int8Array(S);case cr:return new Uint8Array(S);case ur:return new Uint8ClampedArray(S);case lr:return new Int16Array(S);case ke:return new Uint16Array(S);case Pe:return new Int32Array(S);case bn:return new Uint32Array(S);case li:return new Float32Array(S);case hi:return new Float64Array(S);default:throw new Error("Unkown type: "+g)}}var pi={serialize:fi,deserialize:xa,stringToBuffer:di,bufferToString:hr};function dr(f,T,g,P){f.executeSql("CREATE TABLE IF NOT EXISTS "+T.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],g,P)}function Ps(f){var T=this,g={db:null};if(f)for(var P in f)g[P]=typeof f[P]!="string"?f[P].toString():f[P];var C=new y(function(S,x){try{g.db=openDatabase(g.name,String(g.version),g.description,g.size)}catch(M){return x(M)}g.db.transaction(function(M){dr(M,g,function(){T._dbInfo=g,S()},function(q,U){x(U)})},x)});return g.serializer=pi,C}function st(f,T,g,P,C,S){f.executeSql(g,P,C,function(x,M){M.code===M.SYNTAX_ERR?x.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[T.storeName],function(q,U){U.rows.length?S(q,M):dr(q,T,function(){q.executeSql(g,P,C,S)},S)},S):S(x,M)},S)}function An(f,T){var g=this;f=z(f);var P=new y(function(C,S){g.ready().then(function(){var x=g._dbInfo;x.db.transaction(function(M){st(M,x,"SELECT * FROM "+x.storeName+" WHERE key = ? LIMIT 1",[f],function(q,U){var j=U.rows.length?U.rows.item(0).value:null;j&&(j=x.serializer.deserialize(j)),C(j)},function(q,U){S(U)})})}).catch(S)});return N(P,T),P}function mi(f,T){var g=this,P=new y(function(C,S){g.ready().then(function(){var x=g._dbInfo;x.db.transaction(function(M){st(M,x,"SELECT * FROM "+x.storeName,[],function(q,U){for(var j=U.rows,K=j.length,ie=0;ie<K;ie++){var J=j.item(ie),ce=J.value;if(ce&&(ce=x.serializer.deserialize(ce)),ce=f(ce,J.key,ie+1),ce!==void 0){C(ce);return}}C()},function(q,U){S(U)})})}).catch(S)});return N(P,T),P}function fr(f,T,g,P){var C=this;f=z(f);var S=new y(function(x,M){C.ready().then(function(){T===void 0&&(T=null);var q=T,U=C._dbInfo;U.serializer.serialize(T,function(j,K){K?M(K):U.db.transaction(function(ie){st(ie,U,"INSERT OR REPLACE INTO "+U.storeName+" (key, value) VALUES (?, ?)",[f,j],function(){x(q)},function(J,ce){M(ce)})},function(ie){if(ie.code===ie.QUOTA_ERR){if(P>0){x(fr.apply(C,[f,q,g,P-1]));return}M(ie)}})})}).catch(M)});return N(S,g),S}function kt(f,T,g){return fr.apply(this,[f,T,g,1])}function Cs(f,T){var g=this;f=z(f);var P=new y(function(C,S){g.ready().then(function(){var x=g._dbInfo;x.db.transaction(function(M){st(M,x,"DELETE FROM "+x.storeName+" WHERE key = ?",[f],function(){C()},function(q,U){S(U)})})}).catch(S)});return N(P,T),P}function pr(f){var T=this,g=new y(function(P,C){T.ready().then(function(){var S=T._dbInfo;S.db.transaction(function(x){st(x,S,"DELETE FROM "+S.storeName,[],function(){P()},function(M,q){C(q)})})}).catch(C)});return N(g,f),g}function Ds(f){var T=this,g=new y(function(P,C){T.ready().then(function(){var S=T._dbInfo;S.db.transaction(function(x){st(x,S,"SELECT COUNT(key) as c FROM "+S.storeName,[],function(M,q){var U=q.rows.item(0).c;P(U)},function(M,q){C(q)})})}).catch(C)});return N(g,f),g}function Sn(f,T){var g=this,P=new y(function(C,S){g.ready().then(function(){var x=g._dbInfo;x.db.transaction(function(M){st(M,x,"SELECT key FROM "+x.storeName+" WHERE id = ? LIMIT 1",[f+1],function(q,U){var j=U.rows.length?U.rows.item(0).key:null;C(j)},function(q,U){S(U)})})}).catch(S)});return N(P,T),P}function ks(f){var T=this,g=new y(function(P,C){T.ready().then(function(){var S=T._dbInfo;S.db.transaction(function(x){st(x,S,"SELECT key FROM "+S.storeName,[],function(M,q){for(var U=[],j=0;j<q.rows.length;j++)U.push(q.rows.item(j).key);P(U)},function(M,q){C(q)})})}).catch(C)});return N(g,f),g}function Ve(f){return new y(function(T,g){f.transaction(function(P){P.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(C,S){for(var x=[],M=0;M<S.rows.length;M++)x.push(S.rows.item(M).name);T({db:f,storeNames:x})},function(C,S){g(S)})},function(P){g(P)})})}function Ns(f,T){T=$.apply(this,arguments);var g=this.config();f=typeof f!="function"&&f||{},f.name||(f.name=f.name||g.name,f.storeName=f.storeName||g.storeName);var P=this,C;return f.name?C=new y(function(S){var x;f.name===g.name?x=P._dbInfo.db:x=openDatabase(f.name,"","",0),f.storeName?S({db:x,storeNames:[f.storeName]}):S(Ve(x))}).then(function(S){return new y(function(x,M){S.db.transaction(function(q){function U(J){return new y(function(ce,me){q.executeSql("DROP TABLE IF EXISTS "+J,[],function(){ce()},function(fe,We){me(We)})})}for(var j=[],K=0,ie=S.storeNames.length;K<ie;K++)j.push(U(S.storeNames[K]));y.all(j).then(function(){x()}).catch(function(J){M(J)})},function(q){M(q)})})}):C=y.reject("Invalid arguments"),N(C,T),C}var Rn={_driver:"webSQLStorage",_initStorage:Ps,_support:ui(),iterate:mi,getItem:An,setItem:kt,removeItem:Cs,clear:pr,length:Ds,key:Sn,keys:ks,dropInstance:Ns};function Pn(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Os(f,T){var g=f.name+"/";return f.storeName!==T.storeName&&(g+=f.storeName+"/"),g}function Va(){var f="_localforage_support_test";try{return localStorage.setItem(f,!0),localStorage.removeItem(f),!1}catch{return!0}}function Qt(){return!Va()||localStorage.length>0}function La(f){var T=this,g={};if(f)for(var P in f)g[P]=f[P];return g.keyPrefix=Os(f,T._defaultConfig),Qt()?(T._dbInfo=g,g.serializer=pi,y.resolve()):y.reject()}function Ma(f){var T=this,g=T.ready().then(function(){for(var P=T._dbInfo.keyPrefix,C=localStorage.length-1;C>=0;C--){var S=localStorage.key(C);S.indexOf(P)===0&&localStorage.removeItem(S)}});return N(g,f),g}function mr(f,T){var g=this;f=z(f);var P=g.ready().then(function(){var C=g._dbInfo,S=localStorage.getItem(C.keyPrefix+f);return S&&(S=C.serializer.deserialize(S)),S});return N(P,T),P}function xs(f,T){var g=this,P=g.ready().then(function(){for(var C=g._dbInfo,S=C.keyPrefix,x=S.length,M=localStorage.length,q=1,U=0;U<M;U++){var j=localStorage.key(U);if(j.indexOf(S)===0){var K=localStorage.getItem(j);if(K&&(K=C.serializer.deserialize(K)),K=f(K,j.substring(x),q++),K!==void 0)return K}}});return N(P,T),P}function gi(f,T){var g=this,P=g.ready().then(function(){var C=g._dbInfo,S;try{S=localStorage.key(f)}catch{S=null}return S&&(S=S.substring(C.keyPrefix.length)),S});return N(P,T),P}function gr(f){var T=this,g=T.ready().then(function(){for(var P=T._dbInfo,C=localStorage.length,S=[],x=0;x<C;x++){var M=localStorage.key(x);M.indexOf(P.keyPrefix)===0&&S.push(M.substring(P.keyPrefix.length))}return S});return N(g,f),g}function pt(f){var T=this,g=T.keys().then(function(P){return P.length});return N(g,f),g}function Vs(f,T){var g=this;f=z(f);var P=g.ready().then(function(){var C=g._dbInfo;localStorage.removeItem(C.keyPrefix+f)});return N(P,T),P}function Ls(f,T,g){var P=this;f=z(f);var C=P.ready().then(function(){T===void 0&&(T=null);var S=T;return new y(function(x,M){var q=P._dbInfo;q.serializer.serialize(T,function(U,j){if(j)M(j);else try{localStorage.setItem(q.keyPrefix+f,U),x(S)}catch(K){(K.name==="QuotaExceededError"||K.name==="NS_ERROR_DOM_QUOTA_REACHED")&&M(K),M(K)}})})});return N(C,g),C}function _i(f,T){if(T=$.apply(this,arguments),f=typeof f!="function"&&f||{},!f.name){var g=this.config();f.name=f.name||g.name,f.storeName=f.storeName||g.storeName}var P=this,C;return f.name?C=new y(function(S){f.storeName?S(Os(f,P._defaultConfig)):S(f.name+"/")}).then(function(S){for(var x=localStorage.length-1;x>=0;x--){var M=localStorage.key(x);M.indexOf(S)===0&&localStorage.removeItem(M)}}):C=y.reject("Invalid arguments"),N(C,T),C}var yi={_driver:"localStorageWrapper",_initStorage:La,_support:Pn(),iterate:xs,getItem:mr,setItem:Ls,removeItem:Vs,clear:Ma,length:pt,key:gi,keys:gr,dropInstance:_i},Ms=function(T,g){return T===g||typeof T=="number"&&typeof g=="number"&&isNaN(T)&&isNaN(g)},Fs=function(T,g){for(var P=T.length,C=0;C<P;){if(Ms(T[C],g))return!0;C++}return!1},Us=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"},mt={},vi={},gt={INDEXEDDB:ci,WEBSQL:Rn,LOCALSTORAGE:yi},Cn=[gt.INDEXEDDB._driver,gt.WEBSQL._driver,gt.LOCALSTORAGE._driver],Je=["dropInstance"],Dn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Je),Fa={description:"",driver:Cn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Bs(f,T){f[T]=function(){var g=arguments;return f.ready().then(function(){return f[T].apply(f,g)})}}function _r(){for(var f=1;f<arguments.length;f++){var T=arguments[f];if(T)for(var g in T)T.hasOwnProperty(g)&&(Us(T[g])?arguments[0][g]=T[g].slice():arguments[0][g]=T[g])}return arguments[0]}var qs=function(){function f(T){u(this,f);for(var g in gt)if(gt.hasOwnProperty(g)){var P=gt[g],C=P._driver;this[g]=C,mt[C]||this.defineDriver(P)}this._defaultConfig=_r({},Fa),this._config=_r({},this._defaultConfig,T),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return f.prototype.config=function(g){if((typeof g>"u"?"undefined":a(g))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var P in g){if(P==="storeName"&&(g[P]=g[P].replace(/\W/g,"_")),P==="version"&&typeof g[P]!="number")return new Error("Database version must be a number.");this._config[P]=g[P]}return"driver"in g&&g.driver?this.setDriver(this._config.driver):!0}else return typeof g=="string"?this._config[g]:this._config},f.prototype.defineDriver=function(g,P,C){var S=new y(function(x,M){try{var q=g._driver,U=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!g._driver){M(U);return}for(var j=Dn.concat("_initStorage"),K=0,ie=j.length;K<ie;K++){var J=j[K],ce=!Fs(Je,J);if((ce||g[J])&&typeof g[J]!="function"){M(U);return}}var me=function(){for(var Yt=function(kn){return function(){var _t=new Error("Method "+kn+" is not implemented by the current driver"),Ti=y.reject(_t);return N(Ti,arguments[arguments.length-1]),Ti}},Ei=0,Ua=Je.length;Ei<Ua;Ei++){var wi=Je[Ei];g[wi]||(g[wi]=Yt(wi))}};me();var fe=function(Yt){mt[q]&&console.info("Redefining LocalForage driver: "+q),mt[q]=g,vi[q]=Yt,x()};"_support"in g?g._support&&typeof g._support=="function"?g._support().then(fe,M):fe(!!g._support):fe(!0)}catch(We){M(We)}});return L(S,P,C),S},f.prototype.driver=function(){return this._driver||null},f.prototype.getDriver=function(g,P,C){var S=mt[g]?y.resolve(mt[g]):y.reject(new Error("Driver not found."));return L(S,P,C),S},f.prototype.getSerializer=function(g){var P=y.resolve(pi);return L(P,g),P},f.prototype.ready=function(g){var P=this,C=P._driverSet.then(function(){return P._ready===null&&(P._ready=P._initDriver()),P._ready});return L(C,g,g),C},f.prototype.setDriver=function(g,P,C){var S=this;Us(g)||(g=[g]);var x=this._getSupportedDrivers(g);function M(){S._config.driver=S.driver()}function q(K){return S._extend(K),M(),S._ready=S._initStorage(S._config),S._ready}function U(K){return function(){var ie=0;function J(){for(;ie<K.length;){var ce=K[ie];return ie++,S._dbInfo=null,S._ready=null,S.getDriver(ce).then(q).catch(J)}M();var me=new Error("No available storage method found.");return S._driverSet=y.reject(me),S._driverSet}return J()}}var j=this._driverSet!==null?this._driverSet.catch(function(){return y.resolve()}):y.resolve();return this._driverSet=j.then(function(){var K=x[0];return S._dbInfo=null,S._ready=null,S.getDriver(K).then(function(ie){S._driver=ie._driver,M(),S._wrapLibraryMethodsWithReady(),S._initDriver=U(x)})}).catch(function(){M();var K=new Error("No available storage method found.");return S._driverSet=y.reject(K),S._driverSet}),L(this._driverSet,P,C),this._driverSet},f.prototype.supports=function(g){return!!vi[g]},f.prototype._extend=function(g){_r(this,g)},f.prototype._getSupportedDrivers=function(g){for(var P=[],C=0,S=g.length;C<S;C++){var x=g[C];this.supports(x)&&P.push(x)}return P},f.prototype._wrapLibraryMethodsWithReady=function(){for(var g=0,P=Dn.length;g<P;g++)Bs(this,Dn[g])},f.prototype.createInstance=function(g){return new f(g)},f}(),Ii=new qs;i.exports=Ii},{3:3}]},{},[4])(4)})});var ki=kg(cd());var Zs={SecureStorage:"ionicSecureStorage",IndexedDB:ki.default.INDEXEDDB,LocalStorage:ki.default.LOCALSTORAGE},ud={name:"_ionicstorage",storeName:"_ionickv",dbKey:"_ionickey",driverOrder:[Zs.SecureStorage,Zs.IndexedDB,Zs.LocalStorage]},Ot=class{constructor(e=ud){this._db=null,this._secureStorageDriver=null;let t=Object.assign({},ud,e||{});this._config=t}create(){return v(this,null,function*(){let e=ki.default.createInstance(this._config);return this._db=e,yield e.setDriver(this._config.driverOrder||[]),this})}defineDriver(e){return v(this,null,function*(){return e._driver===Zs.SecureStorage&&(this._secureStorageDriver=e),ki.default.defineDriver(e)})}get driver(){var e;return((e=this._db)===null||e===void 0?void 0:e.driver())||null}assertDb(){if(!this._db)throw new Error("Database not created. Must call create() first");return this._db}get(e){return this.assertDb().getItem(e)}set(e,t){return this.assertDb().setItem(e,t)}remove(e){return this.assertDb().removeItem(e)}clear(){return this.assertDb().clear()}length(){return this.assertDb().length()}keys(){return this.assertDb().keys()}forEach(e){return this.assertDb().iterate(e)}setEncryptionKey(e){var t;if(this._secureStorageDriver)(t=this._secureStorageDriver)===null||t===void 0||t.setEncryptionKey(e);else throw new Error("@ionic-enterprise/secure-storage not installed. Encryption support not available")}};var ld=new Zt("STORAGE_CONFIG_TOKEN"),Ya=class extends Ot{constructor(){super()}create(){return v(this,null,function*(){return this})}defineDriver(){return v(this,null,function*(){})}get driver(){return"noop"}get(e){return v(this,null,function*(){return null})}set(e,t){return v(this,null,function*(){})}remove(e){return v(this,null,function*(){})}clear(){return v(this,null,function*(){})}length(){return v(this,null,function*(){return 0})}keys(){return v(this,null,function*(){return[]})}forEach(e){return v(this,null,function*(){})}setEncryptionKey(e){}};function Ng(n,e){return od(n)?new Ya:new Ot(e)}var AT=(()=>{class n{static forRoot(t=null){return{ngModule:n,providers:[{provide:ld,useValue:t},{provide:Ot,useFactory:Ng,deps:[Xs,ld]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=rd({type:n}),n.\u0275inj=ed({}),n})();var hd=()=>{};var pd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},xg=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},eo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,m=s>>2,w=(s&3)<<4|u>>4,y=(u&15)<<2|d>>6,N=d&63;l||(N=64,a||(y=64)),r.push(t[m],t[w],t[y],t[N])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):xg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let w=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||w==null)throw new Za;let y=s<<2|u>>4;if(r.push(y),d!==64){let N=u<<4&240|d>>2;if(r.push(N),w!==64){let L=d<<6&192|w;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Za=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Vg=function(n){let e=pd(n);return eo.encodeByteArray(e,!0)},Oi=function(n){return Vg(n).replace(/\./g,"")},to=function(n){try{return eo.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function tc(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Lg=()=>tc().__FIREBASE_DEFAULTS__,Mg=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Fg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&to(n[1]);return e&&JSON.parse(e)},no=()=>{try{return hd()||Lg()||Mg()||Fg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nc=n=>{var e,t;return(t=(e=no())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},md=n=>{let e=nc(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},rc=()=>{var n;return(n=no())===null||n===void 0?void 0:n.config},ic=n=>{var e;return(e=no())===null||e===void 0?void 0:e[`_${n}`]};var On=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function tn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function ro(n){return v(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function gd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Oi(JSON.stringify(t)),Oi(JSON.stringify(a)),""].join(".")}var Ni={};function Ug(){let n={prod:[],emulator:[]};for(let e of Object.keys(Ni))Ni[e]?n.emulator.push(e):n.prod.push(e);return n}function Bg(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var dd=!1;function io(n,e){if(typeof window>"u"||typeof document>"u"||!tn(window.location.host)||Ni[n]===e||Ni[n]||dd)return;Ni[n]=e;function t(y){return`__firebase__banner__${y}`}let r="__firebase__banner",s=Ug().prod.length>0;function a(){let y=document.getElementById(r);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function l(y,N){y.setAttribute("width","24"),y.setAttribute("id",N),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{dd=!0,a()},y}function m(y,N){y.setAttribute("id",N),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function w(){let y=Bg(r),N=t("text"),L=document.getElementById(N)||document.createElement("span"),z=t("learnmore"),$=document.getElementById(z)||document.createElement("a"),Q=t("preprendIcon"),X=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let Y=y.element;u(Y),m($,z);let he=d();l(X,Q),Y.append(X,L,$,he),document.body.appendChild(Y)}s?(L.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,L.innerText="Preview backend running in this workspace."),L.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function Ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function _d(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ne())}function qg(){var n;let e=(n=no())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Id(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ed(){let n=Ne();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function wd(){return!qg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xi(){try{return typeof indexedDB=="object"}catch{return!1}}function Td(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var $g="FirebaseError",He=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=$g,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,at.prototype.create)}},at=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?jg(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new He(i,u,r)}};function jg(n,e){return n.replace(zg,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var zg=/\{\$([^}]+)}/g;function bd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function vt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(fd(s)&&fd(a)){if(!vt(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function fd(n){return n!==null&&typeof n=="object"}function Sr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Rr(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Pr(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Ad(n,e){let t=new ec(n,e);return t.subscribe.bind(t)}var ec=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Wg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Xa),i.error===void 0&&(i.error=Xa),i.complete===void 0&&(i.complete=Xa);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Wg(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Xa(){}var DT=4*60*60*1e3;function Be(n){return n&&n._delegate?n._delegate:n}var ze=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var xn="[DEFAULT]";var sc=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new On;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Kg(e))try{this.getOrInitializeService({instanceIdentifier:xn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=xn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return v(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=xn){return this.instances.has(e)}getOptions(e=xn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Gg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xn){return this.component?this.component.multipleInstances?e:xn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Gg(n){return n===xn?void 0:n}function Kg(n){return n.instantiationMode==="EAGER"}var so=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new sc(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Hg=[],oe=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(oe||{}),Qg={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},Yg=oe.INFO,Jg={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},Xg=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Jg[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},It=class{constructor(e){this.name=e,this._logLevel=Yg,this._logHandler=Xg,this._userLogHandler=null,Hg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Qg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}};var Zg=(n,e)=>e.some(t=>n instanceof t),Sd,Rd;function e_(){return Sd||(Sd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function t_(){return Rd||(Rd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Pd=new WeakMap,ac=new WeakMap,Cd=new WeakMap,oc=new WeakMap,uc=new WeakMap;function n_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Et(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Pd.set(t,n)}).catch(()=>{}),uc.set(e,n),e}function r_(n){if(ac.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});ac.set(n,e)}var cc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ac.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Cd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Dd(n){cc=n(cc)}function i_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(oo(this),e,...t);return Cd.set(r,e.sort?e.sort():[e]),Et(r)}:t_().includes(n)?function(...e){return n.apply(oo(this),e),Et(Pd.get(this))}:function(...e){return Et(n.apply(oo(this),e))}}function s_(n){return typeof n=="function"?i_(n):(n instanceof IDBTransaction&&r_(n),Zg(n,e_())?new Proxy(n,cc):n)}function Et(n){if(n instanceof IDBRequest)return n_(n);if(oc.has(n))return oc.get(n);let e=s_(n);return e!==n&&(oc.set(n,e),uc.set(e,n)),e}var oo=n=>uc.get(n);function Nd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=Et(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Et(a.result),l.oldVersion,l.newVersion,Et(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var o_=["get","getKey","getAll","getAllKeys","count"],a_=["put","add","delete","clear"],lc=new Map;function kd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(lc.get(e))return lc.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=a_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||o_.includes(t)))return;let s=function(a,...u){return v(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&l.done]))[0]})};return lc.set(e,s),s}Dd(n=>wr(Er({},n),{get:(e,t,r)=>kd(e,t)||n.get(e,t,r),has:(e,t)=>!!kd(e,t)||n.has(e,t)}));var dc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(c_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function c_(n){let e=n.getComponent();return e?.type==="VERSION"}var fc="@firebase/app",Od="0.13.2";var xt=new It("@firebase/app"),u_="@firebase/app-compat",l_="@firebase/analytics-compat",h_="@firebase/analytics",d_="@firebase/app-check-compat",f_="@firebase/app-check",p_="@firebase/auth",m_="@firebase/auth-compat",g_="@firebase/database",__="@firebase/data-connect",y_="@firebase/database-compat",v_="@firebase/functions",I_="@firebase/functions-compat",E_="@firebase/installations",w_="@firebase/installations-compat",T_="@firebase/messaging",b_="@firebase/messaging-compat",A_="@firebase/performance",S_="@firebase/performance-compat",R_="@firebase/remote-config",P_="@firebase/remote-config-compat",C_="@firebase/storage",D_="@firebase/storage-compat",k_="@firebase/firestore",N_="@firebase/ai",O_="@firebase/firestore-compat",x_="firebase",V_="11.10.0";var pc="[DEFAULT]",L_={[fc]:"fire-core",[u_]:"fire-core-compat",[h_]:"fire-analytics",[l_]:"fire-analytics-compat",[f_]:"fire-app-check",[d_]:"fire-app-check-compat",[p_]:"fire-auth",[m_]:"fire-auth-compat",[g_]:"fire-rtdb",[__]:"fire-data-connect",[y_]:"fire-rtdb-compat",[v_]:"fire-fn",[I_]:"fire-fn-compat",[E_]:"fire-iid",[w_]:"fire-iid-compat",[T_]:"fire-fcm",[b_]:"fire-fcm-compat",[A_]:"fire-perf",[S_]:"fire-perf-compat",[R_]:"fire-rc",[P_]:"fire-rc-compat",[C_]:"fire-gcs",[D_]:"fire-gcs-compat",[k_]:"fire-fst",[O_]:"fire-fst-compat",[N_]:"fire-vertex","fire-js":"fire-js",[x_]:"fire-js-all"};var Vi=new Map,M_=new Map,mc=new Map;function xd(n,e){try{n.container.addComponent(e)}catch(t){xt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ct(n){let e=n.name;if(mc.has(e))return xt.debug(`There were multiple attempts to register component ${e}.`),!1;mc.set(e,n);for(let t of Vi.values())xd(t,n);for(let t of M_.values())xd(t,n);return!0}function Cr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ge(n){return n==null?!1:n.settings!==void 0}var F_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nn=new at("app","Firebase",F_);var gc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ze("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw nn.create("app-deleted",{appName:this._name})}};var rn=V_;function vc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:pc,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw nn.create("bad-app-name",{appName:String(i)});if(t||(t=rc()),!t)throw nn.create("no-options");let s=Vi.get(i);if(s){if(vt(t,s.options)&&vt(r,s.config))return s;throw nn.create("duplicate-app",{appName:i})}let a=new so(i);for(let l of mc.values())a.addComponent(l);let u=new gc(t,r,a);return Vi.set(i,u),u}function Vn(n=pc){let e=Vi.get(n);if(!e&&n===pc&&rc())return vc();if(!e)throw nn.create("no-app",{appName:n});return e}function ao(){return Array.from(Vi.values())}function Ie(n,e,t){var r;let i=(r=L_[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xt.warn(u.join(" "));return}ct(new ze(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var U_="firebase-heartbeat-database",B_=1,Li="firebase-heartbeat-store",hc=null;function Fd(){return hc||(hc=Nd(U_,B_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Li)}catch(t){console.warn(t)}}}}).catch(n=>{throw nn.create("idb-open",{originalErrorMessage:n.message})})),hc}function q_(n){return v(this,null,function*(){try{let t=(yield Fd()).transaction(Li),r=yield t.objectStore(Li).get(Ud(n));return yield t.done,r}catch(e){if(e instanceof He)xt.warn(e.message);else{let t=nn.create("idb-get",{originalErrorMessage:e?.message});xt.warn(t.message)}}})}function Vd(n,e){return v(this,null,function*(){try{let r=(yield Fd()).transaction(Li,"readwrite");yield r.objectStore(Li).put(e,Ud(n)),yield r.done}catch(t){if(t instanceof He)xt.warn(t.message);else{let r=nn.create("idb-set",{originalErrorMessage:t?.message});xt.warn(r.message)}}})}function Ud(n){return`${n.name}!${n.options.appId}`}var $_=1024,j_=30,_c=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new yc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return v(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ld();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>j_){let a=W_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){xt.warn(r)}})}getHeartbeatsHeader(){return v(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Ld(),{heartbeatsToSend:r,unsentEntries:i}=z_(this._heartbeatsCache.heartbeats),s=Oi(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return xt.warn(t),""}})}};function Ld(){return new Date().toISOString().substring(0,10)}function z_(n,e=$_){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Md(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Md(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var yc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return v(this,null,function*(){return xi()?Td().then(()=>!0).catch(()=>!1):!1})}read(){return v(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield q_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Vd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Vd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Md(n){return Oi(JSON.stringify({version:2,heartbeats:n})).length}function W_(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function G_(n){ct(new ze("platform-logger",e=>new dc(e),"PRIVATE")),ct(new ze("heartbeat",e=>new _c(e),"PRIVATE")),Ie(fc,Od,n),Ie(fc,Od,"esm2017"),Ie("fire-js","")}G_("");var K_="firebase",H_="11.10.0";Ie(K_,H_,"app");function Bd(n){n===void 0&&(n=Xe(en));let e=n.get(Js);return t=>new Di(r=>{let i=e.add(),s=!1;function a(){s||(i(),s=!0)}let u=t.subscribe({next:l=>{r.next(l),a()},complete:()=>{r.complete(),a()},error:l=>{r.error(l),a()}});return u.add(()=>{r.unsubscribe(),a()}),u})}var sn=new id("ANGULARFIRE2_VERSION");function Mi(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var kr=(n,e)=>{let t=e?[e]:ao(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Dr=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Dr||{}),qd=Ha()&&typeof Zone<"u"?Dr.WARN:Dr.SILENT;var co=class{zone;delegate;constructor(e,t=Zh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(s,t,r)}},on=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Xe(yt);this.outsideAngular=t.runOutsideAngular(()=>new co(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new co(typeof Zone>"u"?void 0:Zone.current,Xh))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Tr({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$d=!1;function Q_(n,e){!$d&&(qd>Dr.SILENT||Ha())&&($d=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),qd>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Y_(n){let e=Xe(yt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Ln(n){let e=Xe(yt,{optional:!0});return e?e.run(()=>n()):n()}var J_=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Ys(t,()=>Ln(()=>n.apply(void 0,r)))),qe=(n,e,t)=>(t||=e?Dr.WARN:Dr.VERBOSE,function(){let r,i=arguments,s,a,u;try{s=Xe(on),a=Xe(Js),u=Xe(nd)}catch{return Q_(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=Ln(()=>a.add())),i[d]=J_(i[d],r,u));let l=Y_(()=>n.apply(this,i));return e?l instanceof Di?l.pipe(Ga(s.outsideAngular),Wa(s.insideAngular),Bd(u)):l instanceof Promise?Ln(()=>{let d=a.add();return new Promise((m,w)=>{l.then(y=>Ys(u,()=>Ln(()=>m(y))),y=>Ys(u,()=>Ln(()=>w(y)))).finally(d)})}):typeof l=="function"&&r?function(){return setTimeout(r,0),l.apply(this,arguments)}:Ln(()=>l):l instanceof Di?l.pipe(Ga(s.outsideAngular),Wa(s.insideAngular)):Ln(()=>l)});var Vt=class{constructor(e){return e}},Mn=class{constructor(){return ao()}};function X_(n){return n&&n.length===1?n[0]:new Vt(Vn())}var Ic=new Zt("angularfire2._apps"),Z_={provide:Vt,useFactory:X_,deps:[[new Ze,Ic]]},ey={provide:Mn,deps:[[new Ze,Ic]]};function ty(n){return(e,t)=>{let r=t.get(Xs);Ie("angularfire",sn.full,"core"),Ie("angularfire",sn.full,"app"),Ie("angular",sd.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Vt(i)}}function Rb(n,...e){return br([Z_,ey,{provide:Ic,useFactory:ty(n),multi:!0,deps:[yt,en,on,...e]}])}var Pb=qe(vc,!0);var ny=new Map,ry={activated:!1,tokenObservers:[]},iy={initialized:!1,enabled:!1};function ut(n){return ny.get(n)||Object.assign({},ry)}function Gd(){return iy}var sy="https://content-firebaseappcheck.googleapis.com/v1";var oy="exchangeDebugToken",jd={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Mb=24*60*60*1e3;var Tc=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new On,this.pending.promise.catch(t=>{}),yield ay(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new On,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function ay(n){return new Promise(e=>{setTimeout(e,n)})}var cy={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},an=new at("appCheck","AppCheck",cy);function Kd(n){if(!ut(n).activated)throw an.create("use-before-activation",{appName:n.name})}function Hd(r,i){return v(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let N=yield a.getHeartbeatsHeader();N&&(s["X-Firebase-Client"]=N)}let u={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,u)}catch(N){throw an.create("fetch-network-error",{originalErrorMessage:N?.message})}if(l.status!==200)throw an.create("fetch-status-error",{httpStatus:l.status});let d;try{d=yield l.json()}catch(N){throw an.create("fetch-parse-error",{originalErrorMessage:N?.message})}let m=d.ttl.match(/^([\d.]+)(s)$/);if(!m||!m[2]||isNaN(Number(m[1])))throw an.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let w=Number(m[1])*1e3,y=Date.now();return{token:d.token,expireTimeMillis:y+w,issuedAtTimeMillis:y}})}function Qd(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${sy}/projects/${t}/apps/${r}:${oy}?key=${i}`,body:{debug_token:e}}}var uy="firebase-app-check-database",ly=1,bc="firebase-app-check-store";var uo=null;function hy(){return uo||(uo=new Promise((n,e)=>{try{let t=indexedDB.open(uy,ly);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(an.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(bc,{keyPath:"compositeKey"})}}}catch(t){e(an.create("storage-open",{originalErrorMessage:t?.message}))}}),uo)}function dy(n,e){return fy(py(n),e)}function fy(n,e){return v(this,null,function*(){let r=(yield hy()).transaction(bc,"readwrite"),s=r.objectStore(bc).put({compositeKey:n,value:e});return new Promise((a,u)=>{s.onsuccess=l=>{a()},r.onerror=l=>{var d;u(an.create("storage-set",{originalErrorMessage:(d=l.target.error)===null||d===void 0?void 0:d.message}))}})})}function py(n){return`${n.options.appId}-${n.name}`}var Fi=new It("@firebase/app-check");function Ec(n,e){return xi()?dy(n,e).catch(t=>{Fi.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Yd(){return Gd().enabled}function Jd(){return v(this,null,function*(){let n=Gd();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var my={error:"UNKNOWN_ERROR"};function gy(n){return eo.encodeString(JSON.stringify(n),!1)}function Ac(n,e=!1,t=!1){return v(this,null,function*(){let r=n.app;Kd(r);let i=ut(r),s=i.token,a;if(s&&!Ui(s)&&(i.token=void 0,s=void 0),!s){let d=yield i.cachedTokenPromise;d&&(Ui(d)?s=d:yield Ec(r,void 0))}if(!e&&s&&Ui(s))return{token:s.token};let u=!1;if(Yd())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=Hd(Qd(r,yield Jd()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=yield i.exchangeTokenPromise;return yield Ec(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Fi.warn(d.message):t&&Fi.error(d),wc(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),s=yield ut(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Fi.warn(d.message):t&&Fi.error(d),a=d}let l;return s?a?Ui(s)?l={token:s.token,internalError:a}:l=wc(a):(l={token:s.token},i.token=s,yield Ec(r,s)):l=wc(a),u&&Iy(r,l),l})}function _y(n){return v(this,null,function*(){let e=n.app;Kd(e);let{provider:t}=ut(e);if(Yd()){let r=yield Jd(),{token:i}=yield Hd(Qd(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function yy(n,e,t,r){let{app:i}=n,s=ut(i),a={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Ui(s.token)){let u=s.token;Promise.resolve().then(()=>{t({token:u.token}),zd(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>zd(n))}function Xd(n,e){let t=ut(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function zd(n){let{app:e}=n,t=ut(e),r=t.tokenRefresher;r||(r=vy(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function vy(n){let{app:e}=n;return new Tc(()=>v(null,null,function*(){let t=ut(e),r;if(t.token?r=yield Ac(n,!0):r=yield Ac(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=ut(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},jd.RETRIAL_MIN_WAIT,jd.RETRIAL_MAX_WAIT)}function Iy(n,e){let t=ut(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Ui(n){return n.expireTimeMillis-Date.now()>0}function wc(n){return{token:gy(my),error:n}}var Sc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ut(this.app);for(let t of e)Xd(this.app,t.next);return Promise.resolve()}};function Ey(n,e){return new Sc(n,e)}function wy(n){return{getToken:e=>Ac(n,e),getLimitedUseToken:()=>_y(n),addTokenListener:e=>yy(n,"INTERNAL",e),removeTokenListener:e=>Xd(n.app,e)}}var Ty="@firebase/app-check",by="0.10.1";var Ay="app-check",Wd="app-check-internal";function Sy(){ct(new ze(Ay,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Ey(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Wd).initialize()})),ct(new ze(Wd,n=>{let e=n.getProvider("app-check").getImmediate();return wy(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ie(Ty,by)}Sy();var Ry="app-check";var Nr=class{constructor(){return kr(Ry)}};var Py=["localhost","0.0.0.0","127.0.0.1"],Yb=typeof window<"u"&&Py.includes(window.location.hostname);function gf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var _f=gf,yf=new at("auth","Firebase",gf());var go=new It("@firebase/auth");function Cy(n,...e){go.logLevel<=oe.WARN&&go.warn(`Auth (${rn}): ${n}`,...e)}function ho(n,...e){go.logLevel<=oe.ERROR&&go.error(`Auth (${rn}): ${n}`,...e)}function et(n,...e){throw Hc(n,...e)}function lt(n,...e){return Hc(n,...e)}function Kc(n,e,t){let r=Object.assign(Object.assign({},_f()),{[e]:t});return new at("auth","Firebase",r).create(e,{appName:n.name})}function ln(n){return Kc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dy(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&et(n,"argument-error"),Kc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Hc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return yf.create(n,...e)}function te(n,e,...t){if(!n)throw Hc(e,...t)}function Lt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ho(e),new Error(e)}function Ft(n,e){n||Lt(e)}function Cc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ky(){return Zd()==="http:"||Zd()==="https:"}function Zd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Ny(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ky()||vd()||"connection"in navigator)?navigator.onLine:!0}function Oy(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Fn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ft(t>e,"Short delay should be less than long delay!"),this.isMobile=_d()||Id()}get(){return Ny()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Qc(n,e){Ft(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var _o=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var xy={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Vy=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ly=new Fn(3e4,6e4);function Bn(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function hn(s,a,u,l){return v(this,arguments,function*(n,e,t,r,i={}){return vf(n,i,()=>v(null,null,function*(){let d={},m={};r&&(e==="GET"?m=r:d={body:JSON.stringify(r)});let w=Sr(Object.assign({key:n.config.apiKey},m)).slice(1),y=yield n._getAdditionalHeaders();y["Content-Type"]="application/json",n.languageCode&&(y["X-Firebase-Locale"]=n.languageCode);let N=Object.assign({method:e,headers:y},d);return yd()||(N.referrerPolicy="no-referrer"),n.emulatorConfig&&tn(n.emulatorConfig.host)&&(N.credentials="include"),_o.fetch()(yield If(n,n.config.apiHost,t,w),N)}))})}function vf(n,e,t){return v(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},xy),e);try{let i=new Dc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw lo(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[l,d]=u.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw lo(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw lo(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw lo(n,"user-disabled",a);let m=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Kc(n,m,d);et(n,m)}}catch(i){if(i instanceof He)throw i;et(n,"network-request-failed",{message:String(i)})}})}function Do(s,a,u,l){return v(this,arguments,function*(n,e,t,r,i={}){let d=yield hn(n,e,t,r,i);return"mfaPendingCredential"in d&&et(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function If(n,e,t,r){return v(this,null,function*(){let i=`${e}${t}?${r}`,s=n,a=s.config.emulator?Qc(n.config,i):`${n.config.apiScheme}://${i}`;return Vy.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a})}function My(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Dc=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(lt(this.auth,"network-request-failed")),Ly.get())})}};function lo(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=lt(n,e,r);return i.customData._tokenResponse=t,i}function ef(n){return n!==void 0&&n.enterprise!==void 0}var kc=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return My(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function Fy(n,e){return v(this,null,function*(){return hn(n,"GET","/v2/recaptchaConfig",Bn(n,e))})}function Uy(n,e){return v(this,null,function*(){return hn(n,"POST","/v1/accounts:delete",e)})}function yo(n,e){return v(this,null,function*(){return hn(n,"POST","/v1/accounts:lookup",e)})}function qi(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Yc(n,e=!1){return v(this,null,function*(){let t=Be(n),r=yield t.getIdToken(e),i=Jc(r);te(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:qi(Rc(i.auth_time)),issuedAtTime:qi(Rc(i.iat)),expirationTime:qi(Rc(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Rc(n){return Number(n)*1e3}function Jc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ho("JWT malformed, contained fewer than 3 sections"),null;try{let i=to(t);return i?JSON.parse(i):(ho("Failed to decode base64 JWT payload"),null)}catch(i){return ho("Caught error parsing JWT payload as JSON",i?.toString()),null}}function tf(n){let e=Jc(n);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ji(n,e,t=!1){return v(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof He&&By(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function By({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Nc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>v(this,null,function*(){yield this.iteration()}),t)}iteration(){return v(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var zi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qi(this.lastLoginAt),this.creationTime=qi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function vo(n){return v(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield ji(n,yo(t,{idToken:r}));te(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Ef(s.providerUserInfo):[],u=qy(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,m=l?d:!1,w={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new zi(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(n,w)})}function Xc(n){return v(this,null,function*(){let e=Be(n);yield vo(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function qy(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Ef(n){return n.map(e=>{var{providerId:t}=e,r=Qs(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function $y(n,e){return v(this,null,function*(){let t=yield vf(n,{},()=>v(null,null,function*(){let r=Sr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=yield If(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:u,body:r};return n.emulatorConfig&&tn(n.emulatorConfig.host)&&(l.credentials="include"),_o.fetch()(a,l)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function jy(n,e){return v(this,null,function*(){return hn(n,"POST","/v2/accounts:revokeToken",Bn(n,e))})}var $i=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){te(e.length!==0,"internal-error");let t=tf(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return v(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return v(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield $y(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(te(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(te(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(te(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Lt("not implemented")}};function cn(n,e){te(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var un=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Qs(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Nc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new zi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return v(this,null,function*(){let t=yield ji(this,this.stsTokenManager.getToken(this.auth,e));return te(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Yc(this,e)}reload(){return Xc(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return v(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield vo(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return v(this,null,function*(){if(Ge(this.auth.app))return Promise.reject(ln(this.auth));let e=yield this.getIdToken();return yield ji(this,Uy(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,l,d,m;let w=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(i=t.email)!==null&&i!==void 0?i:void 0,N=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,L=(a=t.photoURL)!==null&&a!==void 0?a:void 0,z=(u=t.tenantId)!==null&&u!==void 0?u:void 0,$=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,Q=(d=t.createdAt)!==null&&d!==void 0?d:void 0,X=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:Y,emailVerified:he,isAnonymous:_e,providerData:F,stsTokenManager:b}=t;te(Y&&b,e,"internal-error");let _=$i.fromJSON(this.name,b);te(typeof Y=="string",e,"internal-error"),cn(w,e.name),cn(y,e.name),te(typeof he=="boolean",e,"internal-error"),te(typeof _e=="boolean",e,"internal-error"),cn(N,e.name),cn(L,e.name),cn(z,e.name),cn($,e.name),cn(Q,e.name),cn(X,e.name);let I=new n({uid:Y,auth:e,email:y,emailVerified:he,displayName:w,isAnonymous:_e,photoURL:L,phoneNumber:N,tenantId:z,stsTokenManager:_,createdAt:Q,lastLoginAt:X});return F&&Array.isArray(F)&&(I.providerData=F.map(A=>Object.assign({},A))),$&&(I._redirectEventId=$),I}static _fromIdTokenResponse(e,t,r=!1){return v(this,null,function*(){let i=new $i;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield vo(s),s})}static _fromGetAccountInfoResponse(e,t,r){return v(this,null,function*(){let i=t.users[0];te(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Ef(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new $i;u.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new zi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var nf=new Map;function Mt(n){Ft(n instanceof Function,"Expected a class definition");let e=nf.get(n);return e?(Ft(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,nf.set(n,e),e)}var zy=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return v(this,null,function*(){return!0})}_set(t,r){return v(this,null,function*(){this.storage[t]=r})}_get(t){return v(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return v(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Oc=zy;function fo(n,e,t){return`firebase:${n}:${e}:${t}`}var Io=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=fo(this.userKey,i.apiKey,s),this.fullPersistenceKey=fo("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return v(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield yo(this.auth,{idToken:e}).catch(()=>{});return t?un._fromGetAccountInfoResponse(this.auth,t,e):null}return un._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return v(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return v(this,null,function*(){if(!t.length)return new n(Mt(Oc),e,r);let i=(yield Promise.all(t.map(d=>v(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||Mt(Oc),a=fo(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let m=yield d._get(a);if(m){let w;if(typeof m=="string"){let y=yield yo(e,{idToken:m}).catch(()=>{});if(!y)break;w=yield un._fromGetAccountInfoResponse(e,y,m)}else w=un._fromJSON(e,m);d!==s&&(u=w),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>v(null,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function rf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Af(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rf(e))return"Blackberry";if(Pf(e))return"Webos";if(Tf(e))return"Safari";if((e.includes("chrome/")||bf(e))&&!e.includes("edge/"))return"Chrome";if(Sf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function wf(n=Ne()){return/firefox\//i.test(n)}function Tf(n=Ne()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bf(n=Ne()){return/crios\//i.test(n)}function Af(n=Ne()){return/iemobile/i.test(n)}function Sf(n=Ne()){return/android/i.test(n)}function Rf(n=Ne()){return/blackberry/i.test(n)}function Pf(n=Ne()){return/webos/i.test(n)}function Zc(n=Ne()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Wy(n=Ne()){var e;return Zc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Gy(){return Ed()&&document.documentMode===10}function Cf(n=Ne()){return Zc(n)||Sf(n)||Pf(n)||Rf(n)||/windows phone/i.test(n)||Af(n)}function Df(n,e=[]){let t;switch(n){case"Browser":t=rf(Ne());break;case"Worker":t=`${rf(Ne())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${rn}/${r}`}var xc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let l=e(s);a(l)}catch(l){u(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return v(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Ky(t){return v(this,arguments,function*(n,e={}){return hn(n,"GET","/v2/passwordPolicy",Bn(n,e))})}var Hy=6,Vc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Hy,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(u=l.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Lc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Eo(this),this.idTokenSubscription=new Eo(this),this.beforeStateQueue=new xc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mt(t)),this._initializationPromise=this.queue(()=>v(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield Io.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return v(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return v(this,null,function*(){try{let t=yield yo(this,{idToken:e}),r=yield un._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return v(this,null,function*(){var t;if(Ge(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===u)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return v(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return v(this,null,function*(){try{yield vo(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Oy()}_delete(){return v(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return v(this,null,function*(){if(Ge(this.app))return Promise.reject(ln(this));let t=e?Be(e):null;return t&&te(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return v(this,null,function*(){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>v(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return v(this,null,function*(){return Ge(this.app)?Promise.reject(ln(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ge(this.app)?Promise.reject(ln(this)):this.queue(()=>v(this,null,function*(){yield this.assertedPersistence.setPersistence(Mt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return v(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return v(this,null,function*(){let e=yield Ky(this),t=new Vc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new at("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return v(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield jy(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return v(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return v(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Mt(e)||this._popupRedirectResolver;te(t,this,"argument-error"),this.redirectPersistenceManager=yield Io.create(this,[Mt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return v(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>v(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return v(this,null,function*(){if(e===this.currentUser)return this.queue(()=>v(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return v(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Df(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return v(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return v(this,null,function*(){var e;if(Ge(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Cy(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function qn(n){return Be(n)}var Eo=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ad(t=>this.observer=t)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var ko={loadJS(){return v(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qy(n){ko=n}function kf(n){return ko.loadJS(n)}function Yy(){return ko.recaptchaEnterpriseScript}function Jy(){return ko.gapiScript}function Nf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Mc=class{constructor(){this.enterprise=new Fc}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Fc=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var Xy="recaptcha-enterprise",Of="NO_RECAPTCHA",Uc=class{constructor(e){this.type=Xy,this.auth=qn(e)}verify(e="verify",t=!1){return v(this,null,function*(){function r(s){return v(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,u)=>v(null,null,function*(){Fy(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new kc(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{u(l)})}))})}function i(s,a,u){let l=window.grecaptcha;ef(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(Of)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Mc().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(u=>{if(!t&&ef(window.grecaptcha))i(u,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Yy();l.length!==0&&(l+=u),kf(l).then(()=>{i(u,s,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function Bi(n,e,t,r=!1,i=!1){return v(this,null,function*(){let s=new Uc(n),a;if(i)a=Of;else try{a=yield s.verify(t)}catch{a=yield s.verify(t,!0)}let u=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){let l=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){let l=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u})}function sf(n,e,t,r,i){return v(this,null,function*(){var s,a;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let u=yield Bi(n,e,t,t==="getOobCode");return r(n,u)}else return r(n,e).catch(u=>v(null,null,function*(){if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let l=yield Bi(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(u)}));else if(i==="PHONE_PROVIDER")if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("PHONE_PROVIDER")){let u=yield Bi(n,e,t);return r(n,u).catch(l=>v(null,null,function*(){var d;if(((d=n._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let m=yield Bi(n,e,t,!1,!0);return r(n,m)}return Promise.reject(l)}))}else{let u=yield Bi(n,e,t,!1,!0);return r(n,u)}else return Promise.reject(i+" provider is not supported.")})}function eu(n,e){let t=Cr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(vt(s,e??{}))return i;et(i,"already-initialized")}return t.initialize({options:e})}function Zy(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Mt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function tu(n,e,t){let r=qn(n);te(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=xf(e),{host:a,port:u}=ev(e),l=u===null?"":`:${u}`,d={url:`${s}//${a}${l}/`},m=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){te(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),te(vt(d,r.config.emulator)&&vt(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,tn(a)?(ro(`${s}//${a}${l}`),io("Auth",!0)):i||tv()}function xf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ev(n){let e=xf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:of(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:of(a)}}}function of(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function tv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var xr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Lt("not implemented")}_getIdTokenResponse(e){return Lt("not implemented")}_linkToIdToken(e,t){return Lt("not implemented")}_getReauthenticationResolver(e){return Lt("not implemented")}};function nv(n,e){return v(this,null,function*(){return hn(n,"POST","/v1/accounts:signUp",e)})}function rv(n,e){return v(this,null,function*(){return Do(n,"POST","/v1/accounts:signInWithPassword",Bn(n,e))})}function iv(n,e){return v(this,null,function*(){return Do(n,"POST","/v1/accounts:signInWithEmailLink",Bn(n,e))})}function sv(n,e){return v(this,null,function*(){return Do(n,"POST","/v1/accounts:signInWithEmailLink",Bn(n,e))})}var Wi=class n extends xr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return v(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sf(e,t,"signInWithPassword",rv,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return iv(e,{email:this._email,oobCode:this._password});default:et(e,"internal-error")}})}_linkToIdToken(e,t){return v(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sf(e,r,"signUpPassword",nv,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return sv(e,{idToken:t,email:this._email,oobCode:this._password});default:et(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Or(n,e){return v(this,null,function*(){return Do(n,"POST","/v1/accounts:signInWithIdp",Bn(n,e))})}var ov="http://localhost",wo=class n extends xr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):et("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Qs(t,["providerId","signInMethod"]);if(!r||!i)return null;let a=new n(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return Or(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Or(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Or(e,t)}buildRequest(){let e={requestUri:ov,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Sr(t)}return e}};function av(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cv(n){let e=Rr(Pr(n)).link,t=e?Rr(Pr(e)).deep_link_id:null,r=Rr(Pr(n)).deep_link_id;return(r?Rr(Pr(r)).link:null)||r||t||e||n}var To=class n{constructor(e){var t,r,i,s,a,u;let l=Rr(Pr(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,m=(r=l.oobCode)!==null&&r!==void 0?r:null,w=av((i=l.mode)!==null&&i!==void 0?i:null);te(d&&m&&w,"argument-error"),this.apiKey=d,this.operation=w,this.code=m,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(u=l.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=cv(e);try{return new n(t)}catch{return null}}};var Vf=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Wi._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=To.parseLink(r);return te(i,"argument-error"),Wi._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),Gi=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var bo=class extends Gi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var uv=(()=>{class n extends bo{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return wo._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Ki=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return v(this,null,function*(){let s=yield un._fromIdTokenResponse(e,r,i),a=af(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return v(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=af(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function af(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Bc=class n extends He{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Lf(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Bc._fromErrorAndOperation(n,s,e,r):s})}function lv(n,e,t=!1){return v(this,null,function*(){let r=yield ji(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Ki._forOperation(n,"link",r)})}function hv(n,e,t=!1){return v(this,null,function*(){let{auth:r}=n;if(Ge(r.app))return Promise.reject(ln(r));let i="reauthenticate";try{let s=yield ji(n,Lf(r,i,e,n),t);te(s.idToken,r,"internal-error");let a=Jc(s.idToken);te(a,r,"internal-error");let{sub:u}=a;return te(n.uid===u,r,"user-mismatch"),Ki._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&et(r,"user-mismatch"),s}})}function Mf(n,e,t=!1){return v(this,null,function*(){if(Ge(n.app))return Promise.reject(ln(n));let r="signIn",i=yield Lf(n,r,e),s=yield Ki._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function nu(n,e){return v(this,null,function*(){return Mf(qn(n),e)})}function dv(n){return v(this,null,function*(){let e=qn(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function ru(n,e,t){return Ge(n.app)?Promise.reject(ln(n)):nu(Be(n),Vf.credential(e,t)).catch(r=>v(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&dv(n),r}))}function iu(n,e,t,r){return Be(n).onIdTokenChanged(e,t,r)}function su(n,e,t){return Be(n).beforeAuthStateChanged(e,t)}var Ao="__sak";var So=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ao,"1"),this.storage.removeItem(Ao),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var fv=1e3,pv=10,mv=(()=>{class n extends So{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,l,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Gy()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,pv):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},fv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return v(this,null,function*(){yield Xt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return v(this,null,function*(){let r=yield Xt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return v(this,null,function*(){yield Xt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Ff=mv;var gv=(()=>{class n extends So{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ou=gv;function _v(n){return Promise.all(n.map(e=>v(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var yv=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return v(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(u).map(m=>v(this,null,function*(){return m(r.origin,a)})),d=yield _v(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function au(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var qc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return v(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,l)=>{let d=au("",20);i.port1.start();let m=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(w){let y=w;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(y.data.response);break;default:clearTimeout(m),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function wt(){return window}function vv(n){wt().location.href=n}function Uf(){return typeof wt().WorkerGlobalScope<"u"&&typeof wt().importScripts=="function"}function Iv(){return v(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Ev(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function wv(){return Uf()?self:null}var Bf="firebaseLocalStorageDb",Tv=1,Ro="firebaseLocalStorage",qf="fbase_key",Un=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function No(n,e){return n.transaction([Ro],e?"readwrite":"readonly").objectStore(Ro)}function bv(){let n=indexedDB.deleteDatabase(Bf);return new Un(n).toPromise()}function $c(){let n=indexedDB.open(Bf,Tv);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Ro,{keyPath:qf})}catch(i){t(i)}}),n.addEventListener("success",()=>v(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Ro)?e(r):(r.close(),yield bv(),e(yield $c()))}))})}function cf(n,e,t){return v(this,null,function*(){let r=No(n,!0).put({[qf]:e,value:t});return new Un(r).toPromise()})}function Av(n,e){return v(this,null,function*(){let t=No(n,!1).get(e),r=yield new Un(t).toPromise();return r===void 0?null:r.value})}function uf(n,e){let t=No(n,!0).delete(e);return new Un(t).toPromise()}var Sv=800,Rv=3,Pv=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return v(this,null,function*(){return this.db?this.db:(this.db=yield $c(),this.db)})}_withRetries(t){return v(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Rv)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return v(this,null,function*(){return Uf()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return v(this,null,function*(){this.receiver=yv._getInstance(wv()),this.receiver._subscribe("keyChanged",(t,r)=>v(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>v(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return v(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Iv(),!this.activeServiceWorker)return;this.sender=new qc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return v(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Ev()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return v(this,null,function*(){try{if(!indexedDB)return!1;let t=yield $c();return yield cf(t,Ao,"1"),yield uf(t,Ao),!0}catch{}return!1})}_withPendingWrite(t){return v(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(i=>cf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return v(this,null,function*(){let r=yield this._withRetries(i=>Av(i,t));return this.localCache[t]=r,r})}_remove(t){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(r=>uf(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return v(this,null,function*(){let t=yield this._withRetries(s=>{let a=No(s,!1).getAll();return new Un(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>v(this,null,function*(){return this._poll()}),Sv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),$f=Pv;var iA=Nf("rcb"),sA=new Fn(3e4,6e4);function jf(n,e){return e?Mt(e):(te(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Hi=class extends xr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Or(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Or(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Or(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Cv(n){return Mf(n.auth,new Hi(n),n.bypassAuthState)}function Dv(n){let{auth:e,user:t}=n;return te(t,e,"internal-error"),hv(t,new Hi(n),n.bypassAuthState)}function kv(n){return v(this,null,function*(){let{auth:e,user:t}=n;return te(t,e,"internal-error"),lv(t,new Hi(n),n.bypassAuthState)})}var Po=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>v(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return v(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cv;case"linkViaPopup":case"linkViaRedirect":return kv;case"reauthViaPopup":case"reauthViaRedirect":return Dv;default:et(this.auth,"internal-error")}}resolve(e){Ft(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ft(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Nv=new Fn(2e3,1e4);function cu(n,e,t){return v(this,null,function*(){if(Ge(n.app))return Promise.reject(lt(n,"operation-not-supported-in-this-environment"));let r=qn(n);Dy(n,e,Gi);let i=jf(r,t);return new Ov(r,"signInViaPopup",e,i).executeNotNull()})}var Ov=(()=>{class n extends Po{constructor(t,r,i,s,a){super(t,r,s,a),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return v(this,null,function*(){let t=yield this.execute();return te(t,this.auth,"internal-error"),t})}onExecution(){return v(this,null,function*(){Ft(this.filter.length===1,"Popup operations only handle one event");let t=au();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(lt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(lt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,Nv.get())};t()}}n.currentPopupAction=null;return n})(),xv="pendingRedirect",po=new Map,jc=class n extends Po{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return v(this,null,function*(){let e=po.get(this.auth._key());if(!e){try{let r=(yield Vv(this.resolver,this.auth))?yield Xt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}po.set(this.auth._key(),e)}return this.bypassAuthState||po.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return v(this,null,function*(){if(e.type==="signInViaRedirect")return Xt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Xt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return v(this,null,function*(){})}cleanUp(){}};function Vv(n,e){return v(this,null,function*(){let t=Fv(e),r=Mv(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Lv(n,e){po.set(n._key(),e)}function Mv(n){return Mt(n._redirectPersistence)}function Fv(n){return fo(xv,n.config.apiKey,n.name)}function Uv(n,e,t=!1){return v(this,null,function*(){if(Ge(n.app))return Promise.reject(ln(n));let r=qn(n),i=jf(r,e),a=yield new jc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var Bv=10*60*1e3,zc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qv(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!zf(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(lt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Bv&&this.cachedEventUids.clear(),this.cachedEventUids.has(lf(e))}saveEventToCache(e){this.cachedEventUids.add(lf(e)),this.lastProcessedEventTime=Date.now()}};function lf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function qv(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zf(n);default:return!1}}function $v(t){return v(this,arguments,function*(n,e={}){return hn(n,"GET","/v1/projects",e)})}var jv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zv=/^https?/;function Wv(n){return v(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield $v(n);for(let t of e)try{if(Gv(t))return}catch{}et(n,"unauthorized-domain")})}function Gv(n){let e=Cc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!zv.test(t))return!1;if(jv.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Kv=new Fn(3e4,6e4);function hf(){let n=wt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Hv(n){return new Promise((e,t)=>{var r,i,s;function a(){hf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hf(),t(lt(n,"network-request-failed"))},timeout:Kv.get()})}if(!((i=(r=wt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=wt().gapi)===null||s===void 0)&&s.load)a();else{let u=Nf("iframefcb");return wt()[u]=()=>{gapi.load?a():t(lt(n,"network-request-failed"))},kf(`${Jy()}?onload=${u}`).catch(l=>t(l))}}).catch(e=>{throw mo=null,e})}var mo=null;function Qv(n){return mo=mo||Hv(n),mo}var Yv=new Fn(5e3,15e3),Jv="__/auth/iframe",Xv="emulator/auth/iframe",Zv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tI(n){let e=n.config;te(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Qc(e,Xv):`https://${n.config.authDomain}/${Jv}`,r={apiKey:e.apiKey,appName:n.name,v:rn},i=eI.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Sr(r).slice(1)}`}function nI(n){return v(this,null,function*(){let e=yield Qv(n),t=wt().gapi;return te(t,n,"internal-error"),e.open({where:document.body,url:tI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Zv,dontclear:!0},r=>new Promise((i,s)=>v(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=lt(n,"network-request-failed"),u=wt().setTimeout(()=>{s(a)},Yv.get());function l(){wt().clearTimeout(u),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var rI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iI=500,sI=600,oI="_blank",aI="http://localhost",Co=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function cI(n,e,t,r=iI,i=sI){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",l=Object.assign(Object.assign({},rI),{width:r.toString(),height:i.toString(),top:s,left:a}),d=Ne().toLowerCase();t&&(u=bf(d)?oI:t),wf(d)&&(e=e||aI,l.scrollbars="yes");let m=Object.entries(l).reduce((y,[N,L])=>`${y}${N}=${L},`,"");if(Wy(d)&&u!=="_self")return uI(e||"",u),new Co(null);let w=window.open(e||"",u,m);te(w,n,"popup-blocked");try{w.focus()}catch{}return new Co(w)}function uI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var lI="__/auth/handler",hI="emulator/auth/handler",dI=encodeURIComponent("fac");function df(n,e,t,r,i,s){return v(this,null,function*(){te(n.config.authDomain,n,"auth-domain-config-required"),te(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:rn,eventId:i};if(e instanceof Gi){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",bd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[m,w]of Object.entries(s||{}))a[m]=w}if(e instanceof bo){let m=e.getScopes().filter(w=>w!=="");m.length>0&&(a.scopes=m.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let m of Object.keys(u))u[m]===void 0&&delete u[m];let l=yield n._getAppCheckToken(),d=l?`#${dI}=${encodeURIComponent(l)}`:"";return`${fI(n)}?${Sr(u).slice(1)}${d}`})}function fI({config:n}){return n.emulator?Qc(n,hI):`https://${n.authDomain}/${lI}`}var Pc="webStorageSupport",Wc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ou,this._completeRedirectFn=Uv,this._overrideRedirectResult=Lv}_openPopup(e,t,r,i){return v(this,null,function*(){var s;Ft((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield df(e,t,r,Cc(),i);return cI(e,a,au())})}_openRedirect(e,t,r,i){return v(this,null,function*(){yield this._originValidation(e);let s=yield df(e,t,r,Cc(),i);return vv(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ft(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return v(this,null,function*(){let t=yield nI(e),r=new zc(e);return t.register("authEvent",i=>(te(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pc,{type:Pc},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Pc];a!==void 0&&t(!!a),et(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Wv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Cf()||Tf()||Zc()}},Wf=Wc;var ff="@firebase/auth",pf="1.10.8";var Gc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return v(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function pI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mI(n){ct(new ze("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;te(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Df(n)},d=new Lc(r,i,s,l);return Zy(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ct(new ze("auth-internal",e=>{let t=qn(e.getProvider("auth").getImmediate());return(r=>new Gc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ie(ff,pf,pI(n)),Ie(ff,pf,"esm2017")}var gI=5*60,_I=ic("authIdTokenMaxAge")||gI,mf=null,yI=n=>e=>v(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>_I)return;let i=t?.token;mf!==i&&(mf=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function uu(n=Vn()){let e=Cr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=eu(n,{popupRedirectResolver:Wf,persistence:[$f,Ff,ou]}),r=ic("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=yI(s.toString());su(t,a,()=>a(t.currentUser)),iu(t,u=>a(u))}}let i=nc("auth");return i&&tu(t,`http://${i}`),t}function vI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Qy({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=lt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",vI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mI("Browser");var Gf="auth",Qi=class{constructor(e){return e}},Yi=class{constructor(){return kr(Gf)}};var lu=new Zt("angularfire2.auth-instances");function uE(n,e){let t=Mi(Gf,n,e);return t&&new Qi(t)}function lE(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Qi(r)}}var hE={provide:Yi,deps:[[new Ze,lu]]},dE={provide:Qi,useFactory:uE,deps:[[new Ze,lu],Vt]};function jA(n,...e){return Ie("angularfire",sn.full,"auth"),br([dE,hE,{provide:lu,useFactory:lE(n),multi:!0,deps:[yt,en,on,Mn,[new Ze,Nr],...e]}])}var zA=qe(uu,!0);var WA=qe(ru,!0,2);var GA=qe(cu,!0,2);var Kf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Hf={};var Ut,hu;(function(){var n;function e(b,_){function I(){}I.prototype=_.prototype,b.D=_.prototype,b.prototype=new I,b.prototype.constructor=b,b.C=function(A,R,D){for(var E=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)E[Se-2]=arguments[Se];return _.prototype[R].apply(A,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(b,_,I){I||(I=0);var A=Array(16);if(typeof _=="string")for(var R=0;16>R;++R)A[R]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(R=0;16>R;++R)A[R]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=b.g[0],I=b.g[1],R=b.g[2];var D=b.g[3],E=_+(D^I&(R^D))+A[0]+3614090360&4294967295;_=I+(E<<7&4294967295|E>>>25),E=D+(R^_&(I^R))+A[1]+3905402710&4294967295,D=_+(E<<12&4294967295|E>>>20),E=R+(I^D&(_^I))+A[2]+606105819&4294967295,R=D+(E<<17&4294967295|E>>>15),E=I+(_^R&(D^_))+A[3]+3250441966&4294967295,I=R+(E<<22&4294967295|E>>>10),E=_+(D^I&(R^D))+A[4]+4118548399&4294967295,_=I+(E<<7&4294967295|E>>>25),E=D+(R^_&(I^R))+A[5]+1200080426&4294967295,D=_+(E<<12&4294967295|E>>>20),E=R+(I^D&(_^I))+A[6]+2821735955&4294967295,R=D+(E<<17&4294967295|E>>>15),E=I+(_^R&(D^_))+A[7]+4249261313&4294967295,I=R+(E<<22&4294967295|E>>>10),E=_+(D^I&(R^D))+A[8]+1770035416&4294967295,_=I+(E<<7&4294967295|E>>>25),E=D+(R^_&(I^R))+A[9]+2336552879&4294967295,D=_+(E<<12&4294967295|E>>>20),E=R+(I^D&(_^I))+A[10]+4294925233&4294967295,R=D+(E<<17&4294967295|E>>>15),E=I+(_^R&(D^_))+A[11]+2304563134&4294967295,I=R+(E<<22&4294967295|E>>>10),E=_+(D^I&(R^D))+A[12]+1804603682&4294967295,_=I+(E<<7&4294967295|E>>>25),E=D+(R^_&(I^R))+A[13]+4254626195&4294967295,D=_+(E<<12&4294967295|E>>>20),E=R+(I^D&(_^I))+A[14]+2792965006&4294967295,R=D+(E<<17&4294967295|E>>>15),E=I+(_^R&(D^_))+A[15]+1236535329&4294967295,I=R+(E<<22&4294967295|E>>>10),E=_+(R^D&(I^R))+A[1]+4129170786&4294967295,_=I+(E<<5&4294967295|E>>>27),E=D+(I^R&(_^I))+A[6]+3225465664&4294967295,D=_+(E<<9&4294967295|E>>>23),E=R+(_^I&(D^_))+A[11]+643717713&4294967295,R=D+(E<<14&4294967295|E>>>18),E=I+(D^_&(R^D))+A[0]+3921069994&4294967295,I=R+(E<<20&4294967295|E>>>12),E=_+(R^D&(I^R))+A[5]+3593408605&4294967295,_=I+(E<<5&4294967295|E>>>27),E=D+(I^R&(_^I))+A[10]+38016083&4294967295,D=_+(E<<9&4294967295|E>>>23),E=R+(_^I&(D^_))+A[15]+3634488961&4294967295,R=D+(E<<14&4294967295|E>>>18),E=I+(D^_&(R^D))+A[4]+3889429448&4294967295,I=R+(E<<20&4294967295|E>>>12),E=_+(R^D&(I^R))+A[9]+568446438&4294967295,_=I+(E<<5&4294967295|E>>>27),E=D+(I^R&(_^I))+A[14]+3275163606&4294967295,D=_+(E<<9&4294967295|E>>>23),E=R+(_^I&(D^_))+A[3]+4107603335&4294967295,R=D+(E<<14&4294967295|E>>>18),E=I+(D^_&(R^D))+A[8]+1163531501&4294967295,I=R+(E<<20&4294967295|E>>>12),E=_+(R^D&(I^R))+A[13]+2850285829&4294967295,_=I+(E<<5&4294967295|E>>>27),E=D+(I^R&(_^I))+A[2]+4243563512&4294967295,D=_+(E<<9&4294967295|E>>>23),E=R+(_^I&(D^_))+A[7]+1735328473&4294967295,R=D+(E<<14&4294967295|E>>>18),E=I+(D^_&(R^D))+A[12]+2368359562&4294967295,I=R+(E<<20&4294967295|E>>>12),E=_+(I^R^D)+A[5]+4294588738&4294967295,_=I+(E<<4&4294967295|E>>>28),E=D+(_^I^R)+A[8]+2272392833&4294967295,D=_+(E<<11&4294967295|E>>>21),E=R+(D^_^I)+A[11]+1839030562&4294967295,R=D+(E<<16&4294967295|E>>>16),E=I+(R^D^_)+A[14]+4259657740&4294967295,I=R+(E<<23&4294967295|E>>>9),E=_+(I^R^D)+A[1]+2763975236&4294967295,_=I+(E<<4&4294967295|E>>>28),E=D+(_^I^R)+A[4]+1272893353&4294967295,D=_+(E<<11&4294967295|E>>>21),E=R+(D^_^I)+A[7]+4139469664&4294967295,R=D+(E<<16&4294967295|E>>>16),E=I+(R^D^_)+A[10]+3200236656&4294967295,I=R+(E<<23&4294967295|E>>>9),E=_+(I^R^D)+A[13]+681279174&4294967295,_=I+(E<<4&4294967295|E>>>28),E=D+(_^I^R)+A[0]+3936430074&4294967295,D=_+(E<<11&4294967295|E>>>21),E=R+(D^_^I)+A[3]+3572445317&4294967295,R=D+(E<<16&4294967295|E>>>16),E=I+(R^D^_)+A[6]+76029189&4294967295,I=R+(E<<23&4294967295|E>>>9),E=_+(I^R^D)+A[9]+3654602809&4294967295,_=I+(E<<4&4294967295|E>>>28),E=D+(_^I^R)+A[12]+3873151461&4294967295,D=_+(E<<11&4294967295|E>>>21),E=R+(D^_^I)+A[15]+530742520&4294967295,R=D+(E<<16&4294967295|E>>>16),E=I+(R^D^_)+A[2]+3299628645&4294967295,I=R+(E<<23&4294967295|E>>>9),E=_+(R^(I|~D))+A[0]+4096336452&4294967295,_=I+(E<<6&4294967295|E>>>26),E=D+(I^(_|~R))+A[7]+1126891415&4294967295,D=_+(E<<10&4294967295|E>>>22),E=R+(_^(D|~I))+A[14]+2878612391&4294967295,R=D+(E<<15&4294967295|E>>>17),E=I+(D^(R|~_))+A[5]+4237533241&4294967295,I=R+(E<<21&4294967295|E>>>11),E=_+(R^(I|~D))+A[12]+1700485571&4294967295,_=I+(E<<6&4294967295|E>>>26),E=D+(I^(_|~R))+A[3]+2399980690&4294967295,D=_+(E<<10&4294967295|E>>>22),E=R+(_^(D|~I))+A[10]+4293915773&4294967295,R=D+(E<<15&4294967295|E>>>17),E=I+(D^(R|~_))+A[1]+2240044497&4294967295,I=R+(E<<21&4294967295|E>>>11),E=_+(R^(I|~D))+A[8]+1873313359&4294967295,_=I+(E<<6&4294967295|E>>>26),E=D+(I^(_|~R))+A[15]+4264355552&4294967295,D=_+(E<<10&4294967295|E>>>22),E=R+(_^(D|~I))+A[6]+2734768916&4294967295,R=D+(E<<15&4294967295|E>>>17),E=I+(D^(R|~_))+A[13]+1309151649&4294967295,I=R+(E<<21&4294967295|E>>>11),E=_+(R^(I|~D))+A[4]+4149444226&4294967295,_=I+(E<<6&4294967295|E>>>26),E=D+(I^(_|~R))+A[11]+3174756917&4294967295,D=_+(E<<10&4294967295|E>>>22),E=R+(_^(D|~I))+A[2]+718787259&4294967295,R=D+(E<<15&4294967295|E>>>17),E=I+(D^(R|~_))+A[9]+3951481745&4294967295,b.g[0]=b.g[0]+_&4294967295,b.g[1]=b.g[1]+(R+(E<<21&4294967295|E>>>11))&4294967295,b.g[2]=b.g[2]+R&4294967295,b.g[3]=b.g[3]+D&4294967295}r.prototype.u=function(b,_){_===void 0&&(_=b.length);for(var I=_-this.blockSize,A=this.B,R=this.h,D=0;D<_;){if(R==0)for(;D<=I;)i(this,b,D),D+=this.blockSize;if(typeof b=="string"){for(;D<_;)if(A[R++]=b.charCodeAt(D++),R==this.blockSize){i(this,A),R=0;break}}else for(;D<_;)if(A[R++]=b[D++],R==this.blockSize){i(this,A),R=0;break}}this.h=R,this.o+=_},r.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var _=1;_<b.length-8;++_)b[_]=0;var I=8*this.o;for(_=b.length-8;_<b.length;++_)b[_]=I&255,I/=256;for(this.u(b),b=Array(16),_=I=0;4>_;++_)for(var A=0;32>A;A+=8)b[I++]=this.g[_]>>>A&255;return b};function s(b,_){var I=u;return Object.prototype.hasOwnProperty.call(I,b)?I[b]:I[b]=_(b)}function a(b,_){this.h=_;for(var I=[],A=!0,R=b.length-1;0<=R;R--){var D=b[R]|0;A&&D==_||(I[R]=D,A=!1)}this.g=I}var u={};function l(b){return-128<=b&&128>b?s(b,function(_){return new a([_|0],0>_?-1:0)}):new a([b|0],0>b?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return w;if(0>b)return $(d(-b));for(var _=[],I=1,A=0;b>=I;A++)_[A]=b/I|0,I*=4294967296;return new a(_,0)}function m(b,_){if(b.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(b.charAt(0)=="-")return $(m(b.substring(1),_));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(_,8)),A=w,R=0;R<b.length;R+=8){var D=Math.min(8,b.length-R),E=parseInt(b.substring(R,R+D),_);8>D?(D=d(Math.pow(_,D)),A=A.j(D).add(d(E))):(A=A.j(I),A=A.add(d(E)))}return A}var w=l(0),y=l(1),N=l(16777216);n=a.prototype,n.m=function(){if(z(this))return-$(this).m();for(var b=0,_=1,I=0;I<this.g.length;I++){var A=this.i(I);b+=(0<=A?A:4294967296+A)*_,_*=4294967296}return b},n.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(L(this))return"0";if(z(this))return"-"+$(this).toString(b);for(var _=d(Math.pow(b,6)),I=this,A="";;){var R=he(I,_).g;I=Q(I,R.j(_));var D=((0<I.g.length?I.g[0]:I.h)>>>0).toString(b);if(I=R,L(I))return D+A;for(;6>D.length;)D="0"+D;A=D+A}},n.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function L(b){if(b.h!=0)return!1;for(var _=0;_<b.g.length;_++)if(b.g[_]!=0)return!1;return!0}function z(b){return b.h==-1}n.l=function(b){return b=Q(this,b),z(b)?-1:L(b)?0:1};function $(b){for(var _=b.g.length,I=[],A=0;A<_;A++)I[A]=~b.g[A];return new a(I,~b.h).add(y)}n.abs=function(){return z(this)?$(this):this},n.add=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],A=0,R=0;R<=_;R++){var D=A+(this.i(R)&65535)+(b.i(R)&65535),E=(D>>>16)+(this.i(R)>>>16)+(b.i(R)>>>16);A=E>>>16,D&=65535,E&=65535,I[R]=E<<16|D}return new a(I,I[I.length-1]&-2147483648?-1:0)};function Q(b,_){return b.add($(_))}n.j=function(b){if(L(this)||L(b))return w;if(z(this))return z(b)?$(this).j($(b)):$($(this).j(b));if(z(b))return $(this.j($(b)));if(0>this.l(N)&&0>b.l(N))return d(this.m()*b.m());for(var _=this.g.length+b.g.length,I=[],A=0;A<2*_;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(var R=0;R<b.g.length;R++){var D=this.i(A)>>>16,E=this.i(A)&65535,Se=b.i(R)>>>16,rt=b.i(R)&65535;I[2*A+2*R]+=E*rt,X(I,2*A+2*R),I[2*A+2*R+1]+=D*rt,X(I,2*A+2*R+1),I[2*A+2*R+1]+=E*Se,X(I,2*A+2*R+1),I[2*A+2*R+2]+=D*Se,X(I,2*A+2*R+2)}for(A=0;A<_;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=_;A<2*_;A++)I[A]=0;return new a(I,0)};function X(b,_){for(;(b[_]&65535)!=b[_];)b[_+1]+=b[_]>>>16,b[_]&=65535,_++}function Y(b,_){this.g=b,this.h=_}function he(b,_){if(L(_))throw Error("division by zero");if(L(b))return new Y(w,w);if(z(b))return _=he($(b),_),new Y($(_.g),$(_.h));if(z(_))return _=he(b,$(_)),new Y($(_.g),_.h);if(30<b.g.length){if(z(b)||z(_))throw Error("slowDivide_ only works with positive integers.");for(var I=y,A=_;0>=A.l(b);)I=_e(I),A=_e(A);var R=F(I,1),D=F(A,1);for(A=F(A,2),I=F(I,2);!L(A);){var E=D.add(A);0>=E.l(b)&&(R=R.add(I),D=E),A=F(A,1),I=F(I,1)}return _=Q(b,R.j(_)),new Y(R,_)}for(R=w;0<=b.l(_);){for(I=Math.max(1,Math.floor(b.m()/_.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),D=d(I),E=D.j(_);z(E)||0<E.l(b);)I-=A,D=d(I),E=D.j(_);L(D)&&(D=y),R=R.add(D),b=Q(b,E)}return new Y(R,b)}n.A=function(b){return he(this,b).h},n.and=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],A=0;A<_;A++)I[A]=this.i(A)&b.i(A);return new a(I,this.h&b.h)},n.or=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],A=0;A<_;A++)I[A]=this.i(A)|b.i(A);return new a(I,this.h|b.h)},n.xor=function(b){for(var _=Math.max(this.g.length,b.g.length),I=[],A=0;A<_;A++)I[A]=this.i(A)^b.i(A);return new a(I,this.h^b.h)};function _e(b){for(var _=b.g.length+1,I=[],A=0;A<_;A++)I[A]=b.i(A)<<1|b.i(A-1)>>>31;return new a(I,b.h)}function F(b,_){var I=_>>5;_%=32;for(var A=b.g.length-I,R=[],D=0;D<A;D++)R[D]=0<_?b.i(D+I)>>>_|b.i(D+I+1)<<32-_:b.i(D+I);return new a(R,b.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,hu=Hf.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,Ut=Hf.Integer=a}).apply(typeof Kf<"u"?Kf:typeof self<"u"?self:typeof window<"u"?window:{});var Oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bt={};var du,fE,Vr,fu,Ji,xo,pu,mu,gu;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,h){return o==Array.prototype||o==Object.prototype||(o[c]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Oo=="object"&&Oo];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,c){if(c)e:{var h=r;o=o.split(".");for(var p=0;p<o.length-1;p++){var k=o[p];if(!(k in h))break e;h=h[k]}o=o[o.length-1],p=h[o],c=c(p),c!=p&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var h=0,p=!1,k={next:function(){if(!p&&h<o.length){var O=h++;return{value:c(O,o[O]),done:!1}}return p=!0,{done:!0,value:void 0}}};return k[Symbol.iterator]=function(){return k},k}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,h){return h})}});var a=a||{},u=this||self;function l(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function m(o,c,h){return o.call.apply(o.bind,arguments)}function w(o,c,h){if(!o)throw Error();if(2<arguments.length){var p=Array.prototype.slice.call(arguments,2);return function(){var k=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(k,p),o.apply(c,k)}}return function(){return o.apply(c,arguments)}}function y(o,c,h){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:w,y.apply(null,arguments)}function N(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var p=h.slice();return p.push.apply(p,arguments),o.apply(this,p)}}function L(o,c){function h(){}h.prototype=c.prototype,o.aa=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(p,k,O){for(var W=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)W[pe-2]=arguments[pe];return c.prototype[k].apply(p,W)}}function z(o){let c=o.length;if(0<c){let h=Array(c);for(let p=0;p<c;p++)h[p]=o[p];return h}return[]}function $(o,c){for(let h=1;h<arguments.length;h++){let p=arguments[h];if(l(p)){let k=o.length||0,O=p.length||0;o.length=k+O;for(let W=0;W<O;W++)o[k+W]=p[W]}else o.push(p)}}class Q{constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function X(o){return/^[\s\xa0]*$/.test(o)}function Y(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function he(o){return he[" "](o),o}he[" "]=function(){};var _e=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function F(o,c,h){for(let p in o)c.call(h,o[p],p,o)}function b(o,c){for(let h in o)c.call(void 0,o[h],h,o)}function _(o){let c={};for(let h in o)c[h]=o[h];return c}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(o,c){let h,p;for(let k=1;k<arguments.length;k++){p=arguments[k];for(h in p)o[h]=p[h];for(let O=0;O<I.length;O++)h=I[O],Object.prototype.hasOwnProperty.call(p,h)&&(o[h]=p[h])}}function R(o){var c=1;o=o.split(":");let h=[];for(;0<c&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function D(o){u.setTimeout(()=>{throw o},0)}function E(){var o=rr;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class Se{constructor(){this.h=this.g=null}add(c,h){let p=rt.get();p.set(c,h),this.h?this.h.next=p:this.g=p,this.h=p}}var rt=new Q(()=>new nr,o=>o.reset());class nr{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Dt,Ye=!1,rr=new Se,Ts=()=>{let o=u.Promise.resolve(void 0);Dt=()=>{o.then(Ca)}};var Ca=()=>{for(var o;o=E();){try{o.h.call(o.g)}catch(h){D(h)}var c=rt;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}Ye=!1};function De(){this.s=this.s,this.C=this.C}De.prototype.s=!1,De.prototype.ma=function(){this.s||(this.s=!0,this.N())},De.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Re(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}Re.prototype.h=function(){this.defaultPrevented=!0};var Da=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};u.addEventListener("test",h,c),u.removeEventListener("test",h,c)}catch{}return o}();function In(o,c){if(Re.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(_e){e:{try{he(c.nodeName);var k=!0;break e}catch{}k=!1}k||(c=null)}}else h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement);this.relatedTarget=c,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:ka[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&In.aa.h.call(this)}}L(In,Re);var ka={2:"touch",3:"pen",4:"mouse"};In.prototype.h=function(){In.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var En="closure_listenable_"+(1e6*Math.random()|0),Na=0;function Oa(o,c,h,p,k){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!p,this.ha=k,this.key=++Na,this.da=this.fa=!1}function ir(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function sr(o){this.src=o,this.g={},this.h=0}sr.prototype.add=function(o,c,h,p,k){var O=o.toString();o=this.g[O],o||(o=this.g[O]=[],this.h++);var W=ai(o,c,p,k);return-1<W?(c=o[W],h||(c.fa=!1)):(c=new Oa(c,this.src,O,!!p,k),c.fa=h,o.push(c)),c};function oi(o,c){var h=c.type;if(h in o.g){var p=o.g[h],k=Array.prototype.indexOf.call(p,c,void 0),O;(O=0<=k)&&Array.prototype.splice.call(p,k,1),O&&(ir(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function ai(o,c,h,p){for(var k=0;k<o.length;++k){var O=o[k];if(!O.da&&O.listener==c&&O.capture==!!h&&O.ha==p)return k}return-1}var ci="closure_lm_"+(1e6*Math.random()|0),ui={};function it(o,c,h,p,k){if(p&&p.once)return wn(o,c,h,p,k);if(Array.isArray(c)){for(var O=0;O<c.length;O++)it(o,c[O],h,p,k);return null}return h=lr(h),o&&o[En]?o.K(c,h,d(p)?!!p.capture:!!p,k):bs(o,c,h,!1,p,k)}function bs(o,c,h,p,k,O){if(!c)throw Error("Invalid event type");var W=d(k)?!!k.capture:!!k,pe=cr(o);if(pe||(o[ci]=pe=new sr(o)),h=pe.add(c,h,p,W,O),h.proxy)return h;if(p=As(),h.proxy=p,p.src=o,p.listener=h,o.addEventListener)Da||(k=W),k===void 0&&(k=!1),o.addEventListener(c.toString(),p,k);else if(o.attachEvent)o.attachEvent(ar(c.toString()),p);else if(o.addListener&&o.removeListener)o.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return h}function As(){function o(h){return c.call(o.src,o.listener,h)}let c=Ss;return o}function wn(o,c,h,p,k){if(Array.isArray(c)){for(var O=0;O<c.length;O++)wn(o,c[O],h,p,k);return null}return h=lr(h),o&&o[En]?o.L(c,h,d(p)?!!p.capture:!!p,k):bs(o,c,h,!0,p,k)}function or(o,c,h,p,k){if(Array.isArray(c))for(var O=0;O<c.length;O++)or(o,c[O],h,p,k);else p=d(p)?!!p.capture:!!p,h=lr(h),o&&o[En]?(o=o.i,c=String(c).toString(),c in o.g&&(O=o.g[c],h=ai(O,h,p,k),-1<h&&(ir(O[h]),Array.prototype.splice.call(O,h,1),O.length==0&&(delete o.g[c],o.h--)))):o&&(o=cr(o))&&(c=o.g[c.toString()],o=-1,c&&(o=ai(c,h,p,k)),(h=-1<o?c[o]:null)&&Tn(h))}function Tn(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[En])oi(c.i,o);else{var h=o.type,p=o.proxy;c.removeEventListener?c.removeEventListener(h,p,o.capture):c.detachEvent?c.detachEvent(ar(h),p):c.addListener&&c.removeListener&&c.removeListener(p),(h=cr(c))?(oi(h,o),h.h==0&&(h.src=null,c[ci]=null)):ir(o)}}}function ar(o){return o in ui?ui[o]:ui[o]="on"+o}function Ss(o,c){if(o.da)o=!0;else{c=new In(c,this);var h=o.listener,p=o.ha||o.src;o.fa&&Tn(o),o=h.call(p,c)}return o}function cr(o){return o=o[ci],o instanceof sr?o:null}var ur="__closure_events_fn_"+(1e9*Math.random()>>>0);function lr(o){return typeof o=="function"?o:(o[ur]||(o[ur]=function(c){return o.handleEvent(c)}),o[ur])}function Pe(){De.call(this),this.i=new sr(this),this.M=this,this.F=null}L(Pe,De),Pe.prototype[En]=!0,Pe.prototype.removeEventListener=function(o,c,h,p){or(this,o,c,h,p)};function ke(o,c){var h,p=o.F;if(p)for(h=[];p;p=p.F)h.push(p);if(o=o.M,p=c.type||c,typeof c=="string")c=new Re(c,o);else if(c instanceof Re)c.target=c.target||o;else{var k=c;c=new Re(p,o),A(c,k)}if(k=!0,h)for(var O=h.length-1;0<=O;O--){var W=c.g=h[O];k=bn(W,p,!0,c)&&k}if(W=c.g=o,k=bn(W,p,!0,c)&&k,k=bn(W,p,!1,c)&&k,h)for(O=0;O<h.length;O++)W=c.g=h[O],k=bn(W,p,!1,c)&&k}Pe.prototype.N=function(){if(Pe.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var h=o.g[c],p=0;p<h.length;p++)ir(h[p]);delete o.g[c],o.h--}}this.F=null},Pe.prototype.K=function(o,c,h,p){return this.i.add(String(o),c,!1,h,p)},Pe.prototype.L=function(o,c,h,p){return this.i.add(String(o),c,!0,h,p)};function bn(o,c,h,p){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var k=!0,O=0;O<c.length;++O){var W=c[O];if(W&&!W.da&&W.capture==h){var pe=W.listener,Le=W.ha||W.src;W.fa&&oi(o.i,W),k=pe.call(Le,p)!==!1&&k}}return k&&!p.defaultPrevented}function li(o,c,h){if(typeof o=="function")h&&(o=y(o,h));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(o,c||0)}function hi(o){o.g=li(()=>{o.g=null,o.i&&(o.i=!1,hi(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class Rs extends De{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:hi(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ht(o){De.call(this),this.h=o,this.g={}}L(Ht,De);var di=[];function hr(o){F(o.g,function(c,h){this.g.hasOwnProperty(h)&&Tn(c)},o),o.g={}}Ht.prototype.N=function(){Ht.aa.N.call(this),hr(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fi=u.JSON.stringify,xa=u.JSON.parse,pi=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function dr(){}dr.prototype.h=null;function Ps(o){return o.h||(o.h=o.i())}function st(){}var An={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mi(){Re.call(this,"d")}L(mi,Re);function fr(){Re.call(this,"c")}L(fr,Re);var kt={},Cs=null;function pr(){return Cs=Cs||new Pe}kt.La="serverreachability";function Ds(o){Re.call(this,kt.La,o)}L(Ds,Re);function Sn(o){let c=pr();ke(c,new Ds(c))}kt.STAT_EVENT="statevent";function ks(o,c){Re.call(this,kt.STAT_EVENT,o),this.stat=c}L(ks,Re);function Ve(o){let c=pr();ke(c,new ks(c,o))}kt.Ma="timingevent";function Ns(o,c){Re.call(this,kt.Ma,o),this.size=c}L(Ns,Re);function Rn(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},c)}function Pn(){this.g=!0}Pn.prototype.xa=function(){this.g=!1};function Os(o,c,h,p,k,O){o.info(function(){if(o.g)if(O)for(var W="",pe=O.split("&"),Le=0;Le<pe.length;Le++){var le=pe[Le].split("=");if(1<le.length){var Fe=le[0];le=le[1];var Ue=Fe.split("_");W=2<=Ue.length&&Ue[1]=="type"?W+(Fe+"="+le+"&"):W+(Fe+"=redacted&")}}else W=null;else W=O;return"XMLHTTP REQ ("+p+") [attempt "+k+"]: "+c+`
`+h+`
`+W})}function Va(o,c,h,p,k,O,W){o.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+k+"]: "+c+`
`+h+`
`+O+" "+W})}function Qt(o,c,h,p){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+Ma(o,h)+(p?" "+p:"")})}function La(o,c){o.info(function(){return"TIMEOUT: "+c})}Pn.prototype.info=function(){};function Ma(o,c){if(!o.g)return c;if(!c)return null;try{var h=JSON.parse(c);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var p=h[o];if(!(2>p.length)){var k=p[1];if(Array.isArray(k)&&!(1>k.length)){var O=k[0];if(O!="noop"&&O!="stop"&&O!="close")for(var W=1;W<k.length;W++)k[W]=""}}}}return fi(h)}catch{return c}}var mr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},xs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gi;function gr(){}L(gr,dr),gr.prototype.g=function(){return new XMLHttpRequest},gr.prototype.i=function(){return{}},gi=new gr;function pt(o,c,h,p){this.j=o,this.i=c,this.l=h,this.R=p||1,this.U=new Ht(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Vs}function Vs(){this.i=null,this.g="",this.h=!1}var Ls={},_i={};function yi(o,c,h){o.L=1,o.v=ce(U(c)),o.m=h,o.P=!0,Ms(o,null)}function Ms(o,c){o.F=Date.now(),mt(o),o.A=U(o.v);var h=o.A,p=o.R;Array.isArray(p)||(p=[String(p)]),Ch(h.i,"t",p),o.C=0,h=o.j.J,o.h=new Vs,o.g=Kh(o.j,h?c:null,!o.m),0<o.O&&(o.M=new Rs(y(o.Y,o,o.g),o.O)),c=o.U,h=o.g,p=o.ca;var k="readystatechange";Array.isArray(k)||(k&&(di[0]=k.toString()),k=di);for(var O=0;O<k.length;O++){var W=it(h,k[O],p||c.handleEvent,!1,c.h||c);if(!W)break;c.g[W.key]=W}c=o.H?_(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Sn(),Os(o.i,o.u,o.A,o.l,o.R,o.m)}pt.prototype.ca=function(o){o=o.target;let c=this.M;c&&Nt(o)==3?c.j():this.Y(o)},pt.prototype.Y=function(o){try{if(o==this.g)e:{let Ue=Nt(this.g);var c=this.g.Ba();let Ir=this.g.Z();if(!(3>Ue)&&(Ue!=3||this.g&&(this.h.h||this.g.oa()||Lh(this.g)))){this.J||Ue!=4||c==7||(c==8||0>=Ir?Sn(3):Sn(2)),gt(this);var h=this.g.Z();this.X=h;t:if(Fs(this)){var p=Lh(this.g);o="";var k=p.length,O=Nt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Je(this),Cn(this);var W="";break t}this.h.i=new u.TextDecoder}for(c=0;c<k;c++)this.h.h=!0,o+=this.h.i.decode(p[c],{stream:!(O&&c==k-1)});p.length=0,this.h.g+=o,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=h==200,Va(this.i,this.u,this.A,this.l,this.R,Ue,h),this.o){if(this.T&&!this.K){t:{if(this.g){var pe,Le=this.g;if((pe=Le.g?Le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(pe)){var le=pe;break t}}le=null}if(h=le)Qt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Dn(this,h);else{this.o=!1,this.s=3,Ve(12),Je(this),Cn(this);break e}}if(this.P){h=!0;let ot;for(;!this.J&&this.C<W.length;)if(ot=Us(this,W),ot==_i){Ue==4&&(this.s=4,Ve(14),h=!1),Qt(this.i,this.l,null,"[Incomplete Response]");break}else if(ot==Ls){this.s=4,Ve(15),Qt(this.i,this.l,W,"[Invalid Chunk]"),h=!1;break}else Qt(this.i,this.l,ot,null),Dn(this,ot);if(Fs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||W.length!=0||this.h.h||(this.s=1,Ve(16),h=!1),this.o=this.o&&h,!h)Qt(this.i,this.l,W,"[Invalid Chunked Response]"),Je(this),Cn(this);else if(0<W.length&&!this.W){this.W=!0;var Fe=this.j;Fe.g==this&&Fe.ba&&!Fe.M&&(Fe.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),ja(Fe),Fe.M=!0,Ve(11))}}else Qt(this.i,this.l,W,null),Dn(this,W);Ue==4&&Je(this),this.o&&!this.J&&(Ue==4?jh(this.j,this):(this.o=!1,mt(this)))}else Pg(this.g),h==400&&0<W.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),Je(this),Cn(this)}}}catch{}finally{}};function Fs(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Us(o,c){var h=o.C,p=c.indexOf(`
`,h);return p==-1?_i:(h=Number(c.substring(h,p)),isNaN(h)?Ls:(p+=1,p+h>c.length?_i:(c=c.slice(p,p+h),o.C=p+h,c)))}pt.prototype.cancel=function(){this.J=!0,Je(this)};function mt(o){o.S=Date.now()+o.I,vi(o,o.I)}function vi(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Rn(y(o.ba,o),c)}function gt(o){o.B&&(u.clearTimeout(o.B),o.B=null)}pt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(La(this.i,this.A),this.L!=2&&(Sn(),Ve(17)),Je(this),this.s=2,Cn(this)):vi(this,this.S-o)};function Cn(o){o.j.G==0||o.J||jh(o.j,o)}function Je(o){gt(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,hr(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function Dn(o,c){try{var h=o.j;if(h.G!=0&&(h.g==o||Ii(h.h,o))){if(!o.K&&Ii(h.h,o)&&h.G==3){try{var p=h.Da.g.parse(c)}catch{p=null}if(Array.isArray(p)&&p.length==3){var k=p;if(k[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Gs(h),zs(h);else break e;$a(h),Ve(18)}}else h.za=k[1],0<h.za-h.T&&37500>k[2]&&h.F&&h.v==0&&!h.C&&(h.C=Rn(y(h.Za,h),6e3));if(1>=qs(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Nn(h,11)}else if((o.K||h.g==o)&&Gs(h),!X(c))for(k=h.Da.g.parse(c),c=0;c<k.length;c++){let le=k[c];if(h.T=le[0],le=le[1],h.G==2)if(le[0]=="c"){h.K=le[1],h.ia=le[2];let Fe=le[3];Fe!=null&&(h.la=Fe,h.j.info("VER="+h.la));let Ue=le[4];Ue!=null&&(h.Aa=Ue,h.j.info("SVER="+h.Aa));let Ir=le[5];Ir!=null&&typeof Ir=="number"&&0<Ir&&(p=1.5*Ir,h.L=p,h.j.info("backChannelRequestTimeoutMs_="+p)),p=h;let ot=o.g;if(ot){let Hs=ot.g?ot.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hs){var O=p.h;O.g||Hs.indexOf("spdy")==-1&&Hs.indexOf("quic")==-1&&Hs.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(f(O,O.h),O.h=null))}if(p.D){let za=ot.g?ot.g.getResponseHeader("X-HTTP-Session-Id"):null;za&&(p.ya=za,J(p.I,p.D,za))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),p=h;var W=o;if(p.qa=Gh(p,p.J?p.ia:null,p.W),W.K){T(p.h,W);var pe=W,Le=p.L;Le&&(pe.I=Le),pe.B&&(gt(pe),mt(pe)),p.g=W}else qh(p);0<h.i.length&&Ws(h)}else le[0]!="stop"&&le[0]!="close"||Nn(h,7);else h.G==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?Nn(h,7):qa(h):le[0]!="noop"&&h.l&&h.l.ta(le),h.v=0)}}Sn(4)}catch{}}var Fa=class{constructor(o,c){this.g=o,this.map=c}};function Bs(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _r(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function qs(o){return o.h?1:o.g?o.g.size:0}function Ii(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function f(o,c){o.g?o.g.add(c):o.h=c}function T(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Bs.prototype.cancel=function(){if(this.i=g(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function g(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let h of o.g.values())c=c.concat(h.D);return c}return z(o.i)}function P(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var c=[],h=o.length,p=0;p<h;p++)c.push(o[p]);return c}c=[],h=0;for(p in o)c[h++]=o[p];return c}function C(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var c=[];o=o.length;for(var h=0;h<o;h++)c.push(h);return c}c=[],h=0;for(let p in o)c[h++]=p;return c}}}function S(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var h=C(o),p=P(o),k=p.length,O=0;O<k;O++)c.call(void 0,p[O],h&&h[O],o)}var x=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function M(o,c){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var p=o[h].indexOf("="),k=null;if(0<=p){var O=o[h].substring(0,p);k=o[h].substring(p+1)}else O=o[h];c(O,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function q(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof q){this.h=o.h,j(this,o.j),this.o=o.o,this.g=o.g,K(this,o.s),this.l=o.l;var c=o.i,h=new kn;h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),ie(this,h),this.m=o.m}else o&&(c=String(o).match(x))?(this.h=!1,j(this,c[1]||"",!0),this.o=me(c[2]||""),this.g=me(c[3]||"",!0),K(this,c[4]),this.l=me(c[5]||"",!0),ie(this,c[6]||"",!0),this.m=me(c[7]||"")):(this.h=!1,this.i=new kn(null,this.h))}q.prototype.toString=function(){var o=[],c=this.j;c&&o.push(fe(c,Yt,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(fe(c,Yt,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(fe(h,h.charAt(0)=="/"?Ua:Ei,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",fe(h,Rh)),o.join("")};function U(o){return new q(o)}function j(o,c,h){o.j=h?me(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function K(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function ie(o,c,h){c instanceof kn?(o.i=c,Eg(o.i,o.h)):(h||(c=fe(c,wi)),o.i=new kn(c,o.h))}function J(o,c,h){o.i.set(c,h)}function ce(o){return J(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function me(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function fe(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,We),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function We(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Yt=/[#\/\?@]/g,Ei=/[#\?:]/g,Ua=/[#\?]/g,wi=/[#\?@]/g,Rh=/#/g;function kn(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function _t(o){o.g||(o.g=new Map,o.h=0,o.i&&M(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}n=kn.prototype,n.add=function(o,c){_t(this),this.i=null,o=yr(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function Ti(o,c){_t(o),c=yr(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Ph(o,c){return _t(o),c=yr(o,c),o.g.has(c)}n.forEach=function(o,c){_t(this),this.g.forEach(function(h,p){h.forEach(function(k){o.call(c,k,p,this)},this)},this)},n.na=function(){_t(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),h=[];for(let p=0;p<c.length;p++){let k=o[p];for(let O=0;O<k.length;O++)h.push(c[p])}return h},n.V=function(o){_t(this);let c=[];if(typeof o=="string")Ph(this,o)&&(c=c.concat(this.g.get(yr(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)c=c.concat(o[h])}return c},n.set=function(o,c){return _t(this),this.i=null,o=yr(this,o),Ph(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},n.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Ch(o,c,h){Ti(o,c),0<h.length&&(o.i=null,o.g.set(yr(o,c),z(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var h=0;h<c.length;h++){var p=c[h];let O=encodeURIComponent(String(p)),W=this.V(p);for(p=0;p<W.length;p++){var k=O;W[p]!==""&&(k+="="+encodeURIComponent(String(W[p]))),o.push(k)}}return this.i=o.join("&")};function yr(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Eg(o,c){c&&!o.j&&(_t(o),o.i=null,o.g.forEach(function(h,p){var k=p.toLowerCase();p!=k&&(Ti(this,p),Ch(this,k,h))},o)),o.j=c}function wg(o,c){let h=new Pn;if(u.Image){let p=new Image;p.onload=N(Jt,h,"TestLoadImage: loaded",!0,c,p),p.onerror=N(Jt,h,"TestLoadImage: error",!1,c,p),p.onabort=N(Jt,h,"TestLoadImage: abort",!1,c,p),p.ontimeout=N(Jt,h,"TestLoadImage: timeout",!1,c,p),u.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=o}else c(!1)}function Tg(o,c){let h=new Pn,p=new AbortController,k=setTimeout(()=>{p.abort(),Jt(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:p.signal}).then(O=>{clearTimeout(k),O.ok?Jt(h,"TestPingServer: ok",!0,c):Jt(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(k),Jt(h,"TestPingServer: error",!1,c)})}function Jt(o,c,h,p,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),p(h)}catch{}}function bg(){this.g=new pi}function Ag(o,c,h){let p=h||"";try{S(o,function(k,O){let W=k;d(k)&&(W=fi(k)),c.push(p+O+"="+encodeURIComponent(W))})}catch(k){throw c.push(p+"type="+encodeURIComponent("_badmap")),k}}function bi(o){this.l=o.Ub||null,this.j=o.eb||!1}L(bi,dr),bi.prototype.g=function(){return new $s(this.l,this.j)},bi.prototype.i=function(o){return function(){return o}}({});function $s(o,c){Pe.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L($s,Pe),n=$s.prototype,n.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Si(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Si(this)),this.g&&(this.readyState=3,Si(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dh(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Dh(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Ai(this):Si(this),this.readyState==3&&Dh(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,Ai(this))},n.Qa=function(o){this.g&&(this.response=o,Ai(this))},n.ga=function(){this.g&&Ai(this)};function Ai(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Si(o)}n.setRequestHeader=function(o,c){this.u.append(o,c)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function Si(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function kh(o){let c="";return F(o,function(h,p){c+=p,c+=":",c+=h,c+=`\r
`}),c}function Ba(o,c,h){e:{for(p in h){var p=!1;break e}p=!0}p||(h=kh(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):J(o,c,h))}function ve(o){Pe.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(ve,Pe);var Sg=/^https?$/i,Rg=["POST","PUT"];n=ve.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,c,h,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gi.g(),this.v=this.o?Ps(this.o):Ps(gi),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(O){Nh(this,O);return}if(o=h||"",h=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var k in p)h.set(k,p[k]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let O of p.keys())h.set(O,p.get(O));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(h.keys()).find(O=>O.toLowerCase()=="content-type"),k=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Rg,c,void 0))||p||k||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[O,W]of h)this.g.setRequestHeader(O,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vh(this),this.u=!0,this.g.send(o),this.u=!1}catch(O){Nh(this,O)}};function Nh(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,Oh(o),js(o)}function Oh(o){o.A||(o.A=!0,ke(o,"complete"),ke(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,ke(this,"complete"),ke(this,"abort"),js(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),js(this,!0)),ve.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?xh(this):this.bb())},n.bb=function(){xh(this)};function xh(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Nt(o)!=4||o.Z()!=2)){if(o.u&&Nt(o)==4)li(o.Ea,0,o);else if(ke(o,"readystatechange"),Nt(o)==4){o.h=!1;try{let W=o.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var p;if(p=W===0){var k=String(o.D).match(x)[1]||null;!k&&u.self&&u.self.location&&(k=u.self.location.protocol.slice(0,-1)),p=!Sg.test(k?k.toLowerCase():"")}h=p}if(h)ke(o,"complete"),ke(o,"success");else{o.m=6;try{var O=2<Nt(o)?o.g.statusText:""}catch{O=""}o.l=O+" ["+o.Z()+"]",Oh(o)}}finally{js(o)}}}}function js(o,c){if(o.g){Vh(o);let h=o.g,p=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||ke(o,"ready");try{h.onreadystatechange=p}catch{}}}function Vh(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Nt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Nt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),xa(c)}};function Lh(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Pg(o){let c={};o=(o.g&&2<=Nt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<o.length;p++){if(X(o[p]))continue;var h=R(o[p]);let k=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let O=c[k]||[];c[k]=O,O.push(h)}b(c,function(p){return p.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ri(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function Mh(o){this.Aa=0,this.i=[],this.j=new Pn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ri("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ri("baseRetryDelayMs",5e3,o),this.cb=Ri("retryDelaySeedMs",1e4,o),this.Wa=Ri("forwardChannelMaxRetries",2,o),this.wa=Ri("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Bs(o&&o.concurrentRequestLimit),this.Da=new bg,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Mh.prototype,n.la=8,n.G=1,n.connect=function(o,c,h,p){Ve(0),this.W=o,this.H=c||{},h&&p!==void 0&&(this.H.OSID=h,this.H.OAID=p),this.F=this.X,this.I=Gh(this,null,this.W),Ws(this)};function qa(o){if(Fh(o),o.G==3){var c=o.U++,h=U(o.I);if(J(h,"SID",o.K),J(h,"RID",c),J(h,"TYPE","terminate"),Pi(o,h),c=new pt(o,o.j,c),c.L=2,c.v=ce(U(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=c.v,h=!0),h||(c.g=Kh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),mt(c)}Wh(o)}function zs(o){o.g&&(ja(o),o.g.cancel(),o.g=null)}function Fh(o){zs(o),o.u&&(u.clearTimeout(o.u),o.u=null),Gs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Ws(o){if(!_r(o.h)&&!o.s){o.s=!0;var c=o.Ga;Dt||Ts(),Ye||(Dt(),Ye=!0),rr.add(c,o),o.B=0}}function Cg(o,c){return qs(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Rn(y(o.Ga,o,c),zh(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let k=new pt(this,this.j,o),O=this.o;if(this.S&&(O?(O=_(O),A(O,this.S)):O=this.S),this.m!==null||this.O||(k.H=O,O=null),this.P)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var p=this.i[h];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(c+=p,4096<c){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=Bh(this,k,c),h=U(this.I),J(h,"RID",o),J(h,"CVER",22),this.D&&J(h,"X-HTTP-Session-Id",this.D),Pi(this,h),O&&(this.O?c="headers="+encodeURIComponent(String(kh(O)))+"&"+c:this.m&&Ba(h,this.m,O)),f(this.h,k),this.Ua&&J(h,"TYPE","init"),this.P?(J(h,"$req",c),J(h,"SID","null"),k.T=!0,yi(k,h,null)):yi(k,h,c),this.G=2}}else this.G==3&&(o?Uh(this,o):this.i.length==0||_r(this.h)||Uh(this))};function Uh(o,c){var h;c?h=c.l:h=o.U++;let p=U(o.I);J(p,"SID",o.K),J(p,"RID",h),J(p,"AID",o.T),Pi(o,p),o.m&&o.o&&Ba(p,o.m,o.o),h=new pt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Bh(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),f(o.h,h),yi(h,p,c)}function Pi(o,c){o.H&&F(o.H,function(h,p){J(c,p,h)}),o.l&&S({},function(h,p){J(c,p,h)})}function Bh(o,c,h){h=Math.min(o.i.length,h);var p=o.l?y(o.l.Na,o.l,o):null;e:{var k=o.i;let O=-1;for(;;){let W=["count="+h];O==-1?0<h?(O=k[0].g,W.push("ofs="+O)):O=0:W.push("ofs="+O);let pe=!0;for(let Le=0;Le<h;Le++){let le=k[Le].g,Fe=k[Le].map;if(le-=O,0>le)O=Math.max(0,k[Le].g-100),pe=!1;else try{Ag(Fe,W,"req"+le+"_")}catch{p&&p(Fe)}}if(pe){p=W.join("&");break e}}}return o=o.i.splice(0,h),c.D=o,p}function qh(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;Dt||Ts(),Ye||(Dt(),Ye=!0),rr.add(c,o),o.v=0}}function $a(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Rn(y(o.Fa,o),zh(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,$h(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Rn(y(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),zs(this),$h(this))};function ja(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function $h(o){o.g=new pt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=U(o.qa);J(c,"RID","rpc"),J(c,"SID",o.K),J(c,"AID",o.T),J(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&J(c,"TO",o.ja),J(c,"TYPE","xmlhttp"),Pi(o,c),o.m&&o.o&&Ba(c,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=ce(U(c)),h.m=null,h.P=!0,Ms(h,o)}n.Za=function(){this.C!=null&&(this.C=null,zs(this),$a(this),Ve(19))};function Gs(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function jh(o,c){var h=null;if(o.g==c){Gs(o),ja(o),o.g=null;var p=2}else if(Ii(o.h,c))h=c.D,T(o.h,c),p=1;else return;if(o.G!=0){if(c.o)if(p==1){h=c.m?c.m.length:0,c=Date.now()-c.F;var k=o.B;p=pr(),ke(p,new Ns(p,h)),Ws(o)}else qh(o);else if(k=c.s,k==3||k==0&&0<c.X||!(p==1&&Cg(o,c)||p==2&&$a(o)))switch(h&&0<h.length&&(c=o.h,c.i=c.i.concat(h)),k){case 1:Nn(o,5);break;case 4:Nn(o,10);break;case 3:Nn(o,6);break;default:Nn(o,2)}}}function zh(o,c){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*c}function Nn(o,c){if(o.j.info("Error code "+c),c==2){var h=y(o.fb,o),p=o.Xa;let k=!p;p=new q(p||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||j(p,"https"),ce(p),k?wg(p.toString(),h):Tg(p.toString(),h)}else Ve(2);o.G=0,o.l&&o.l.sa(c),Wh(o),Fh(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function Wh(o){if(o.G=0,o.ka=[],o.l){let c=g(o.h);(c.length!=0||o.i.length!=0)&&($(o.ka,c),$(o.ka,o.i),o.h.i.length=0,z(o.i),o.i.length=0),o.l.ra()}}function Gh(o,c,h){var p=h instanceof q?U(h):new q(h);if(p.g!="")c&&(p.g=c+"."+p.g),K(p,p.s);else{var k=u.location;p=k.protocol,c=c?c+"."+k.hostname:k.hostname,k=+k.port;var O=new q(null);p&&j(O,p),c&&(O.g=c),k&&K(O,k),h&&(O.l=h),p=O}return h=o.D,c=o.ya,h&&c&&J(p,h,c),J(p,"VER",o.la),Pi(o,p),p}function Kh(o,c,h){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ve(new bi({eb:h})):new ve(o.pa),c.Ha(o.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hh(){}n=Hh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ks(){}Ks.prototype.g=function(o,c){return new Ke(o,c)};function Ke(o,c){Pe.call(this),this.g=new Mh(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!X(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!X(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new vr(this)}L(Ke,Pe),Ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ke.prototype.close=function(){qa(this.g)},Ke.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=fi(o),o=h);c.i.push(new Fa(c.Ya++,o)),c.G==3&&Ws(c)},Ke.prototype.N=function(){this.g.l=null,delete this.j,qa(this.g),delete this.g,Ke.aa.N.call(this)};function Qh(o){mi.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}L(Qh,mi);function Yh(){fr.call(this),this.status=1}L(Yh,fr);function vr(o){this.g=o}L(vr,Hh),vr.prototype.ua=function(){ke(this.g,"a")},vr.prototype.ta=function(o){ke(this.g,new Qh(o))},vr.prototype.sa=function(o){ke(this.g,new Yh)},vr.prototype.ra=function(){ke(this.g,"b")},Ks.prototype.createWebChannel=Ks.prototype.g,Ke.prototype.send=Ke.prototype.o,Ke.prototype.open=Ke.prototype.m,Ke.prototype.close=Ke.prototype.close,gu=Bt.createWebChannelTransport=function(){return new Ks},mu=Bt.getStatEventTarget=function(){return pr()},pu=Bt.Event=kt,xo=Bt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},mr.NO_ERROR=0,mr.TIMEOUT=8,mr.HTTP_ERROR=6,Ji=Bt.ErrorCode=mr,xs.COMPLETE="complete",fu=Bt.EventType=xs,st.EventType=An,An.OPEN="a",An.CLOSE="b",An.ERROR="c",An.MESSAGE="d",Pe.prototype.listen=Pe.prototype.K,Vr=Bt.WebChannel=st,fE=Bt.FetchXmlHttpFactory=bi,ve.prototype.listenOnce=ve.prototype.L,ve.prototype.getLastError=ve.prototype.Ka,ve.prototype.getLastErrorCode=ve.prototype.Ba,ve.prototype.getStatus=ve.prototype.Z,ve.prototype.getResponseJson=ve.prototype.Oa,ve.prototype.getResponseText=ve.prototype.oa,ve.prototype.send=ve.prototype.ea,ve.prototype.setWithCredentials=ve.prototype.Ha,du=Bt.XhrIo=ve}).apply(typeof Oo<"u"?Oo:typeof self<"u"?self:typeof window<"u"?window:{});var Qf="@firebase/firestore",Yf="4.8.0";var Oe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");var ni="11.10.0";var Kn=new It("@firebase/firestore");function Lr(){return Kn.logLevel}function G(n,...e){if(Kn.logLevel<=oe.DEBUG){let t=e.map(eh);Kn.debug(`Firestore (${ni}): ${n}`,...t)}}function $t(n,...e){if(Kn.logLevel<=oe.ERROR){let t=e.map(eh);Kn.error(`Firestore (${ni}): ${n}`,...t)}}function gn(n,...e){if(Kn.logLevel<=oe.WARN){let t=e.map(eh);Kn.warn(`Firestore (${ni}): ${n}`,...t)}}function eh(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ee(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Up(n,r,t)}function Up(n,e,t){let r=`FIRESTORE (${ni}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw $t(r),new Error(r)}function de(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Up(e,i,r)}function ne(n,e){return n}var V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},H=class extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var dt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var qo=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Eu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Oe.UNAUTHENTICATED))}shutdown(){}},wu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Tu=class{constructor(e){this.t=e,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){de(this.o===void 0,42304);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new dt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new dt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>v(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},u=l=>{G("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?u(l):(G("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new dt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(G("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(de(typeof r.accessToken=="string",31837,{l:r}),new qo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return de(e===null||typeof e=="string",2055,{h:e}),new Oe(e)}},bu=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Au=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new bu(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},$o=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Su=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ge(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){de(this.o===void 0,3512);let r=s=>{s.error!=null&&G("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.m;return this.m=s.token,G("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{G("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):G("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new $o(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(de(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $o(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function pE(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Bp(){return new TextEncoder}var rs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=pE(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function se(n,e){return n<e?-1:n>e?1:0}function Ru(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return se(r,i);{let s=Bp(),a=mE(s.encode(Jf(n,t)),s.encode(Jf(e,t)));return a!==0?a:se(r,i)}}t+=r>65535?2:1}return se(n.length,e.length)}function Jf(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function mE(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return se(n[t],e[t]);return se(n.length,e.length)}function jr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Xf="__name__",jo=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ee(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ee(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return se(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Ru(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ut.fromString(e.substring(4,e.length-2))}},ye=class n extends jo{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new H(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},gE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qe=class n extends jo{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return gE.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Xf}static keyField(){return new n([Xf])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new H(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new H(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new H(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new H(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Z=class n{constructor(e){this.path=e}static fromPath(e){return new n(ye.fromString(e))}static fromName(e){return new n(ye.fromString(e).popFirst(5))}static empty(){return new n(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ye(e.slice()))}};function qp(n,e,t){if(!t)throw new H(V.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _E(n,e,t,r){if(e===!0&&r===!0)throw new H(V.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Zf(n){if(!Z.isDocumentKey(n))throw new H(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ep(n){if(Z.isDocumentKey(n))throw new H(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $p(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function th(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ee(12329,{type:typeof n})}function nt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new H(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=th(n);throw new H(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function be(n,e){let t={typeString:n};return e&&(t.value=e),t}function ys(n,e){if(!$p(n))throw new H(V.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new H(V.INVALID_ARGUMENT,t);return!0}var tp=-62135596800,np=1e6,Ae=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*np);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new H(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<tp)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/np}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ys(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-tp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Ae._jsonSchemaVersion="firestore/timestamp/1.0",Ae._jsonSchema={type:be("string",Ae._jsonSchemaVersion),seconds:be("number"),nanoseconds:be("number")};var re=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ae(0,0))}static max(){return new n(new Ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var is=-1,Pu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Pu.UNKNOWN_ID=-1;function yE(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=re.fromTimestamp(r===1e9?new Ae(t+1,0):new Ae(t,r));return new Hn(i,Z.empty(),e)}function vE(n){return new Hn(n.readTime,n.key,is)}var Hn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(re.min(),Z.empty(),is)}static max(){return new n(re.max(),Z.empty(),is)}};function IE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Z.comparator(n.documentKey,e.documentKey),t!==0?t:se(n.largestBatchId,e.largestBatchId))}var EE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Cu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ri(n){return v(this,null,function*(){if(n.code!==V.FAILED_PRECONDITION||n.message!==EE)throw n;G("LocalStore","Unexpectedly lost primary lease")})}var B=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ee(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(m=>{a[d]=m,++u,u===s&&r(a)},m=>i(m))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function wE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ii(n){return n.name==="IndexedDbTransactionError"}var nh=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),rh=-1;function ya(n){return n==null}function ss(n){return n===0&&1/n==-1/0}function TE(n){return typeof n=="number"&&Number.isInteger(n)&&!ss(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var jp="";function bE(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=rp(e)),e=AE(n.get(t),e);return rp(e)}function AE(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case jp:t+="";break;default:t+=s}}return t}function rp(n){return n+jp+""}var SE="remoteDocuments",zp="owner";var Wp="mutationQueues";var Gp="mutations";var Kp="documentMutations",RE="remoteDocumentsV14";var Hp="remoteDocumentGlobal";var Qp="targets";var Yp="targetDocuments";var Jp="targetGlobal",Xp="collectionParents";var Zp="clientMetadata";var em="bundles";var tm="namedQueries";var PE="indexConfiguration";var CE="indexState";var DE="indexEntries";var nm="documentOverlays";var kE="globals";var NE=[Wp,Gp,Kp,SE,Qp,zp,Jp,Yp,Zp,Hp,Xp,em,tm],aS=[...NE,nm],OE=[Wp,Gp,Kp,RE,Qp,zp,Jp,Yp,Zp,Hp,Xp,em,tm,nm],xE=OE,VE=[...xE,PE,CE,DE];var cS=[...VE,kE];function ip(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Zn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ee=class n{constructor(e,t){this.comparator=e,this.root=t||bt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Br(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Br(this.root,e,this.comparator,!1)}getReverseIterator(){return new Br(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Br(this.root,e,this.comparator,!0)}},Br=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},bt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ee(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ee(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ee(27949);return e+(this.isRed()?0:1)}};bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw ee(57766)}get value(){throw ee(16141)}get color(){throw ee(16727)}get left(){throw ee(29726)}get right(){throw ee(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var xe=class n{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zo(this.data.getIterator())}getIteratorFrom(e){return new zo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},zo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Tt=class n{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new n([])}unionWith(e){let t=new xe(Qe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return jr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Wo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var je=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Wo("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};je.EMPTY_BYTE_STRING=new je("");var LE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jt(n){if(de(!!n,39018),typeof n=="string"){let e=0,t=LE.exec(n);if(de(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ge(n.seconds),nanos:ge(n.nanos)}}function ge(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function zt(n){return typeof n=="string"?je.fromBase64String(n):je.fromUint8Array(n)}var im="server_timestamp",sm="__type__",om="__previous_value__",am="__local_write_time__";function ih(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[sm])===null||t===void 0?void 0:t.stringValue)===im}function va(n){let e=n.mapValue.fields[om];return ih(e)?va(e):e}function os(n){let e=jt(n.mapValue.fields[am].timestampValue);return new Ae(e.seconds,e.nanos)}var Du=class{constructor(e,t,r,i,s,a,u,l,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=m}},Go="(default)",Ko=class n{constructor(e,t){this.projectId=e,this.database=t||Go}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Go}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var sh="__type__",cm="__max__",Vo={mapValue:{fields:{__type__:{stringValue:cm}}}},oh="__vector__",zr="value";function _n(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ih(n)?4:lm(n)?9007199254740991:um(n)?10:11:ee(28295,{value:n})}function Rt(n,e){if(n===e)return!0;let t=_n(n);if(t!==_n(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return os(n).isEqual(os(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=jt(i.timestampValue),u=jt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return zt(i.bytesValue).isEqual(zt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ge(i.geoPointValue.latitude)===ge(s.geoPointValue.latitude)&&ge(i.geoPointValue.longitude)===ge(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ge(i.integerValue)===ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ge(i.doubleValue),u=ge(s.doubleValue);return a===u?ss(a)===ss(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return jr(n.arrayValue.values||[],e.arrayValue.values||[],Rt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(ip(a)!==ip(u))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(u[l]===void 0||!Rt(a[l],u[l])))return!1;return!0}(n,e);default:return ee(52216,{left:n})}}function as(n,e){return(n.values||[]).find(t=>Rt(t,e))!==void 0}function Wr(n,e){if(n===e)return 0;let t=_n(n),r=_n(e);if(t!==r)return se(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return se(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=ge(s.integerValue||s.doubleValue),l=ge(a.integerValue||a.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(n,e);case 3:return sp(n.timestampValue,e.timestampValue);case 4:return sp(os(n),os(e));case 5:return Ru(n.stringValue,e.stringValue);case 6:return function(s,a){let u=zt(s),l=zt(a);return u.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),l=a.split("/");for(let d=0;d<u.length&&d<l.length;d++){let m=se(u[d],l[d]);if(m!==0)return m}return se(u.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=se(ge(s.latitude),ge(a.latitude));return u!==0?u:se(ge(s.longitude),ge(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return op(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,l,d,m;let w=s.fields||{},y=a.fields||{},N=(u=w[zr])===null||u===void 0?void 0:u.arrayValue,L=(l=y[zr])===null||l===void 0?void 0:l.arrayValue,z=se(((d=N?.values)===null||d===void 0?void 0:d.length)||0,((m=L?.values)===null||m===void 0?void 0:m.length)||0);return z!==0?z:op(N,L)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Vo.mapValue&&a===Vo.mapValue)return 0;if(s===Vo.mapValue)return 1;if(a===Vo.mapValue)return-1;let u=s.fields||{},l=Object.keys(u),d=a.fields||{},m=Object.keys(d);l.sort(),m.sort();for(let w=0;w<l.length&&w<m.length;++w){let y=Ru(l[w],m[w]);if(y!==0)return y;let N=Wr(u[l[w]],d[m[w]]);if(N!==0)return N}return se(l.length,m.length)}(n.mapValue,e.mapValue);default:throw ee(23264,{le:t})}}function sp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return se(n,e);let t=jt(n),r=jt(e),i=se(t.seconds,r.seconds);return i!==0?i:se(t.nanos,r.nanos)}function op(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Wr(t[i],r[i]);if(s)return s}return se(t.length,r.length)}function Gr(n){return ku(n)}function ku(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=jt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return zt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=ku(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${ku(t.fields[a])}`;return i+"}"}(n.mapValue):ee(61005,{value:n})}function Fo(n){switch(_n(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=va(n);return e?16+Fo(e):16;case 5:return 2*n.stringValue.length;case 6:return zt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Fo(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Zn(r.fields,(s,a)=>{i+=s.length+Fo(a)}),i}(n.mapValue);default:throw ee(13486,{value:n})}}function Nu(n){return!!n&&"integerValue"in n}function ah(n){return!!n&&"arrayValue"in n}function ap(n){return!!n&&"nullValue"in n}function cp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Uo(n){return!!n&&"mapValue"in n}function um(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[sh])===null||t===void 0?void 0:t.stringValue)===oh}function Zi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Zn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Zi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function lm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===cm}var lS={mapValue:{fields:{[sh]:{stringValue:oh},[zr]:{arrayValue:{}}}}};var ht=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Uo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zi(t)}setAll(e){let t=Qe.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Zi(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Uo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Rt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Uo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Zn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Zi(this.value))}};function hm(n){let e=[];return Zn(n.fields,(t,r)=>{let i=new Qe([t]);if(Uo(r)){let s=hm(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Tt(e)}var ft=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,re.min(),re.min(),re.min(),ht.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,re.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,re.min(),re.min(),ht.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,re.min(),re.min(),ht.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Kr=class{constructor(e,t){this.position=e,this.inclusive=t}};function up(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=Z.comparator(Z.fromName(a.referenceValue),t.key):r=Wr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function lp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Rt(n.position[t],e.position[t]))return!1;return!0}var Hr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function ME(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ho=class{},Ce=class n extends Ho{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xu(e,t,r):t==="array-contains"?new Mu(e,r):t==="in"?new Fu(e,r):t==="not-in"?new Uu(e,r):t==="array-contains-any"?new Bu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Vu(e,r):new Lu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Wr(t,this.value)):t!==null&&_n(this.value)===_n(t)&&this.matchesComparison(Wr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Pt=class n extends Ho{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return dm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function dm(n){return n.op==="and"}function fm(n){return FE(n)&&dm(n)}function FE(n){for(let e of n.filters)if(e instanceof Pt)return!1;return!0}function Ou(n){if(n instanceof Ce)return n.field.canonicalString()+n.op.toString()+Gr(n.value);if(fm(n))return n.filters.map(e=>Ou(e)).join(",");{let e=n.filters.map(t=>Ou(t)).join(",");return`${n.op}(${e})`}}function pm(n,e){return n instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.field.isEqual(i.field)&&Rt(r.value,i.value)}(n,e):n instanceof Pt?function(r,i){return i instanceof Pt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&pm(a,i.filters[u]),!0):!1}(n,e):void ee(19439)}function mm(n){return n instanceof Ce?function(t){return`${t.field.canonicalString()} ${t.op} ${Gr(t.value)}`}(n):n instanceof Pt?function(t){return t.op.toString()+" {"+t.getFilters().map(mm).join(" ,")+"}"}(n):"Filter"}var xu=class extends Ce{constructor(e,t,r){super(e,t,r),this.key=Z.fromName(r.referenceValue)}matches(e){let t=Z.comparator(e.key,this.key);return this.matchesComparison(t)}},Vu=class extends Ce{constructor(e,t){super(e,"in",t),this.keys=gm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Lu=class extends Ce{constructor(e,t){super(e,"not-in",t),this.keys=gm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function gm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Z.fromName(r.referenceValue))}var Mu=class extends Ce{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ah(t)&&as(t.arrayValue,this.value)}},Fu=class extends Ce{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&as(this.value.arrayValue,t)}},Uu=class extends Ce{constructor(e,t){super(e,"not-in",t)}matches(e){if(as(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!as(this.value.arrayValue,t)}},Bu=class extends Ce{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ah(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>as(this.value.arrayValue,r))}};var qu=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.Pe=null}};function hp(n,e=null,t=[],r=[],i=null,s=null,a=null){return new qu(n,e,t,r,i,s,a)}function ch(n){let e=ne(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ou(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ya(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gr(r)).join(",")),e.Pe=t}return e.Pe}function uh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ME(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!pm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!lp(n.startAt,e.startAt)&&lp(n.endAt,e.endAt)}function $u(n){return Z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Qr=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function UE(n,e,t,r,i,s,a,u){return new Qr(n,e,t,r,i,s,a,u)}function Ia(n){return new Qr(n)}function dp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function BE(n){return n.collectionGroup!==null}function es(n){let e=ne(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new xe(Qe.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Hr(s,r))}),t.has(Qe.keyField().canonicalString())||e.Te.push(new Hr(Qe.keyField(),r))}return e.Te}function At(n){let e=ne(n);return e.Ie||(e.Ie=qE(e,es(n))),e.Ie}function qE(n,e){if(n.limitType==="F")return hp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Hr(i.field,s)});let t=n.endAt?new Kr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Kr(n.startAt.position,n.startAt.inclusive):null;return hp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ju(n,e,t){return new Qr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ea(n,e){return uh(At(n),At(e))&&n.limitType===e.limitType}function _m(n){return`${ch(At(n))}|lt:${n.limitType}`}function Mr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>mm(i)).join(", ")}]`),ya(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Gr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Gr(i)).join(",")),`Target(${r})`}(At(n))}; limitType=${n.limitType})`}function wa(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Z.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of es(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,l){let d=up(a,u,l);return a.inclusive?d<=0:d<0}(r.startAt,es(r),i)||r.endAt&&!function(a,u,l){let d=up(a,u,l);return a.inclusive?d>=0:d>0}(r.endAt,es(r),i))}(n,e)}function $E(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ym(n){return(e,t)=>{let r=!1;for(let i of es(n)){let s=jE(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function jE(n,e,t){let r=n.field.isKeyField()?Z.comparator(e.key,t.key):function(s,a,u){let l=a.data.field(s),d=u.data.field(s);return l!==null&&d!==null?Wr(l,d):ee(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ee(19790,{direction:n.dir})}}var Wt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return rm(this.inner)}size(){return this.innerSize}};var zE=new Ee(Z.comparator);function Gt(){return zE}var vm=new Ee(Z.comparator);function Xi(...n){let e=vm;for(let t of n)e=e.insert(t.key,t);return e}function Im(n){let e=vm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $n(){return ts()}function Em(){return ts()}function ts(){return new Wt(n=>n.toString(),(n,e)=>n.isEqual(e))}var WE=new Ee(Z.comparator),GE=new xe(Z.comparator);function ae(...n){let e=GE;for(let t of n)e=e.add(t);return e}var KE=new xe(se);function HE(){return KE}function lh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ss(e)?"-0":e}}function wm(n){return{integerValue:""+n}}function QE(n,e){return TE(e)?wm(e):lh(n,e)}var Yr=class{constructor(){this._=void 0}};function YE(n,e,t){return n instanceof Jr?function(i,s){let a={fields:{[sm]:{stringValue:im},[am]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ih(s)&&(s=va(s)),s&&(a.fields[om]=s),{mapValue:a}}(t,e):n instanceof Qn?bm(n,e):n instanceof Yn?Am(n,e):function(i,s){let a=Tm(i,s),u=fp(a)+fp(i.Ee);return Nu(a)&&Nu(i.Ee)?wm(u):lh(i.serializer,u)}(n,e)}function JE(n,e,t){return n instanceof Qn?bm(n,e):n instanceof Yn?Am(n,e):t}function Tm(n,e){return n instanceof Xr?function(r){return Nu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Jr=class extends Yr{},Qn=class extends Yr{constructor(e){super(),this.elements=e}};function bm(n,e){let t=Sm(e);for(let r of n.elements)t.some(i=>Rt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Yn=class extends Yr{constructor(e){super(),this.elements=e}};function Am(n,e){let t=Sm(e);for(let r of n.elements)t=t.filter(i=>!Rt(i,r));return{arrayValue:{values:t}}}var Xr=class extends Yr{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function fp(n){return ge(n.integerValue||n.doubleValue)}function Sm(n){return ah(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function XE(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Qn&&i instanceof Qn||r instanceof Yn&&i instanceof Yn?jr(r.elements,i.elements,Rt):r instanceof Xr&&i instanceof Xr?Rt(r.Ee,i.Ee):r instanceof Jr&&i instanceof Jr}(n.transform,e.transform)}var zu=class{constructor(e,t){this.version=e,this.transformResults=t}},qt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Bo(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Zr=class{};function Rm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cs(n.key,qt.none()):new Jn(n.key,n.data,qt.none());{let t=n.data,r=ht.empty(),i=new xe(Qe.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Kt(n.key,r,new Tt(i.toArray()),qt.none())}}function ZE(n,e,t){n instanceof Jn?function(i,s,a){let u=i.value.clone(),l=mp(i.fieldTransforms,s,a.transformResults);u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Kt?function(i,s,a){if(!Bo(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=mp(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Pm(i)),l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ns(n,e,t,r){return n instanceof Jn?function(s,a,u,l){if(!Bo(s.precondition,a))return u;let d=s.value.clone(),m=gp(s.fieldTransforms,l,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Kt?function(s,a,u,l){if(!Bo(s.precondition,a))return u;let d=gp(s.fieldTransforms,l,a),m=a.data;return m.setAll(Pm(s)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(w=>w.field))}(n,e,t,r):function(s,a,u){return Bo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function ew(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Tm(r.transform,i||null);s!=null&&(t===null&&(t=ht.empty()),t.set(r.field,s))}return t||null}function pp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&jr(r,i,(s,a)=>XE(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Jn=class extends Zr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Kt=class extends Zr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Pm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function mp(n,e,t){let r=new Map;de(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,JE(a,u,t[i]))}return r}function gp(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,YE(s,a,e))}return r}var cs=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Wu=class extends Zr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Gu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&ZE(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ns(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ns(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Em();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let l=Rm(a,u);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ae())}isEqual(e){return this.batchId===e.batchId&&jr(this.mutations,e.mutations,(t,r)=>pp(t,r))&&jr(this.baseMutations,e.baseMutations,(t,r)=>pp(t,r))}},Ku=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){de(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return WE}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Hu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Qu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var we,ue;function tw(n){switch(n){case V.OK:return ee(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return ee(15467,{code:n})}}function Cm(n){if(n===void 0)return $t("GRPC error has no .code"),V.UNKNOWN;switch(n){case we.OK:return V.OK;case we.CANCELLED:return V.CANCELLED;case we.UNKNOWN:return V.UNKNOWN;case we.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case we.INTERNAL:return V.INTERNAL;case we.UNAVAILABLE:return V.UNAVAILABLE;case we.UNAUTHENTICATED:return V.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case we.NOT_FOUND:return V.NOT_FOUND;case we.ALREADY_EXISTS:return V.ALREADY_EXISTS;case we.PERMISSION_DENIED:return V.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case we.ABORTED:return V.ABORTED;case we.OUT_OF_RANGE:return V.OUT_OF_RANGE;case we.UNIMPLEMENTED:return V.UNIMPLEMENTED;case we.DATA_LOSS:return V.DATA_LOSS;default:return ee(39323,{code:n})}}(ue=we||(we={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";var _p=null;var nw=new Ut([4294967295,4294967295],0);function yp(n){let e=Bp().encode(n),t=new hu;return t.update(e),new Uint8Array(t.digest())}function vp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ut([t,r],0),new Ut([i,s],0)]}var Yu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new jn(`Invalid padding: ${t}`);if(r<0)throw new jn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new jn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new jn(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Ut.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Ut.fromNumber(r)));return i.compare(nw)===1&&(i=new Ut([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=yp(e),[r,i]=vp(t);for(let s=0;s<this.hashCount;s++){let a=this.pe(r,i,s);if(!this.ye(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.fe===0)return;let t=yp(e),[r,i]=vp(t);for(let s=0;s<this.hashCount;s++){let a=this.pe(r,i,s);this.we(a)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},jn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Qo=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,us.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(re.min(),i,new Ee(se),Gt(),ae())}},us=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ae(),ae(),ae())}};var qr=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Yo=class{constructor(e,t){this.targetId=e,this.De=t}},Jo=class{constructor(e,t,r=je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Xo=class{constructor(){this.ve=0,this.Ce=Ip(),this.Fe=je.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ae(),t=ae(),r=ae();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ee(38017,{changeType:s})}}),new us(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Ip()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,de(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},Ju=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Gt(),this.je=Lo(),this.Je=Lo(),this.He=new Ee(se)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:ee(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if($u(s))if(r===0){let a=new Z(s.path);this.Xe(t,a,ft.newNoDocument(a,re.min()))}else de(r===1,20013,{expectedCount:r});else{let a=this.ot(t);if(a!==r){let u=this._t(e),l=u?this.ut(u,e,a):1;if(l!==0){this.rt(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}_p?.ct(function(m,w,y,N,L){var z,$,Q,X,Y,he;let _e={localCacheCount:m,existenceFilterCount:w.count,databaseId:y.database,projectId:y.projectId},F=w.unchangedNames;return F&&(_e.bloomFilter={applied:L===0,hashCount:(z=F?.hashCount)!==null&&z!==void 0?z:0,bitmapLength:(X=(Q=($=F?.bits)===null||$===void 0?void 0:$.bitmap)===null||Q===void 0?void 0:Q.length)!==null&&X!==void 0?X:0,padding:(he=(Y=F?.bits)===null||Y===void 0?void 0:Y.padding)!==null&&he!==void 0?he:0,mightContain:b=>{var _;return(_=N?.mightContain(b))!==null&&_!==void 0&&_}}),_e}(a,e.De,this.We.lt(),u,l))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=zt(r).toUint8Array()}catch(l){if(l instanceof Wo)return gn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{u=new Yu(a,i,s)}catch(l){return gn(l instanceof jn?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return u.fe===0?null:u}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.We.lt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,a)=>{let u=this.st(a);if(u){if(s.current&&$u(u.target)){let l=new Z(u.target.path);this.Tt(l).has(a)||this.It(a,l)||this.Xe(a,l,ft.newNoDocument(l,e))}s.Ne&&(t.set(a,s.Le()),s.ke())}});let r=ae();this.Je.forEach((s,a)=>{let u=!0;a.forEachWhile(l=>{let d=this.st(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(e));let i=new Qo(e,t,this.He,this.ze,r);return this.ze=Gt(),this.je=Lo(),this.Je=Lo(),this.He=new Ee(se),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Xo,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new xe(se),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new xe(se),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||G("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Xo),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Lo(){return new Ee(Z.comparator)}function Ip(){return new Ee(Z.comparator)}var rw={asc:"ASCENDING",desc:"DESCENDING"},iw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sw={and:"AND",or:"OR"},Xu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Zu(n,e){return n.useProto3Json||ya(e)?e:{value:e}}function Zo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dm(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function ow(n,e){return Zo(n,e.toTimestamp())}function St(n){return de(!!n,49232),re.fromTimestamp(function(t){let r=jt(t);return new Ae(r.seconds,r.nanos)}(n))}function hh(n,e){return el(n,e).canonicalString()}function el(n,e){let t=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function km(n){let e=ye.fromString(n);return de(Lm(e),10190,{key:e.toString()}),e}function tl(n,e){return hh(n.databaseId,e.path)}function _u(n,e){let t=km(e);if(t.get(1)!==n.databaseId.projectId)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new H(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Z(Om(t))}function Nm(n,e){return hh(n.databaseId,e)}function aw(n){let e=km(n);return e.length===4?ye.emptyPath():Om(e)}function nl(n){return new ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Om(n){return de(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ep(n,e,t){return{name:tl(n,e),fields:t.value.mapValue.fields}}function cw(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ee(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(de(m===void 0||typeof m=="string",58123),je.fromBase64String(m||"")):(de(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),je.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let m=d.code===void 0?V.UNKNOWN:Cm(d.code);return new H(m,d.message||"")}(a);t=new Jo(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=_u(n,r.document.name),s=St(r.document.updateTime),a=r.document.createTime?St(r.document.createTime):re.min(),u=new ht({mapValue:{fields:r.document.fields}}),l=ft.newFoundDocument(i,s,a,u),d=r.targetIds||[],m=r.removedTargetIds||[];t=new qr(d,m,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=_u(n,r.document),s=r.readTime?St(r.readTime):re.min(),a=ft.newNoDocument(i,s),u=r.removedTargetIds||[];t=new qr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=_u(n,r.document),s=r.removedTargetIds||[];t=new qr([],s,i,null)}else{if(!("filter"in e))return ee(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Qu(i,s),u=r.targetId;t=new Yo(u,a)}}return t}function uw(n,e){let t;if(e instanceof Jn)t={update:Ep(n,e.key,e.value)};else if(e instanceof cs)t={delete:tl(n,e.key)};else if(e instanceof Kt)t={update:Ep(n,e.key,e.data),updateMask:yw(e.fieldMask)};else{if(!(e instanceof Wu))return ee(16599,{Rt:e.type});t={verify:tl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof Jr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Qn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Yn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Xr)return{fieldPath:a.field.canonicalString(),increment:u.Ee};throw ee(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:ow(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ee(27497)}(n,e.precondition)),t}function lw(n,e){return n&&n.length>0?(de(e!==void 0,14353),n.map(t=>function(i,s){let a=i.updateTime?St(i.updateTime):St(s);return a.isEqual(re.min())&&(a=St(s)),new zu(a,i.transformResults||[])}(t,e))):[]}function hw(n,e){return{documents:[Nm(n,e.path)]}}function dw(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Nm(n,i);let s=function(d){if(d.length!==0)return Vm(Pt.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(m=>function(y){return{field:Fr(y.field),direction:mw(y.dir)}}(m))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Zu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:t,parent:i}}function fw(n){let e=aw(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){de(r===1,65062);let m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(w){let y=xm(w);return y instanceof Pt&&fm(y)?y.getFilters():[y]}(t.where));let a=[];t.orderBy&&(a=function(w){return w.map(y=>function(L){return new Hr(Ur(L.field),function($){switch($){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(y))}(t.orderBy));let u=null;t.limit&&(u=function(w){let y;return y=typeof w=="object"?w.value:w,ya(y)?null:y}(t.limit));let l=null;t.startAt&&(l=function(w){let y=!!w.before,N=w.values||[];return new Kr(N,y)}(t.startAt));let d=null;return t.endAt&&(d=function(w){let y=!w.before,N=w.values||[];return new Kr(N,y)}(t.endAt)),UE(e,i,a,s,u,"F",l,d)}function pw(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ur(t.unaryFilter.field);return Ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ur(t.unaryFilter.field);return Ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ur(t.unaryFilter.field);return Ce.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Ur(t.unaryFilter.field);return Ce.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ee(61313);default:return ee(60726)}}(n):n.fieldFilter!==void 0?function(t){return Ce.create(Ur(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ee(58110);default:return ee(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Pt.create(t.compositeFilter.filters.map(r=>xm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ee(1026)}}(t.compositeFilter.op))}(n):ee(30097,{filter:n})}function mw(n){return rw[n]}function gw(n){return iw[n]}function _w(n){return sw[n]}function Fr(n){return{fieldPath:n.canonicalString()}}function Ur(n){return Qe.fromServerFormat(n.fieldPath)}function Vm(n){return n instanceof Ce?function(t){if(t.op==="=="){if(cp(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NAN"}};if(ap(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(cp(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NAN"}};if(ap(t.value))return{unaryFilter:{field:Fr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fr(t.field),op:gw(t.op),value:t.value}}}(n):n instanceof Pt?function(t){let r=t.getFilters().map(i=>Vm(i));return r.length===1?r[0]:{compositeFilter:{op:_w(t.op),filters:r}}}(n):ee(54877,{filter:n})}function yw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Lm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ls=class n{constructor(e,t,r,i,s=re.min(),a=re.min(),u=je.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var rl=class{constructor(e){this.gt=e}};function vw(n){let e=fw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ju(e,e.limit,"L"):e}var ea=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ge(e.integerValue));else if("doubleValue"in e){let r=ge(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),ss(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=jt(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(zt(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?lm(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):um(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):ee(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let a=zr,u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(ge(u)),this.xt(a,t),this.Dt(s[a],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),Z.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};ea.Ut=new ea;var il=class{constructor(){this.Dn=new sl}addToCollectionParentIndex(e,t){return this.Dn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(Hn.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(Hn.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}},sl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new xe(ye.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(ye.comparator)).toArray()}};var hS=new Uint8Array(0);var wp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mm=41943040,tt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};tt.DEFAULT_COLLECTION_PERCENTILE=10,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tt.DEFAULT=new tt(Mm,tt.DEFAULT_COLLECTION_PERCENTILE,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tt.DISABLED=new tt(-1,0,0);var hs=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var Tp="LruGarbageCollector",Iw=1048576;function bp([n,e],[t,r]){let i=se(n,t);return i===0?se(e,r):i}var ol=class{constructor(e){this.Tr=e,this.buffer=new xe(bp),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();bp(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},al=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){G(Tp,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){ii(t)?G(Tp,"Ignoring IndexedDB error during garbage collection: ",t):yield ri(t)}yield this.Rr(3e5)}))}},cl=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return B.resolve(nh.ue);let r=new ol(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(G("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(wp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(G("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wp):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,a,u,l,d,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(G("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(r=w,u=Date.now(),this.removeTargets(e,r,t))).next(w=>(s=w,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(d=Date.now(),Lr()<=oe.DEBUG&&G("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(l-u)+`ms
	Removed ${w} documents in `+(d-l)+`ms
Total Duration: ${d-m}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:w})))}};function Ew(n,e){return new cl(n,e)}var ul=class{constructor(){this.changes=new Wt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ll=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var hl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ns(r.mutation,i,Tt.empty(),Ae.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ae()){let i=$n();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Xi();return s.forEach((u,l)=>{a=a.insert(u,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=$n();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ae()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=Gt(),a=ts(),u=function(){return ts()}();return t.forEach((l,d)=>{let m=r.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof Kt)?s=s.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),ns(m.mutation,d,m.mutation.getFieldMask(),Ae.now())):a.set(d.key,Tt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,m)=>a.set(d,m)),t.forEach((d,m)=>{var w;return u.set(d,new ll(m,(w=a.get(d))!==null&&w!==void 0?w:null))}),u))}recalculateAndSaveOverlays(e,t){let r=ts(),i=new Ee((a,u)=>a-u),s=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let m=r.get(l)||Tt.empty();m=u.applyToLocalView(d,m),r.set(l,m);let w=(i.get(u.batchId)||ae()).add(l);i=i.insert(u.batchId,w)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let l=u.getNext(),d=l.key,m=l.value,w=Em();m.forEach(y=>{if(!s.has(y)){let N=Rm(t.get(y),r.get(y));N!==null&&w.set(y,N),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,w))}return B.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return Z.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):BE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):B.resolve($n()),u=is,l=s;return a.next(d=>B.forEach(d,(m,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),s.get(m)?B.resolve():this.remoteDocumentCache.getEntry(e,m).next(y=>{l=l.insert(m,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,ae())).next(m=>({batchId:u,changes:Im(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Z(t)).next(r=>{let i=Xi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Xi();return this.indexManager.getCollectionParents(e,s).next(u=>B.forEach(u,l=>{let d=function(w,y){return new Qr(y,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(m=>{m.forEach((w,y)=>{a=a.insert(w,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let m=d.getKey();a.get(m)===null&&(a=a.insert(m,ft.newInvalidDocument(m)))});let u=Xi();return a.forEach((l,d)=>{let m=s.get(l);m!==void 0&&ns(m.mutation,d,Tt.empty(),Ae.now()),wa(t,d)&&(u=u.insert(l,d))}),u})}};var dl=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return B.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(i){return{id:i.id,version:i.version,createTime:St(i.createTime)}}(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(i){return{name:i.name,query:vw(i.bundledQuery),readTime:St(i.readTime)}}(t)),B.resolve()}};var fl=class{constructor(){this.overlays=new Ee(Z.comparator),this.kr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){let r=$n();return B.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),B.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){let i=$n(),s=t.length+1,a=new Z(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let l=u.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return B.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ee((d,m)=>d-m),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let m=s.get(d.largestBatchId);m===null&&(m=$n(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}let u=$n(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,m)=>u.set(d,m)),!(u.size()>=i)););return B.resolve(u)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Hu(t,r));let s=this.kr.get(t);s===void 0&&(s=ae(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var pl=class{constructor(){this.sessionToken=je.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}};var ds=class{constructor(){this.qr=new xe(Te.Qr),this.$r=new xe(Te.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Te(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Te(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new Z(new ye([])),r=new Te(t,e),i=new Te(t,e+1),s=[];return this.$r.forEachInRange([r,i],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new Z(new ye([])),r=new Te(t,e),i=new Te(t,e+1),s=ae();return this.$r.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new Te(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Te=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Z.comparator(e.key,t.key)||se(e.Hr,t.Hr)}static Ur(e,t){return se(e.Hr,t.Hr)||Z.comparator(e.key,t.key)}};var ml=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new xe(Te.Qr)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Gu(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.Yr=this.Yr.add(new Te(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return B.resolve(a)}lookupMutationBatch(e,t){return B.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return B.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?rh:this.er-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Te(t,0),i=new Te(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],a=>{let u=this.Zr(a.Hr);s.push(u)}),B.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(se);return t.forEach(i=>{let s=new Te(i,0),a=new Te(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],u=>{r=r.add(u.Hr)})}),B.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;Z.isDocumentKey(s)||(s=s.child(""));let a=new Te(new Z(s),0),u=new xe(se);return this.Yr.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(l.Hr)),!0)},a),B.resolve(this.ei(u))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){de(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return B.forEach(t.mutations,i=>{let s=new Te(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Te(t,0),i=this.Yr.firstAfterOrEqual(r);return B.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var gl=class{constructor(e){this.ni=e,this.docs=function(){return new Ee(Z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(t))}getEntries(e,t){let r=Gt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ft.newInvalidDocument(i))}),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Gt(),a=t.path,u=new Z(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(u);for(;l.hasNext();){let{key:d,value:{document:m}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||IE(vE(m),r)<=0||(i.has(m.key)||wa(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return B.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ee(9500)}ri(e,t){return B.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new _l(this)}getSize(e){return B.resolve(this.size)}},_l=class extends ul{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),B.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var yl=class{constructor(e){this.persistence=e,this.ii=new Wt(t=>ch(t),uh),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.si=0,this.oi=new ds,this.targetCount=0,this._i=hs.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),B.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new hs(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.hr(t),B.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),B.waitFor(s).next(()=>i)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),B.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),B.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),B.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this.oi.containsKey(t))}};var ta=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new nh(0),this.ci=!1,this.ci=!0,this.li=new pl,this.referenceDelegate=e(this),this.hi=new yl(this),this.indexManager=new il,this.remoteDocumentCache=function(i){return new gl(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new rl(t),this.Ti=new dl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new ml(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){G("MemoryPersistence","Starting transaction:",e);let i=new vl(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return B.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},vl=class extends Cu{constructor(e){super(),this.currentSequenceNumber=e}},Il=class n{constructor(e){this.persistence=e,this.Ai=new ds,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw ee(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.mi,r=>{let i=Z.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,re.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return B.or([()=>B.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},na=class n{constructor(e,t){this.persistence=e,this.gi=new Wt(r=>bE(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Ew(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return B.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?B.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,a=>this.Sr(e,a,t).next(u=>{u||(r++,s.removeEntry(a,re.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),B.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Fo(e.data.value)),t}Sr(e,t,r){return B.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return B.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var El=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=ae(),i=ae();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var wl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Tl=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return wd()?8:wE(Ne())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new wl;return this.ws(e,t,a).next(u=>{if(s.result=u,this.Rs)return this.Ss(e,t,a,u.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Lr()<=oe.DEBUG&&G("QueryEngine","SDK will not create cache indexes for query:",Mr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),B.resolve()):(Lr()<=oe.DEBUG&&G("QueryEngine","Query:",Mr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Lr()<=oe.DEBUG&&G("QueryEngine","The SDK decides to create cache indexes for query:",Mr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,At(t))):B.resolve())}ps(e,t){if(dp(t))return B.resolve(null);let r=At(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ju(t,null,"F"),r=At(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=ae(...s);return this.gs.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.bs(t,u);return this.Ds(t,d,a,l.readTime)?this.ps(e,ju(t,null,"F")):this.vs(e,d,t,l)}))})))}ys(e,t,r,i){return dp(t)||i.isEqual(re.min())?B.resolve(null):this.gs.getDocuments(e,r).next(s=>{let a=this.bs(t,s);return this.Ds(t,a,r,i)?B.resolve(null):(Lr()<=oe.DEBUG&&G("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mr(t)),this.vs(e,a,t,yE(i,is)).next(u=>u))})}bs(e,t){let r=new xe(ym(e));return t.forEach((i,s)=>{wa(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return Lr()<=oe.DEBUG&&G("QueryEngine","Using full collection scan to execute query:",Mr(t)),this.gs.getDocumentsMatchingQuery(e,t,Hn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var dh="LocalStore",ww=3e8,bl=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Ee(se),this.Ms=new Wt(s=>ch(s),uh),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hl(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function Tw(n,e,t,r){return new bl(n,e,t,r)}function Fm(n,e){return v(this,null,function*(){let t=ne(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],l=ae();for(let d of i){a.push(d.batchId);for(let m of d.mutations)l=l.add(m.key)}for(let d of s){u.push(d.batchId);for(let m of d.mutations)l=l.add(m.key)}return t.localDocuments.getDocuments(r,l).next(d=>({Bs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function bw(n,e){let t=ne(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return function(u,l,d,m){let w=d.batch,y=w.keys(),N=B.resolve();return y.forEach(L=>{N=N.next(()=>m.getEntry(l,L)).next(z=>{let $=d.docVersions.get(L);de($!==null,48541),z.version.compareTo($)<0&&(w.applyToRemoteDocument(z,d),z.isValidDocument()&&(z.setReadTime(d.commitVersion),m.addEntry(z)))})}),N.next(()=>u.mutationQueue.removeMutationBatch(l,w))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let l=ae();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(l=l.add(u.batch.mutations[d].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Um(n){let e=ne(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function Aw(n,e){let t=ne(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let u=[];e.targetChanges.forEach((m,w)=>{let y=i.get(w);if(!y)return;u.push(t.hi.removeMatchingKeys(s,m.removedDocuments,w).next(()=>t.hi.addMatchingKeys(s,m.addedDocuments,w)));let N=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(w)!==null?N=N.withResumeToken(je.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):m.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(m.resumeToken,r)),i=i.insert(w,N),function(z,$,Q){return z.resumeToken.approximateByteSize()===0||$.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=ww?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0}(y,N,m)&&u.push(t.hi.updateTargetData(s,N))});let l=Gt(),d=ae();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),u.push(Sw(s,a,e.documentUpdates).next(m=>{l=m.Ls,d=m.ks})),!r.isEqual(re.min())){let m=t.hi.getLastRemoteSnapshotVersion(s).next(w=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(m)}return B.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.Fs=i,s))}function Sw(n,e,t){let r=ae(),i=ae();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Gt();return t.forEach((u,l)=>{let d=s.get(u);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),l.isNoDocument()&&l.version.isEqual(re.min())?(e.removeEntry(u,l.readTime),a=a.insert(u,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(u,l)):G(dh,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",l.version)}),{Ls:a,ks:i}})}function Rw(n,e){let t=ne(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=rh),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Pw(n,e){let t=ne(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,B.resolve(i)):t.hi.allocateTargetId(r).next(a=>(i=new ls(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function Al(n,e,t){return v(this,null,function*(){let r=ne(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!ii(a))throw a;G(dh,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function Ap(n,e,t){let r=ne(n),i=re.min(),s=ae();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,d,m){let w=ne(l),y=w.Ms.get(m);return y!==void 0?B.resolve(w.Fs.get(y)):w.hi.getTargetData(d,m)}(r,a,At(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,u.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,e,t?i:re.min(),t?s:ae())).next(u=>(Cw(r,$E(e),u),{documents:u,qs:s})))}function Cw(n,e,t){let r=n.xs.get(e)||re.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var ra=class{constructor(){this.activeTargetIds=HE()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Sl=class{constructor(){this.Fo=new ra,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new ra,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Rl=class{xo(e){}shutdown(){}};var Sp="ConnectivityMonitor",ia=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){G(Sp,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){G(Sp,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Mo=null;function Pl(){return Mo===null?Mo=function(){return 268435456+Math.round(2147483648*Math.random())}():Mo++,"0x"+Mo.toString(16)}var yu="RestConnection",Dw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Cl=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Go?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let a=Pl(),u=this.Go(e,t.toUriEncodedString());G(yu,`Sending RPC '${e}' ${a}:`,u,r);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);let{host:d}=new URL(u),m=tn(d);return this.jo(e,u,l,r,m).then(w=>(G(yu,`Received RPC '${e}' ${a}: `,w),w),w=>{throw gn(yu,`RPC '${e}' ${a} failed with error: `,w,"url: ",u,"request:",r),w})}Jo(e,t,r,i,s,a){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ni}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=Dw[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var Dl=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var $e="WebChannelConnection",kl=class extends Cl{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let a=Pl();return new Promise((u,l)=>{let d=new du;d.setWithCredentials(!0),d.listenOnce(fu.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ji.NO_ERROR:let w=d.getResponseJson();G($e,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(w)),u(w);break;case Ji.TIMEOUT:G($e,`RPC '${e}' ${a} timed out`),l(new H(V.DEADLINE_EXCEEDED,"Request time out"));break;case Ji.HTTP_ERROR:let y=d.getStatus();if(G($e,`RPC '${e}' ${a} failed with status:`,y,"response text:",d.getResponseText()),y>0){let N=d.getResponseJson();Array.isArray(N)&&(N=N[0]);let L=N?.error;if(L&&L.status&&L.message){let z=function(Q){let X=Q.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(X)>=0?X:V.UNKNOWN}(L.status);l(new H(z,L.message))}else l(new H(V.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new H(V.UNAVAILABLE,"Connection failed."));break;default:ee(9055,{c_:e,streamId:a,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{G($e,`RPC '${e}' ${a} completed.`)}});let m=JSON.stringify(i);G($e,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",m,r,15)})}P_(e,t,r){let i=Pl(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=gu(),u=mu(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let m=s.join("");G($e,`Creating RPC '${e}' stream ${i}: ${m}`,l);let w=a.createWebChannel(m,l);this.T_(w);let y=!1,N=!1,L=new Dl({Ho:$=>{N?G($e,`Not sending because RPC '${e}' stream ${i} is closed:`,$):(y||(G($e,`Opening RPC '${e}' stream ${i} transport.`),w.open(),y=!0),G($e,`RPC '${e}' stream ${i} sending:`,$),w.send($))},Yo:()=>w.close()}),z=($,Q,X)=>{$.listen(Q,Y=>{try{X(Y)}catch(he){setTimeout(()=>{throw he},0)}})};return z(w,Vr.EventType.OPEN,()=>{N||(G($e,`RPC '${e}' stream ${i} transport opened.`),L.s_())}),z(w,Vr.EventType.CLOSE,()=>{N||(N=!0,G($e,`RPC '${e}' stream ${i} transport closed`),L.__(),this.I_(w))}),z(w,Vr.EventType.ERROR,$=>{N||(N=!0,gn($e,`RPC '${e}' stream ${i} transport errored. Name:`,$.name,"Message:",$.message),L.__(new H(V.UNAVAILABLE,"The operation could not be completed")))}),z(w,Vr.EventType.MESSAGE,$=>{var Q;if(!N){let X=$.data[0];de(!!X,16349);let Y=X,he=Y?.error||((Q=Y[0])===null||Q===void 0?void 0:Q.error);if(he){G($e,`RPC '${e}' stream ${i} received error:`,he);let _e=he.status,F=function(I){let A=we[I];if(A!==void 0)return Cm(A)}(_e),b=he.message;F===void 0&&(F=V.INTERNAL,b="Unknown error status: "+_e+" with message "+he.message),N=!0,L.__(new H(F,b)),w.close()}else G($e,`RPC '${e}' stream ${i} received:`,X),L.a_(X)}}),z(u,pu.STAT_EVENT,$=>{$.stat===xo.PROXY?G($e,`RPC '${e}' stream ${i} detected buffering proxy`):$.stat===xo.NOPROXY&&G($e,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{L.o_()},0),L}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function vu(){return typeof document<"u"?document:null}function Ta(n){return new Xu(n,!0)}var sa=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&G("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var Rp="PersistentStream",oa=class{constructor(e,t,r,i,s,a,u,l){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new sa(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return v(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return v(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return v(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===V.RESOURCE_EXHAUSTED?($t(t.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new H(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>v(this,null,function*(){this.state=0,this.start()}))}G_(e){return G(Rp,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(G(Rp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Nl=class extends oa{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=cw(this.serializer,e),r=function(s){if(!("targetChange"in s))return re.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?re.min():a.readTime?St(a.readTime):re.min()}(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=nl(this.serializer),t.addTarget=function(s,a){let u,l=a.target;if(u=$u(l)?{documents:hw(s,l)}:{query:dw(s,l).Vt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=Dm(s,a.resumeToken);let d=Zu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(re.min())>0){u.readTime=Zo(s,a.snapshotVersion.toTimestamp());let d=Zu(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=pw(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=nl(this.serializer),t.removeTarget=e,this.k_(t)}},Ol=class extends oa{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return de(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,de(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){de(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=lw(e.writeResults,e.commitTime),r=St(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=nl(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>uw(this.serializer,r))};this.k_(t)}};var xl=class{},Vl=class extends xl{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(e,el(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new H(V.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Jo(e,el(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new H(V.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},Ll=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?($t(t),this._a=!1):G("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Xn="RemoteStore",Ml=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{r.enqueueAndForget(()=>v(this,null,function*(){er(this)&&(G(Xn,"Restarting streams for network reachability change."),yield function(l){return v(this,null,function*(){let d=ne(l);d.Ia.add(4),yield vs(d),d.Aa.set("Unknown"),d.Ia.delete(4),yield ba(d)})}(this))}))}),this.Aa=new Ll(r,i)}};function ba(n){return v(this,null,function*(){if(er(n))for(let e of n.da)yield e(!0)})}function vs(n){return v(this,null,function*(){for(let e of n.da)yield e(!1)})}function Bm(n,e){let t=ne(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),gh(t)?mh(t):si(t).x_()&&ph(t,e))}function fh(n,e){let t=ne(n),r=si(t);t.Ta.delete(e),r.x_()&&qm(t,e),t.Ta.size===0&&(r.x_()?r.B_():er(t)&&t.Aa.set("Unknown"))}function ph(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(re.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}si(n).H_(e)}function qm(n,e){n.Ra.$e(e),si(n).Y_(e)}function mh(n){n.Ra=new Ju({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),si(n).start(),n.Aa.aa()}function gh(n){return er(n)&&!si(n).M_()&&n.Ta.size>0}function er(n){return ne(n).Ia.size===0}function $m(n){n.Ra=void 0}function kw(n){return v(this,null,function*(){n.Aa.set("Online")})}function Nw(n){return v(this,null,function*(){n.Ta.forEach((e,t)=>{ph(n,e)})})}function Ow(n,e){return v(this,null,function*(){$m(n),gh(n)?(n.Aa.la(e),mh(n)):n.Aa.set("Unknown")})}function xw(n,e,t){return v(this,null,function*(){if(n.Aa.set("Online"),e instanceof Jo&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i.Ta.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.Ta.delete(u),i.Ra.removeTarget(u))})}(n,e)}catch(r){G(Xn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield aa(n,r)}else if(e instanceof qr?n.Ra.Ye(e):e instanceof Yo?n.Ra.it(e):n.Ra.et(e),!t.isEqual(re.min()))try{let r=yield Um(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.Ra.Pt(a);return u.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let m=s.Ta.get(d);m&&s.Ta.set(d,m.withResumeToken(l.resumeToken,a))}}),u.targetMismatches.forEach((l,d)=>{let m=s.Ta.get(l);if(!m)return;s.Ta.set(l,m.withResumeToken(je.EMPTY_BYTE_STRING,m.snapshotVersion)),qm(s,l);let w=new ls(m.target,l,d,m.sequenceNumber);ph(s,w)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){G(Xn,"Failed to raise snapshot:",r),yield aa(n,r)}})}function aa(n,e,t){return v(this,null,function*(){if(!ii(e))throw e;n.Ia.add(1),yield vs(n),n.Aa.set("Offline"),t||(t=()=>Um(n.localStore)),n.asyncQueue.enqueueRetryable(()=>v(null,null,function*(){G(Xn,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield ba(n)}))})}function jm(n,e){return e().catch(t=>aa(n,t,e))}function Aa(n){return v(this,null,function*(){let e=ne(n),t=yn(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:rh;for(;Vw(e);)try{let i=yield Rw(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,Lw(e,i)}catch(i){yield aa(e,i)}zm(e)&&Wm(e)})}function Vw(n){return er(n)&&n.Pa.length<10}function Lw(n,e){n.Pa.push(e);let t=yn(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function zm(n){return er(n)&&!yn(n).M_()&&n.Pa.length>0}function Wm(n){yn(n).start()}function Mw(n){return v(this,null,function*(){yn(n).na()})}function Fw(n){return v(this,null,function*(){let e=yn(n);for(let t of n.Pa)e.X_(t.mutations)})}function Uw(n,e,t){return v(this,null,function*(){let r=n.Pa.shift(),i=Ku.from(r,e,t);yield jm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Aa(n)})}function Bw(n,e){return v(this,null,function*(){e&&yn(n).Z_&&(yield function(r,i){return v(this,null,function*(){if(function(a){return tw(a)&&a!==V.ABORTED}(i.code)){let s=r.Pa.shift();yn(r).N_(),yield jm(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Aa(r)}})}(n,e)),zm(n)&&Wm(n)})}function Pp(n,e){return v(this,null,function*(){let t=ne(n);t.asyncQueue.verifyOperationInProgress(),G(Xn,"RemoteStore received new credentials");let r=er(t);t.Ia.add(3),yield vs(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield ba(t)})}function qw(n,e){return v(this,null,function*(){let t=ne(n);e?(t.Ia.delete(2),yield ba(t)):e||(t.Ia.add(2),yield vs(t),t.Aa.set("Unknown"))})}function si(n){return n.Va||(n.Va=function(t,r,i){let s=ne(t);return s.ia(),new Nl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Zo:kw.bind(null,n),e_:Nw.bind(null,n),n_:Ow.bind(null,n),J_:xw.bind(null,n)}),n.da.push(e=>v(null,null,function*(){e?(n.Va.N_(),gh(n)?mh(n):n.Aa.set("Unknown")):(yield n.Va.stop(),$m(n))}))),n.Va}function yn(n){return n.ma||(n.ma=function(t,r,i){let s=ne(t);return s.ia(),new Ol(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:Mw.bind(null,n),n_:Bw.bind(null,n),ea:Fw.bind(null,n),ta:Uw.bind(null,n)}),n.da.push(e=>v(null,null,function*(){e?(n.ma.N_(),yield Aa(n)):(yield n.ma.stop(),n.Pa.length>0&&(G(Xn,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var Fl=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function _h(n,e){if($t("AsyncQueue",`${e}: ${n}`),ii(n))return new H(V.UNAVAILABLE,`${e}: ${n}`);throw n}var ca=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Z.comparator(t.key,r.key):(t,r)=>Z.comparator(t.key,r.key),this.keyedMap=Xi(),this.sortedSet=new Ee(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var ua=class{constructor(){this.fa=new Ee(Z.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):ee(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},ei=class n{constructor(e,t,r,i,s,a,u,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,ca.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ea(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Ul=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},Bl=class{constructor(){this.queries=Cp(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=ne(t),s=i.queries;i.queries=Cp(),s.forEach((a,u)=>{for(let l of u.wa)l.onError(r)})})(this,new H(V.ABORTED,"Firestore shutting down"))}};function Cp(){return new Wt(n=>_m(n),Ea)}function yh(n,e){return v(this,null,function*(){let t=ne(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new Ul,r=e.ba()?0:1);try{switch(r){case 0:s.ya=yield t.onListen(i,!0);break;case 1:s.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=_h(a,`Initialization of query '${Mr(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Ih(t)})}function vh(n,e){return v(this,null,function*(){let t=ne(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.wa.indexOf(e);a>=0&&(s.wa.splice(a,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function $w(n,e){let t=ne(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.wa)u.Ca(i)&&(r=!0);a.ya=i}}r&&Ih(t)}function jw(n,e,t){let r=ne(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function Ih(n){n.Da.forEach(e=>{e.next()})}var ql,Dp;(Dp=ql||(ql={})).Fa="default",Dp.Cache="cache";var fs=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ei(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ei.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ql.Cache}};var la=class{constructor(e){this.key=e}},ha=class{constructor(e){this.key=e}},$l=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ae(),this.mutatedKeys=ae(),this.Xa=ym(e),this.eu=new ca(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new ua,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,w)=>{let y=i.get(m),N=wa(this.query,w)?w:null,L=!!y&&this.mutatedKeys.has(y.key),z=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations),$=!1;y&&N?y.data.isEqual(N.data)?L!==z&&(r.track({type:3,doc:N}),$=!0):this.iu(y,N)||(r.track({type:2,doc:N}),$=!0,(l&&this.Xa(N,l)>0||d&&this.Xa(N,d)<0)&&(u=!0)):!y&&N?(r.track({type:0,doc:N}),$=!0):y&&!N&&(r.track({type:1,doc:y}),$=!0,(l||d)&&(u=!0)),$&&(N?(a=a.add(N),s=z?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{eu:a,ru:r,Ds:u,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let a=e.ru.pa();a.sort((m,w)=>function(N,L){let z=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee(20277,{At:$})}};return z(N)-z(L)}(m.type,w.type)||this.Xa(m.doc,w.doc)),this.su(r),i=i!=null&&i;let u=t&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,d=l!==this.Ya;return this.Ya=l,a.length!==0||d?{snapshot:new ei(this.query,e.eu,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new ua,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=ae(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new ha(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new la(r))}),t}uu(e){this.Ha=e.qs,this.Za=ae();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ei.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Eh="SyncEngine",jl=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},zl=class{constructor(e){this.key=e,this.lu=!1}},Wl=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new Wt(u=>_m(u),Ea),this.Tu=new Map,this.Iu=new Set,this.du=new Ee(Z.comparator),this.Eu=new Map,this.Au=new ds,this.Ru={},this.Vu=new Map,this.mu=hs.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function zw(n,e,t=!0){return v(this,null,function*(){let r=Jm(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=yield Gm(r,e,t,!0),i})}function Ww(n,e){return v(this,null,function*(){let t=Jm(n);yield Gm(t,e,!0,!1)})}function Gm(n,e,t,r){return v(this,null,function*(){let i=yield Pw(n.localStore,At(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield Gw(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Bm(n.remoteStore,i),u})}function Gw(n,e,t,r,i){return v(this,null,function*(){n.gu=(w,y,N)=>function(z,$,Q,X){return v(this,null,function*(){let Y=$.view.nu(Q);Y.Ds&&(Y=yield Ap(z.localStore,$.query,!1).then(({documents:b})=>$.view.nu(b,Y)));let he=X&&X.targetChanges.get($.targetId),_e=X&&X.targetMismatches.get($.targetId)!=null,F=$.view.applyChanges(Y,z.isPrimaryClient,he,_e);return Np(z,$.targetId,F._u),F.snapshot})}(n,w,y,N);let s=yield Ap(n.localStore,e,!0),a=new $l(e,s.qs),u=a.nu(s.documents),l=us.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,l);Np(n,t,d._u);let m=new jl(e,t,a);return n.Pu.set(e,m),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot})}function Kw(n,e,t){return v(this,null,function*(){let r=ne(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(a=>!Ea(a,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Al(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&fh(r.remoteStore,i.targetId),Gl(r,i.targetId)}).catch(ri))):(Gl(r,i.targetId),yield Al(r.localStore,i.targetId,!0))})}function Hw(n,e){return v(this,null,function*(){let t=ne(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),fh(t.remoteStore,r.targetId))})}function Qw(n,e,t){return v(this,null,function*(){let r=nT(n);try{let i=yield function(a,u){let l=ne(a),d=Ae.now(),m=u.reduce((N,L)=>N.add(L.key),ae()),w,y;return l.persistence.runTransaction("Locally write mutations","readwrite",N=>{let L=Gt(),z=ae();return l.Os.getEntries(N,m).next($=>{L=$,L.forEach((Q,X)=>{X.isValidDocument()||(z=z.add(Q))})}).next(()=>l.localDocuments.getOverlayedDocuments(N,L)).next($=>{w=$;let Q=[];for(let X of u){let Y=ew(X,w.get(X.key).overlayedDocument);Y!=null&&Q.push(new Kt(X.key,Y,hm(Y.value.mapValue),qt.exists(!0)))}return l.mutationQueue.addMutationBatch(N,d,Q,u)}).next($=>{y=$;let Q=$.applyToLocalDocumentSet(w,z);return l.documentOverlayCache.saveOverlays(N,$.batchId,Q)})}).then(()=>({batchId:y.batchId,changes:Im(w)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,l){let d=a.Ru[a.currentUser.toKey()];d||(d=new Ee(se)),d=d.insert(u,l),a.Ru[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Is(r,i.changes),yield Aa(r.remoteStore)}catch(i){let s=_h(i,"Failed to persist write");t.reject(s)}})}function Km(n,e){return v(this,null,function*(){let t=ne(n);try{let r=yield Aw(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Eu.get(s);a&&(de(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?de(a.lu,14607):i.removedDocuments.size>0&&(de(a.lu,42227),a.lu=!1))}),yield Is(t,r,e)}catch(r){yield ri(r)}})}function kp(n,e,t){let r=ne(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,a)=>{let u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let l=ne(a);l.onlineState=u;let d=!1;l.queries.forEach((m,w)=>{for(let y of w.wa)y.va(u)&&(d=!0)}),d&&Ih(l)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Yw(n,e,t){return v(this,null,function*(){let r=ne(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let a=new Ee(Z.comparator);a=a.insert(s,ft.newNoDocument(s,re.min()));let u=ae().add(s),l=new Qo(re.min(),new Map,new Ee(se),a,u);yield Km(r,l),r.du=r.du.remove(s),r.Eu.delete(e),wh(r)}else yield Al(r.localStore,e,!1).then(()=>Gl(r,e,t)).catch(ri)})}function Jw(n,e){return v(this,null,function*(){let t=ne(n),r=e.batch.batchId;try{let i=yield bw(t.localStore,e);Qm(t,r,null),Hm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Is(t,i)}catch(i){yield ri(i)}})}function Xw(n,e,t){return v(this,null,function*(){let r=ne(n);try{let i=yield function(a,u){let l=ne(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return l.mutationQueue.lookupMutationBatch(d,u).next(w=>(de(w!==null,37113),m=w.keys(),l.mutationQueue.removeMutationBatch(d,w))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,m,u)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>l.localDocuments.getDocuments(d,m))})}(r.localStore,e);Qm(r,e,t),Hm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Is(r,i)}catch(i){yield ri(i)}})}function Hm(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function Qm(n,e,t){let r=ne(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function Gl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||Ym(n,r)})}function Ym(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(fh(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),wh(n))}function Np(n,e,t){for(let r of t)r instanceof la?(n.Au.addReference(r.key,e),Zw(n,r)):r instanceof ha?(G(Eh,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Ym(n,r.key)):ee(19791,{yu:r})}function Zw(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(G(Eh,"New document in limbo: "+t),n.Iu.add(r),wh(n))}function wh(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new Z(ye.fromString(e)),r=n.mu.next();n.Eu.set(r,new zl(t)),n.du=n.du.insert(t,r),Bm(n.remoteStore,new ls(At(Ia(t.path)),r,"TargetPurposeLimboResolution",nh.ue))}}function Is(n,e,t){return v(this,null,function*(){let r=ne(n),i=[],s=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((u,l)=>{a.push(r.gu(l,e,t).then(d=>{var m;if((d||t)&&r.isPrimaryClient){let w=d?!d.fromCache:(m=t?.targetChanges.get(l.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(l.targetId,w?"current":"not-current")}if(d){i.push(d);let w=El.Es(l.targetId,d);s.push(w)}}))}),yield Promise.all(a),r.hu.J_(i),yield function(l,d){return v(this,null,function*(){let m=ne(l);try{yield m.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>B.forEach(d,y=>B.forEach(y.Is,N=>m.persistence.referenceDelegate.addReference(w,y.targetId,N)).next(()=>B.forEach(y.ds,N=>m.persistence.referenceDelegate.removeReference(w,y.targetId,N)))))}catch(w){if(!ii(w))throw w;G(dh,"Failed to update sequence numbers: "+w)}for(let w of d){let y=w.targetId;if(!w.fromCache){let N=m.Fs.get(y),L=N.snapshotVersion,z=N.withLastLimboFreeSnapshotVersion(L);m.Fs=m.Fs.insert(y,z)}}})}(r.localStore,s))})}function eT(n,e){return v(this,null,function*(){let t=ne(n);if(!t.currentUser.isEqual(e)){G(Eh,"User change. New user:",e.toKey());let r=yield Fm(t.localStore,e);t.currentUser=e,function(s,a){s.Vu.forEach(u=>{u.forEach(l=>{l.reject(new H(V.CANCELLED,a))})}),s.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Is(t,r.Bs)}})}function tT(n,e){let t=ne(n),r=t.Eu.get(e);if(r&&r.lu)return ae().add(r.key);{let i=ae(),s=t.Tu.get(e);if(!s)return i;for(let a of s){let u=t.Pu.get(a);i=i.unionWith(u.view.tu)}return i}}function Jm(n){let e=ne(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Km.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Yw.bind(null,e),e.hu.J_=$w.bind(null,e.eventManager),e.hu.pu=jw.bind(null,e.eventManager),e}function nT(n){let e=ne(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Jw.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Xw.bind(null,e),e}var Xm=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return v(this,null,function*(){this.serializer=Ta(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return Tw(this.persistence,new Tl,t.initialUser,this.serializer)}Du(t){return new ta(Il.Vi,this.serializer)}bu(t){return new Sl}terminate(){return v(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Kl=class extends Xm{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){de(this.persistence.referenceDelegate instanceof na,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new al(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?tt.withCacheSize(this.cacheSizeBytes):tt.DEFAULT;return new ta(r=>na.Vi(r,t),this.serializer)}};var rT=(()=>{class n{initialize(t,r){return v(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kp(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=eT.bind(null,this.syncEngine),yield qw(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Bl}()}createDatastore(t){let r=Ta(t.databaseInfo.databaseId),i=function(a){return new kl(a)}(t.databaseInfo);return function(a,u,l,d){return new Vl(a,u,l,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,u,l){return new Ml(i,s,a,u,l)}(this.localStore,this.datastore,t.asyncQueue,r=>kp(this.syncEngine,r,0),function(){return ia.C()?new ia:new Rl}())}createSyncEngine(t,r){return function(s,a,u,l,d,m,w){let y=new Wl(s,a,u,l,d,m);return w&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return v(this,null,function*(){var t,r;yield function(s){return v(this,null,function*(){let a=ne(s);G(Xn,"RemoteStore shutting down."),a.Ia.add(5),yield vs(a),a.Ea.shutdown(),a.Aa.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var ps=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var vn="FirestoreClient",Hl=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Oe.UNAUTHENTICATED,this.clientId=rs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>v(this,null,function*(){G(vn,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(G(vn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=_h(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Iu(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),G(vn,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>v(null,null,function*(){r.isEqual(i)||(yield Fm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{gn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{G("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{gn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function Op(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield iT(n);G(vn,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Pp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Pp(e.remoteStore,i)),n._onlineComponents=e})}function iT(n){return v(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){G(vn,"Using user provided OfflineComponentProvider");try{yield Iu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===V.FAILED_PRECONDITION||i.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;gn("Error using user provided cache. Falling back to memory cache: "+t),yield Iu(n,new Xm)}}else G(vn,"Using default OfflineComponentProvider"),yield Iu(n,new Kl(void 0));return n._offlineComponents})}function Zm(n){return v(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(G(vn,"Using user provided OnlineComponentProvider"),yield Op(n,n._uninitializedComponentsProvider._online)):(G(vn,"Using default OnlineComponentProvider"),yield Op(n,new rT))),n._onlineComponents})}function sT(n){return Zm(n).then(e=>e.syncEngine)}function da(n){return v(this,null,function*(){let e=yield Zm(n),t=e.eventManager;return t.onListen=zw.bind(null,e.syncEngine),t.onUnlisten=Kw.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Ww.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Hw.bind(null,e.syncEngine),t})}function oT(n,e,t={}){let r=new dt;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(s,a,u,l,d){let m=new ps({next:y=>{m.Ou(),a.enqueueAndForget(()=>vh(s,w));let N=y.docs.has(u);!N&&y.fromCache?d.reject(new H(V.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&y.fromCache&&l&&l.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),w=new fs(Ia(u.path),m,{includeMetadataChanges:!0,ka:!0});return yh(s,w)}(yield da(n),n.asyncQueue,e,t,r)})),r.promise}function aT(n,e,t={}){let r=new dt;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(s,a,u,l,d){let m=new ps({next:y=>{m.Ou(),a.enqueueAndForget(()=>vh(s,w)),y.fromCache&&l.source==="server"?d.reject(new H(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),w=new fs(u,m,{includeMetadataChanges:!0,ka:!0});return yh(s,w)}(yield da(n),n.asyncQueue,e,t,r)})),r.promise}function eg(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var xp=new Map;var tg="firestore.googleapis.com",Vp=!0,fa=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new H(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tg,this.ssl=Vp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Vp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Iw)throw new H(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_E("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eg((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new H(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ti=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fa({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fa(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Eu;switch(r.type){case"firstParty":return new Au(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return v(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=xp.get(t);r&&(G("ComponentProvider","Removing Datastore"),xp.delete(t),r.terminate())}(this),Promise.resolve()}};function ng(n,e,t,r={}){var i;n=nt(n,ti);let s=tn(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;s&&(ro(`https://${l}`),io("Firestore",!0)),a.host!==tg&&a.host!==l&&gn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:r});if(!vt(d,u)&&(n._setSettings(d),r.mockUserToken)){let m,w;if(typeof r.mockUserToken=="string")m=r.mockUserToken,w=Oe.MOCK_USER;else{m=gd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new H(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Oe(y)}n._authCredentials=new wu(new qo(m,w))}}var ms=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Me=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ys(t,n._jsonSchema))return new n(e,r||null,new Z(ye.fromString(t.referencePath)))}};Me._jsonSchemaVersion="firestore/documentReference/1.0",Me._jsonSchema={type:be("string",Me._jsonSchemaVersion),referencePath:be("string")};var dn=class n extends ms{constructor(e,t,r){super(e,t,Ia(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new Z(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Es(n,e,...t){if(n=Be(n),qp("collection","path",e),n instanceof ti){let r=ye.fromString(e,...t);return ep(r),new dn(n,null,r)}{if(!(n instanceof Me||n instanceof dn))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return ep(r),new dn(n.firestore,null,r)}}function ws(n,e,...t){if(n=Be(n),arguments.length===1&&(e=rs.newId()),qp("doc","path",e),n instanceof ti){let r=ye.fromString(e,...t);return Zf(r),new Me(n,null,new Z(r))}{if(!(n instanceof Me||n instanceof dn))throw new H(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return Zf(r),new Me(n.firestore,n instanceof dn?n.converter:null,new Z(r))}}var Lp="AsyncQueue",pa=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new sa(this,"async_queue_retry"),this.oc=()=>{let r=vu();r&&G(Lp,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=vu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=vu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new dt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return v(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!ii(e))throw e;G(Lp,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,$t("INTERNAL UNHANDLED ERROR: ",Mp(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=Fl.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&ee(47125,{hc:Mp(this.tc)})}verifyOperationInProgress(){}Pc(){return v(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function Mp(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Fp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Ct=class extends ti{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new pa,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return v(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new pa(e),this._firestoreClient=void 0,yield e}})}};function rg(n,e){let t=typeof n=="object"?n:Vn(),r=typeof n=="string"?n:e||Go,i=Cr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=md("firestore");s&&ng(i,...s)}return i}function Sa(n){if(n._terminated)throw new H(V.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cT(n),n._firestoreClient}function cT(n){var e,t,r;let i=n._freezeSettings(),s=function(u,l,d,m){return new Du(u,l,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,eg(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Hl(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let l=u?._online.build();return{_offline:u?._offline.build(l),_online:l}}(n._componentsProvider))}var fn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(je.fromBase64String(e))}catch(t){throw new H(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ys(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};fn._jsonSchemaVersion="firestore/bytes/1.0",fn._jsonSchema={type:be("string",fn._jsonSchemaVersion),bytes:be("string")};var gs=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new H(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ma=class{constructor(e){this._methodName=e}};var pn=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new H(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new H(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(ys(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};pn._jsonSchemaVersion="firestore/geoPoint/1.0",pn._jsonSchema={type:be("string",pn._jsonSchemaVersion),latitude:be("number"),longitude:be("number")};var mn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ys(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new H(V.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};mn._jsonSchemaVersion="firestore/vectorValue/1.0",mn._jsonSchema={type:be("string",mn._jsonSchemaVersion),vectorValues:be("object")};var uT=/^__.*__$/,Ql=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Kt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jn(e,this.data,t,this.fieldTransforms)}};function ig(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee(40011,{Ec:n})}}var Yl=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return ga(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(ig(this.Ec)&&uT.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Jl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ta(e)}Dc(e,t,r,i=!1){return new Yl({Ec:e,methodName:t,bc:r,path:Qe.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function sg(n){let e=n._freezeSettings(),t=Ta(n._databaseId);return new Jl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function og(n,e,t,r,i,s={}){let a=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);lg("Data must be an object, but it was:",a,r);let u=cg(r,a),l,d;if(s.merge)l=new Tt(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let m=[];for(let w of s.mergeFields){let y=lT(e,w,t);if(!a.contains(y))throw new H(V.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);dT(m,y)||m.push(y)}l=new Tt(m),d=a.fieldTransforms.filter(w=>l.covers(w.field))}else l=null,d=a.fieldTransforms;return new Ql(new ht(u),l,d)}function ag(n,e){if(ug(n=Be(n)))return lg("Unsupported field value:",e,n),cg(n,e);if(n instanceof ma)return function(r,i){if(!ig(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let l=ag(u,i.yc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Be(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return QE(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ae.fromDate(r);return{timestampValue:Zo(i.serializer,s)}}if(r instanceof Ae){let s=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zo(i.serializer,s)}}if(r instanceof pn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof fn)return{bytesValue:Dm(i.serializer,r._byteString)};if(r instanceof Me){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof mn)return function(a,u){return{mapValue:{fields:{[sh]:{stringValue:oh},[zr]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return lh(u.serializer,d)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${th(r)}`)}(n,e)}function cg(n,e){let t={};return rm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zn(n,(r,i)=>{let s=ag(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function ug(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ae||n instanceof pn||n instanceof fn||n instanceof Me||n instanceof ma||n instanceof mn)}function lg(n,e,t){if(!ug(t)||!$p(t)){let r=th(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function lT(n,e,t){if((e=Be(e))instanceof gs)return e._internalPath;if(typeof e=="string")return hg(n,e);throw ga("Field path arguments must be of type string or ",n,!1,void 0,t)}var hT=new RegExp("[~\\*/\\[\\]]");function hg(n,e,t){if(e.search(hT)>=0)throw ga(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gs(...e.split("."))._internalPath}catch{throw ga(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ga(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new H(V.INVALID_ARGUMENT,u+n+l)}function dT(n,e){return n.some(t=>t.isEqual(e))}var _a=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Xl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(dg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Xl=class extends _a{data(){return super.data()}};function dg(n,e){return typeof e=="string"?hg(n,e):e instanceof gs?e._internalPath:e._delegate._internalPath}function fg(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new H(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zl=class{convertValue(e,t="none"){switch(_n(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ee(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Zn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[zr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ge(a.doubleValue));return new mn(s)}convertGeoPoint(e){return new pn(ge(e.latitude),ge(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=va(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(os(e));default:return null}}convertTimestamp(e){let t=jt(e);return new Ae(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ye.fromString(e);de(Lm(r),9688,{name:e});let i=new Ko(r.get(1),r.get(3)),s=new Z(r.popFirst(5));return i.isEqual(t)||$t(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function pg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var zn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Wn=class n extends _a{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new $r(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(dg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Wn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Wn._jsonSchema={type:be("string",Wn._jsonSchemaVersion),bundleSource:be("string","DocumentSnapshot"),bundleName:be("string"),bundle:be("string")};var $r=class extends Wn{data(e={}){return super.data(e)}},Gn=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new zn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $r(this._firestore,this._userDataWriter,r.key,r,new zn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new H(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let l=new $r(i._firestore,i._userDataWriter,u.doc.key,u.doc,new zn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let l=new $r(i._firestore,i._userDataWriter,u.doc.key,u.doc,new zn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,m=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),m=a.indexOf(u.doc.key)),{type:fT(u.type),doc:l,oldIndex:d,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(V.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rs.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function fT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee(61501,{type:n})}}function mg(n){n=nt(n,Me);let e=nt(n.firestore,Ct);return oT(Sa(e),n._key).then(t=>yg(e,n,t))}Gn._jsonSchemaVersion="firestore/querySnapshot/1.0",Gn._jsonSchema={type:be("string",Gn._jsonSchemaVersion),bundleSource:be("string","QuerySnapshot"),bundleName:be("string"),bundle:be("string")};var _s=class extends Zl{constructor(e){super(),this.firestore=e}convertBytes(e){return new fn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function Th(n){n=nt(n,ms);let e=nt(n.firestore,Ct),t=Sa(e),r=new _s(e);return fg(n._query),aT(t,n._query).then(i=>new Gn(e,r,n,i))}function gg(n,e,t){n=nt(n,Me);let r=nt(n.firestore,Ct),i=pg(n.converter,e,t);return bh(r,[og(sg(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,qt.none())])}function Ra(n){return bh(nt(n.firestore,Ct),[new cs(n._key,qt.none())])}function Pa(n,e){let t=nt(n.firestore,Ct),r=ws(n),i=pg(n.converter,e);return bh(t,[og(sg(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,qt.exists(!1))]).then(()=>r)}function _g(n,...e){var t,r,i;n=Be(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Fp(e[a])||(s=e[a++]);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Fp(e[a])){let w=e[a];e[a]=(t=w.next)===null||t===void 0?void 0:t.bind(w),e[a+1]=(r=w.error)===null||r===void 0?void 0:r.bind(w),e[a+2]=(i=w.complete)===null||i===void 0?void 0:i.bind(w)}let l,d,m;if(n instanceof Me)d=nt(n.firestore,Ct),m=Ia(n._key.path),l={next:w=>{e[a]&&e[a](yg(d,n,w))},error:e[a+1],complete:e[a+2]};else{let w=nt(n,ms);d=nt(w.firestore,Ct),m=w._query;let y=new _s(d);l={next:N=>{e[a]&&e[a](new Gn(d,y,w,N))},error:e[a+1],complete:e[a+2]},fg(n._query)}return function(y,N,L,z){let $=new ps(z),Q=new fs(N,$,L);return y.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return yh(yield da(y),Q)})),()=>{$.Ou(),y.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return vh(yield da(y),Q)}))}}(Sa(d),m,u,l)}function bh(n,e){return function(r,i){let s=new dt;return r.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return Qw(yield sT(r),i,s)})),s.promise}(Sa(n),e)}function yg(n,e,t){let r=t.docs.get(e._key),i=new _s(n);return new Wn(n,i,e._key,r,new zn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){ni=i})(rn),ct(new ze("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new Ct(new Tu(r.getProvider("auth-internal")),new Su(a,r.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ko(d.options.projectId,m)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Ie(Qf,Yf,e),Ie(Qf,Yf,"esm2017")})();var tr=class{constructor(e){return e}},vg="firestore",Ah=class{constructor(){return kr(vg)}};var Sh=new Zt("angularfire2.firestore-instances");function pT(n,e){let t=Mi(vg,n,e);return t&&new tr(t)}function mT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new tr(r)}}var gT={provide:Ah,deps:[[new Ze,Sh]]},_T={provide:tr,useFactory:pT,deps:[[new Ze,Sh],Vt]};function y0(n,...e){return Ie("angularfire",sn.full,"fst"),br([_T,gT,{provide:Sh,useFactory:mT(n),multi:!0,deps:[yt,en,on,Mn,[new Ze,Yi],[new Ze,Nr],...e]}])}var v0=qe(Pa,!0,2);var I0=qe(Es,!0,2);var E0=qe(Ra,!0,2);var w0=qe(ws,!0,2);var T0=qe(mg,!0);var b0=qe(rg,!0);var A0=qe(_g,!0);var S0=qe(gg,!0,2);var Ig=(()=>{let e=class e{constructor(r){this.storage=r,this._storage=null,this.init()}init(){return v(this,null,function*(){let r=yield this.storage.create();this._storage=r})}set(r,i){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.set(r,i)})}get(r){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.get(r)})}remove(r){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.remove(r)})}clear(){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.clear()})}keys(){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.keys()||[]})}length(){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.length()||0})}forEach(r){return v(this,null,function*(){return yield this.ensureStorageReady(),this._storage?.forEach(r)})}ensureStorageReady(){return v(this,null,function*(){this._storage||(yield this.init())})}};e.\u0275fac=function(i){return new(i||e)(td(Ot))},e.\u0275prov=Tr({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var L0=(()=>{let e=class e{constructor(){this.storageService=Xe(Ig),this.firestore=Xe(tr),this._user=Ar(null),this._users=Ar([]),this._isLoading=Ar(!1),this._error=Ar(null),this.USER_KEY="current_user",this.USERS_KEY="users",this.COLLECTION_NAME="usuarios",this.usersCount=Ka(()=>this._users().length),this.activeUsers=Ka(()=>this._users().filter(r=>r.role&&r.role.length>0)),this.restoreUser(),this.getUsers().catch(r=>console.warn("\u{1F504} UserService: Error inicial al cargar usuarios:",r))}get users(){return this._users.asReadonly()}get user(){return this._user.asReadonly()}get isLoading(){return this._isLoading.asReadonly()}get error(){return this._error.asReadonly()}setUser(r){return v(this,null,function*(){this._user.set(r),r?yield this.storageService.set(this.USER_KEY,r):yield this.storageService.remove(this.USER_KEY)})}getMainRole(r){return(r??this.getCurrentUser())?.role??null}getCurrentUser(){return this._user()}getUserRole(){return this._user()?.role??null}getUserEmail(){return this._user()?.email??null}getUserId(){return this._user()?.uid??null}clearUser(){return v(this,null,function*(){this._user.set(null),yield this.storageService.remove(this.USER_KEY)})}restoreUser(){return v(this,null,function*(){let r=yield this.storageService.get(this.USER_KEY);r&&this._user.set(r)})}getUsers(r=!1){return v(this,null,function*(){let i=this._users();if(i.length>0&&!r)return i;this._isLoading.set(!0),this._error.set(null);try{let s=Es(this.firestore,this.COLLECTION_NAME),u=(yield Th(s)).docs.map(l=>{let d=l.data();return this.mapFirestoreToUser(d,l.id)});return this._users.set(u),yield this.storageService.set(this.USERS_KEY,u),u}catch(s){console.warn("\u{1F504} Firestore fallback to local storage:",s);let a=(yield this.storageService.get(this.USERS_KEY))||[];return this._users.set(a),this._error.set("Modo offline: datos desde cache local"),a}finally{this._isLoading.set(!1)}})}refreshUsers(){return v(this,null,function*(){return this.getUsers(!0)})}mapFirestoreToUser(r,i){return{uid:i,nombre:r.nombre||"",email:r.email||"",emailVerified:r.emailVerified??!1,role:r.role||"",roles:r.roles||[],entrenadorId:r.entrenadorId,gimnasioId:r.gimnasioId,onboarded:r.onboarded??!1}}addUser(r){return v(this,null,function*(){this._isLoading.set(!0),this._error.set(null);let i=wr(Er({},r),{uid:r.uid||`temp_${Date.now()}`}),s=[...this._users(),i];this._users.set(s),yield this.storageService.set(this.USERS_KEY,s);try{let a=i,{uid:u}=a,l=Jh(a,["uid"]),d=yield Pa(Es(this.firestore,this.COLLECTION_NAME),l),m=wr(Er({},l),{uid:d.id}),w=s.map(y=>y.uid===i.uid?m:y);this._users.set(w),yield this.storageService.set(this.USERS_KEY,w)}catch(u){console.warn("\u{1F504} Error al guardar en Firestore, manteniendo copia local:",u),this._error.set("Usuario guardado localmente. Se sincronizar\xE1 cuando haya conexi\xF3n.")}finally{this._isLoading.set(!1)}})}removeUser(r){return v(this,null,function*(){this._isLoading.set(!0),this._error.set(null);let i=this._users().filter(s=>s.uid!==r);this._users.set(i),yield this.storageService.set(this.USERS_KEY,i);try{let s=ws(this.firestore,this.COLLECTION_NAME,r);yield Ra(s)}catch(s){console.warn("\u{1F504} Error al eliminar de Firestore, manteniendo eliminaci\xF3n local:",s),this._error.set("Usuario eliminado localmente. Se sincronizar\xE1 cuando haya conexi\xF3n.")}finally{this._isLoading.set(!1)}})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Tr({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{AT as a,Ig as b,Rb as c,Pb as d,uv as e,Qi as f,jA as g,zA as h,WA as i,GA as j,Ae as k,tr as l,y0 as m,v0 as n,I0 as o,E0 as p,w0 as q,T0 as r,b0 as s,A0 as t,S0 as u,L0 as v};
