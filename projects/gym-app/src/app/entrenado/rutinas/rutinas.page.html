<ion-header [translucent]="true" class="px-4">
  <ion-toolbar class="">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/entrenado-tabs/dashboard" text="" icon="arrow-back-outline"></ion-back-button>
    </ion-buttons>
    <ion-title class="text-center flex-1 text-base">Rutinas</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear">
        <ion-icon name="notifications-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Rutinas</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="rutinas-container">
    <!-- Sección de Rutinas por Día -->
    <div class="bg-gradient-to-br from-slate-50 to-blue-50 rounded-xl p-6 shadow-lg border border-slate-200 mx-4 my-4">
      <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center">
        <ion-icon name="calendar-outline" class="text-blue-600 mr-3"></ion-icon>
        Rutinas por Día
      </h3>

      @if (rutinasPorDia() && rutinasPorDia().length > 0) {
        <div class="overflow-hidden">
          <div class="grid grid-cols-7 gap-2 px-2">
            @for (dia of rutinasPorDia(); track dia.fecha) {
              <div class="w-full">
                <!-- Tarjeta del día con gradiente dinámico -->
                <div class="relative bg-white rounded-xl shadow-lg border-2 transition-all duration-300 hover:shadow-xl hover:scale-105 overflow-hidden
                            {{ dia.esHoy ? 'border-blue-400 shadow-blue-200' : 'border-slate-200 hover:border-slate-300' }}
                            {{ dia.rutinas.length > 0 ? 'bg-gradient-to-br from-white to-slate-50' : 'bg-gradient-to-br from-slate-50 to-slate-100' }}">
                  <!-- Encabezado del día con gradiente -->
                  <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-3 text-center relative overflow-hidden">
                    <div class="relative z-10">
                      <div class="text-sm font-bold mb-1">{{ dia.diaCorto }}</div>
                      <div class="text-xs opacity-90">{{ dia.fecha.getDate() }}</div>
                      @if (dia.esHoy) {
                        <div class="inline-flex items-center mt-1 px-2 py-0.5 text-xs font-semibold bg-yellow-400 text-yellow-900 rounded-full shadow-md">
                          <ion-icon name="today-outline"></ion-icon>
                          Hoy
                        </div>
                      }
                    </div>
                  </div>

                  <!-- Contenido de rutinas -->
                  <div class="p-3 h-[180px] flex flex-col">
                    @if (dia.rutinas.length > 0) {
                      <div class="space-y-2 flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent">
                        @for (rutina of dia.rutinas; track rutina.id) {
                          <!-- Tarjeta de rutina mejorada -->
                          <div class="group bg-gradient-to-r from-white to-slate-50 rounded-md p-2 cursor-pointer
                                      hover:from-blue-50 hover:to-indigo-50 transition-all duration-300
                                      border border-slate-200 hover:border-blue-300 hover:shadow-sm
                                      transform hover:scale-102"
                               (click)="iniciarEntrenamiento(rutina)">
                            <!-- Cabecera con nombre e icono de estado -->
                            <div class="flex items-center justify-between mb-1">
                              <p class="text-xs font-semibold text-slate-800 truncate flex-1 mr-1 group-hover:text-blue-800 transition-colors"
                                 [title]="rutina.nombre">
                                {{ rutina.nombre }}
                              </p>
                              <!-- Icono de estado mejorado -->
                              <div class="flex-shrink-0">
                                @if (rutina.completado) {
                                  <div class="w-5 h-5 bg-green-500 rounded-full flex items-center justify-center shadow-sm">
                                    <ion-icon name="checkmark-circle" class="text-white text-xs"></ion-icon>
                                  </div>
                                } @else {
                                  <div class="w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center shadow-sm">
                                    <ion-icon name="timer-outline" class="text-white text-xs"></ion-icon>
                                  </div>
                                }
                              </div>
                            </div>

                            <!-- Información básica -->
                            <div class="space-y-1">
                              @if (rutina.duracion) {
                                <div class="flex items-center text-xs text-slate-600">
                                  <ion-icon name="time-outline" class="text-xs mr-1"></ion-icon>
                                  {{ rutina.duracion }} min
                                </div>
                              }
                              @if (rutina.ejerciciosIds && rutina.ejerciciosIds.length > 0) {
                                <div class="flex items-center text-xs text-slate-600">
                                  <ion-icon name="fitness-outline" class="text-xs mr-1"></ion-icon>
                                  {{ rutina.ejerciciosIds.length }} ej.
                                </div>
                              }
                            </div>
                          </div>
                        }
                      </div>
                    } @else {
                      <!-- Estado vacío mejorado -->
                      <div class="flex flex-col items-center justify-center h-full text-center">
                        <div class="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center mb-2 shadow-inner">
                          <ion-icon name="calendar-outline" class="text-slate-400 text-lg"></ion-icon>
                        </div>
                        <p class="text-xs font-medium text-slate-500 mb-1">Sin rutinas</p>
                        <p class="text-xs text-slate-400">Descansa</p>
                      </div>
                    }
                  </div>
                </div>
              </div>
            }
          </div>
        </div>
      } @else {
        <!-- Estado vacío general mejorado -->
        <div class="text-center py-12">
          <div class="w-16 h-16 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
            <ion-icon name="calendar-outline" class="text-slate-400 text-2xl"></ion-icon>
          </div>
          <h4 class="text-lg font-semibold text-slate-700 mb-2">No hay rutinas asignadas</h4>
          <p class="text-slate-500 max-w-sm mx-auto">Tu entrenador aún no te ha asignado rutinas. Espera a que te asignen tus rutinas de entrenamiento.</p>
        </div>
      }
    </div>
  </div>
</ion-content>
