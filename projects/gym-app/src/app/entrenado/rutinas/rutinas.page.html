<ion-header [translucent]="true" class="px-4">
  <ion-toolbar class="">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/entrenado-tabs/dashboard" text="" icon="arrow-back-outline"></ion-back-button>
    </ion-buttons>
    <ion-title class="text-center flex-1 text-base">Rutinas</ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear">
        <ion-icon name="notifications-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Rutinas</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="rutinas-container">
    <!-- Sección de Rutinas por Día -->
    <ion-card class="mx-4 my-4">
      <ion-card-content>
        @if (rutinasPorDia() && rutinasPorDia().length > 0) {
          <ion-list lines="none" class="m-0 p-0">
            @for (dia of rutinasPorDia(); track dia.fecha) {
              <ion-item 
                button 
                (click)="verRutinasDelDia(dia)" 
                [class.ion-item--highlight]="dia.esHoy" 
                lines="none"
                style="height: 120px; --inner-padding-end: 16px; --inner-padding-start: 16px; --padding-start: 16px; --padding-end: 16px;">
                <ion-label>
                  <div class="flex flex-col justify-between h-full w-full">
                    <!-- Header con día y fecha -->
                    <div class="flex items-center justify-between">
                      <h3 class="text-base font-semibold {{ dia.esHoy ? 'text-primary' : 'text-dark' }}">
                        {{ dia.diaCorto }}, {{ dia.fecha.getDate() }}
                      </h3>
                      @if (dia.esHoy) {
                        <ion-badge color="warning" class="text-xs">HOY</ion-badge>
                      }
                    </div>

                    <!-- Contenido principal -->
                    <div class="flex-1">
                      @if (dia.rutinas.length > 0) {
                        <div class="space-y-1">
                          @for (rutina of dia.rutinas.slice(0, 2); track rutina.id) {
                            <div class="flex items-center justify-between bg-light rounded-md p-2">
                              <div class="flex-1">
                                <div class="flex items-center justify-between">
                                  <p class="text-sm font-medium text-dark">{{ rutina.nombre }}</p>
                                  @if (rutina.ejerciciosIds && rutina.ejerciciosIds.length > 0) {
                                    <ion-icon name="fitness-outline" color="primary"></ion-icon>
                                  }
                                </div>
                                <div class="flex items-center text-xs text-medium mt-1">
                                  @if (rutina.duracion) {
                                    <ion-icon name="time-outline" class="mr-1"></ion-icon>
                                    {{ rutina.duracion }} min
                                  }
                                </div>
                              </div>
                              <ion-icon
                                [name]="rutina.completado ? 'checkmark-circle' : 'play-circle'"
                                [color]="rutina.completado ? 'success' : 'primary'"
                                size="large">
                              </ion-icon>
                            </div>
                          }
                          @if (dia.rutinas.length > 2) {
                            <p class="text-xs text-medium mt-1">
                              +{{ dia.rutinas.length - 2 }} rutina{{ dia.rutinas.length - 2 > 1 ? 's' : '' }} más
                            </p>
                          }
                        </div>
                      } @else {
                        <div class="text-medium">
                          <ion-icon name="bed-outline" class="mr-2"></ion-icon>
                          <span class="text-sm">Día de descanso</span>
                        </div>
                      }
                    </div>
                  </div>
                </ion-label>
              </ion-item>
            }
          </ion-list>
        } @else {
          <div class="text-center py-12">
            <ion-icon name="calendar-outline" size="large" color="medium" class="mb-4"></ion-icon>
            <h4 class="text-lg font-semibold">No hay rutinas asignadas</h4>
            <p class="text-medium">Tu entrenador aún no te ha asignado rutinas. Espera a que te asignen tus rutinas de entrenamiento.</p>
          </div>
        }
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
