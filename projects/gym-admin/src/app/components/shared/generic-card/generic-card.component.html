<div class="bg-white rounded-xl border border-gray-200 shadow-sm h-[calc(100vh-18rem)] max-h-[420px] min-h-[350px] flex flex-col">
  <!-- Header -->
  <div class="p-4 border-b border-gray-100 flex-shrink-0">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold text-gray-900">{{ config().title }}</h2>
      @if (config().showCounter) {
        <span [class]="counterClasses()">{{ items().length }}</span>
      }
    </div>
    
    @if (canCreate()) {
      <button 
        [class]="buttonClasses()"
        [disabled]="!canCreate()"
        (click)="create.emit()">
        {{ config().createButtonText }}
      </button>
      
      @if (!canCreate() && validationMessage()) {
        <div class="mt-2 p-2 bg-amber-50 border border-amber-200 rounded-lg">
          <p class="text-xs text-amber-800">{{ validationMessage() }}</p>
        </div>
      }
    }
  </div>

  <!-- Lista con scroll -->
  <div class="flex-1 overflow-hidden">
    <div class="h-full overflow-y-auto divide-y divide-gray-100 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100">
      @for (item of items(); track getItemId(item)) {
        <div class="p-4 hover:bg-gray-50 transition-colors">
          <div class="flex justify-between items-center">
            <div class="flex-1 flex items-center gap-3">
              <h4 class="font-medium text-gray-900">{{ getDisplayValue(item) }}</h4>
              
              @if (item.needsReview) {
                <div class="flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded-full border border-amber-200">
                  <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                  </svg>
                  <span>Revisar</span>
                </div>
              }
              
              @if (config().showChips && config().showChips!.length > 0) {
                <div class="flex items-center gap-2">
                  @for (chipField of config().showChips!; track chipField) {
                    @if (getChipValue(item, chipField); as value) {
                      <div [class]="getChipClasses(chipField)">
                        <app-chip-icon 
                          [icon]="getChipConfig(chipField).icon"
                          [colorClass]="'text-' + getChipConfig(chipField).color + '-600'"/>
                        <span class="text-xs font-medium">{{ value }}</span>
                      </div>
                    }
                  }
                </div>
              }
            </div>
            
            <div class="flex gap-2 ml-4">
              <button 
                class="px-2 py-1 text-xs font-medium text-blue-700 bg-blue-50 rounded border border-blue-200 hover:bg-blue-100 transition-colors"
                (click)="edit.emit(item)">
                Editar
              </button>
              <button 
                class="px-2 py-1 text-xs font-medium text-red-700 bg-red-50 rounded border border-red-200 hover:bg-red-100 transition-colors"
                (click)="delete.emit(getItemId(item))">
                Eliminar
              </button>
            </div>
          </div>
        </div>
      } @empty {
        <div class="p-8 text-center text-gray-500">
          <p class="text-sm font-medium">{{ config().emptyStateTitle }}</p>
        </div>
      }
    </div>
  </div>
</div>
